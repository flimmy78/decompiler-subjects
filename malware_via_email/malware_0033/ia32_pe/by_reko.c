// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	struct Eq_3 * edx_15;
	word32 ecx_16 = fn00401078(globals->a401131, (Eq_141 (*)[]) 0x063C, out edx_15);
	fn00401131(ecx_16, edx_15, ebx, fp - 0x04, esi, edi, es, ds, dwLoc20, rArg0);
	*(fp - 0x18) = 0x063C;
	*(fp - 0x1C) = 0x00401131;
	word32 edx_45;
	fn00401078(dwArg00, dwArg04, out edx_45);
	if (false)
	{
		*(fp - 0x18) = 0x00405000;
		*(fp - 0x1C) = 0x00401000;
		lstrcpyA(*(fp - 0x1C), *(fp - 0x18));
	}
	return 0x00;
}

// 00401078: Register (ptr (arr Eq_141)) fn00401078(Stack (ptr (arr Eq_141)) dwArg04, Stack (ptr (arr Eq_141)) dwArg08, Register out ptr32 edxOut)
Eq_141 * fn00401078[](Eq_141 * dwArg04[], Eq_141 * dwArg08[], ptr32 & edxOut)
{
	*edxOut = edx;
	Eq_141 (* dwLoc08_22)[] = null;
	while (dwLoc08_22 < dwArg08)
	{
		if (dwLoc08_22 > null && (dwLoc08_22 & 0x01) == 0x00)
		{
			word32 eax_120 = dwLoc08_22 + dwArg04;
			Mem127[dwArg04 + dwLoc08_22:byte] = (byte) (DPB(eax_120, *eax_120, 0) ^ 0x3D);
		}
		if (dwLoc08_22 > (Eq_141 (*)[]) 0x01)
		{
			word32 eax_104 = dwLoc08_22 + dwArg04;
			Mem110[dwArg04 + dwLoc08_22:byte] = (byte) (DPB(eax_104, *eax_104, 0) + 0x08);
		}
		if (dwLoc08_22 > (Eq_141 (*)[]) 0x02 && (dwLoc08_22 - (Eq_141 (*)[]) 0x02 & 0x01) == 0x00)
		{
			Eq_141 eax_93[] = dwLoc08_22 + dwArg04;
			Mem99[dwArg04 + dwLoc08_22:byte] = (byte) (DPB(eax_93, eax_93[0x00], 0) - (Eq_141 (*)[]) 0x57);
		}
		ecx = (Eq_141 (*)[]) 0x03;
		int32 edx_52 = (int32) (SEQ(dwLoc08_22 >> 0x1F, dwLoc08_22) % 0x03);
		*edxOut = edx_52;
		if (edx_52 == 0x00)
		{
			ecx = dwArg04 + dwLoc08_22;
			Mem82[ecx + 0x00:byte] = Mem0[dwLoc08_22 + dwArg04:byte] - (byte) dwLoc08_22;
			word32 edx_75;
			*edxOut = dwLoc08_22;
		}
		dwLoc08_22 = dwLoc08_22 + 0x01;
	}
	return ecx;
}

// 00401131: FpuStack real64 fn00401131(Register word32 ecx, Register (ptr Eq_3) edx, Register (ptr Eq_18) ebx, Register (ptr Eq_19) ebp, Register Eq_20 esi, Register (ptr byte) edi, Register (ptr Eq_22) es, Register (ptr Eq_23) ds, Stack word32 dwArg00, FpuStack real64 rArg0)
real64 fn00401131(word32 ecx, Eq_3 * edx, Eq_18 * ebx, Eq_19 * ebp, Eq_20 esi, byte * edi, Eq_22 * es, Eq_23 * ds, word32 dwArg00, real64 rArg0)
{
	word64 edx_eax_7 = fp - 0x04;
	cu8 al_8 = (byte) (fp - 0x04);
	word16 ax_9 = (word16) (fp - 0x04);
	if (!SO)
		*(esi - 0x08) = *(esi - 0x08) & 114;
	byte al_11 = al_8 + 0x61;
	ptr32 eax_12 = DPB(fp - 0x04, al_8 + 0x61, 0);
	word64 edx_eax_13 = DPB(edx_eax_7, al_8 + 0x61, 0);
	word16 ax_14 = DPB(ax_9, al_8 + 0x61, 0);
	if (al_8 > 0x61)
		;
	else
	{
		__lock();
		byte v18_29 = edx->bF75BF60A - dl;
		edx->bF75BF60A = v18_29;
		bool SCZO_31 = cond(v18_29);
		word32 * esp_121 = dwArg00 + 0x04;
		bool C_190 = SCZO_31;
		bool Z_193 = SCZO_31;
		word32 * eax_184 = DPB(eax_12, FPUF, 8);
		uint64 edx_eax_185 = DPB(edx_eax_13, FPUF, 8);
		word16 ax_188 = DPB(ax_14, FPUF, 8);
		struct Eq_226 * ecx_173 = ecx - 0x01;
		if (v18_29 == 0x00 && ecx != 0x01)
		{
			*edi = __in(dx);
l004011A7:
			(byte *) 0x72FE47E0 = (byte *) al_11;
			do
			{
				if (C_190)
				{
					if (false)
						*(esp_121 - 0x02) = (struct Eq_23 **) ds;
					ecx_173 = ecx_173 - 0x01;
					if ((edi + 0x01 & esi) == 0x00 && ecx_173 != null)
					{
						do
							;
						while ((ebx->dw0000 & 443605320) >= 0x00);
						(byte *) 1996377561 = (byte *) al_11;
						__outw(dx, ax_188);
						bool C_209 = false;
						do
							;
						while (OVERFLOW(ebx->dw0000 & 443605320));
						if (true)
						{
							ebp->b0005 = ebp->b0005 & ~0x41;
							dx_258 = dx;
							dl_259 = dl;
							esi_260 = esi;
							do
							{
								word16 dx_258;
								byte dl_259;
								Eq_20 esi_260;
								Mem264[~0x1F14419E:word32] = Mem255[~0x1F14419E:word32] + esi_260;
								int32 eax_265 = __indw(dx_258);
								struct Eq_436 * edi_268 = *esp_121;
								__outb(dx_258, (byte) eax_265);
								edi_268->a8FF755F6[eax_265] = edi_268->a8FF755F6[eax_265] - dl_259;
								uint64 edx_eax_275 = DPB(edx_eax_185, __inb(0x50), 0);
								uint64 edx_eax_279 = SEQ((uint32) (edx_eax_275 % (uint32 *) ~0x1F144212), (uint32) (edx_eax_275 /u (uint32 *) ~0x1F144212));
								ebp->b005F = ebp->b005F - ~0x41;
								struct Eq_480 * edx_283 = (uint32) (edx_eax_279 % (bu8 *) ~0x1F144175);
								uint32 eax_287 = (uint32) (edx_eax_279 /u (bu8 *) ~0x1F144175);
								int32 edi_293 = edx_283->dw007D *s 0x03;
								esi_260 = ~0x088F0C15 - (word32 *) ~0x1F14419E;
								*((word32) esi_260 - 0x088FDC17) = 177;
								cu8 v49_296 = es->*((word32) esi_260 - 0x08500983) - ~0x41;
								es->*((word32) esi_260 - 0x08500983) = v49_296;
								(uint32 *) ~0x08551516 = eax_287;
								esp_121 = esp_121 + 0x04;
								dl_259 = (byte) edx_283;
								dx_258 = (word16) edx_283;
								edx_eax_185 = (uint64) eax_287;
							} while (v49_296 >= 0x00);
							*(ebp - 0x51) = *(ebp - 0x51) - ~0x41;
							uint32 eax_305 = (uint32) (edx_eax_185 /u (bu8 *) ~0x1F14414B);
							C_209 = cond(eax_305);
							do
								*((word32) esi_260 + 1349577751) = edi_293;
							while (eax_305 >= 0x00);
						}
						*(esp_121 * 0x02 + C_209 - 0x04) = ~0x1B;
						word32 esp_223;
						word32 ebp_224;
						word32 eax_225;
						byte SO_226;
						word32 esi_227;
						byte SZO_228;
						byte C_229;
						byte cl_230;
						byte dh_231;
						byte al_232;
						byte SCZO_233;
						byte CZ_234;
						byte D_235;
						word32 edx_236;
						byte dl_237;
						byte ah_238;
						byte FPUF_239;
						word32 ecx_240;
						byte Z_241;
						word32 ebx_242;
						byte bh_243;
						word32 edi_244;
						word16 dx_245;
						word16 ax_246;
						byte P_247;
						word16 bx_248;
						byte S_249;
						byte O_250;
						byte CZP_251;
						struct Eq_411 * es_252;
						struct Eq_412 * ds_253;
						fn7437A576();
						return rArg0;
					}
					else
					{
						uint64 edx_eax_177 = &(edx->*esp_121);
						edx = (uint32) (edx_eax_177 % ebx->b006C);
						eax_184 = (uint32) (edx_eax_177 /u ebx->b006C);
						bool SCZO_189 = cond(eax_184);
						esp_121 = eax_184;
						dl = (byte) edx;
						dx = (word16) edx;
						edx_eax_185 = (uint64) &(edx->*eax_184);
						al_11 = (byte) eax_184;
						ax_188 = (word16) eax_184;
						C_190 = SCZO_189;
						Z_193 = SCZO_189;
						goto l004011A7;
					}
				}
				esp_121 = (word32 *) 4192829932;
			} while (Z_193);
			__outw(dx, ax_188);
			if (P)
			{
				word32 esp_132;
				word32 ebp_133;
				word32 eax_134;
				byte SO_135;
				word32 esi_136;
				byte SZO_137;
				byte C_138;
				byte cl_139;
				byte dh_140;
				byte al_141;
				byte SCZO_142;
				byte CZ_143;
				byte D_144;
				word32 edx_145;
				byte dl_146;
				byte ah_147;
				byte FPUF_148;
				word32 ecx_149;
				byte Z_150;
				word32 ebx_151;
				byte bh_152;
				word32 edi_153;
				word16 dx_154;
				word16 ax_155;
				byte P_156;
				word16 bx_157;
				byte S_158;
				byte O_159;
				byte CZP_160;
				struct Eq_287 * es_161;
				struct Eq_288 * ds_162;
				fn74374CD1();
				return rArg0;
			}
			else
			{
				(word32 *) 4192829928 = *(ebp - 0x09);
				__indw(~0x07);
				__arpl(ecx_173->w0000, bx, &ecx_173->w0000);
			}
		}
		else
			ebp->b0060 = ebp->b0060 - bh;
	}
}

