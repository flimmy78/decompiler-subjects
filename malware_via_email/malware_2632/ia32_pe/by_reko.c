// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401015: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_3 eax_21 = CreateFileA(4415501, 0x80000000, 0x02, null, 0x03, 292, 0x00);
	if (eax_21 != ~0x00)
	{
		GetFileSize(dwLoc10, null);
		GetOEMCP();
		CreateFileA(0x00436048, 0xA0000000, 0x02, null, 0x03, 422, 0x00);
		GetProcessHeap();
		CloseHandle(eax_21);
		VirtualProtect(&globals->v401238, eax_21, 0xE454, &globals->t436048);
		GetFileType(dwLoc20);
		GetFileSize(dwLoc10, null);
		CreateFileA(0x00436023, 0x40000000, 0x04, null, 0x03, 0x0181, 0x00);
		word32 esp_276;
		word32 ebp_277;
		byte SCZO_278;
		word32 eax_279;
		byte Z_280;
		byte SZO_281;
		byte C_282;
		bcuiposr0 None_283;
		byte bh_284;
		byte ch_285;
		word32 edx_286;
		word16 dx_287;
		word16 ax_288;
		word32 ebx_289;
		byte cl_290;
		word32 ecx_291;
		byte al_292;
		byte P_293;
		(dwLoc1C - ~0x404011F4)();
		Eq_3 eax_297 = GetProcessHeap();
		int64 edx_eax_304 = SEQ(edx_286, eax_297 ^ 874516727);
		int32 edx_307 = (int32) (edx_eax_304 % *(eax_297 ^ 874516727));
		word16 dx_308 = (word16) edx_307;
		word16 ax_310 = (word16) (int32) (edx_eax_304 / *(eax_297 ^ 874516727));
		__outw(dx_308, ax_310);
		word32 esp_314;
		word32 ebp_315;
		byte SCZO_316;
		word32 eax_317;
		byte Z_318;
		byte SZO_319;
		byte C_320;
		bcuiposr0 None_321;
		byte bh_322;
		byte ch_323;
		word32 edx_324;
		word16 dx_325;
		word16 ax_326;
		cu8 * ebx_327;
		byte cl_328;
		struct Eq_207 * ecx_329;
		byte al_330;
		bool P_331;
		fnE984CD7F();
		cu8 v27_332 = *ebx_327 + cl_328 + C_320;
		*ebx_327 = v27_332;
		byte al_339 = __inb(dx_325);
		struct Eq_226 * eax_340 = DPB(eax_317, al_339, 0);
		cu8 v30_341 = eax_340->b88BEB17C + al_339 + (v27_332 < 0x00);
		eax_340->b88BEB17C = v30_341;
		byte al_347 = __inb(11);
		word32 eax_348 = DPB(eax_317, al_347, 0);
		if (P_331)
			return eax_348;
		else
		{
			ecx_329->b5A02044D = ecx_329->b5A02044D + al_347 + (v30_341 < 0x00);
			__wait();
			byte al_358;
			__das(227, &al_358);
		}
	}
	else
	{
		Eq_99 eax_83 = GetModuleHandleA(4415513);
		GetCommandLineA();
		GetACP();
		GetACP();
		Eq_3 eax_94 = GetProcAddress(eax_83, 0x00436000);
		GetProcessHeap();
		SizeofResource(null, eax_94);
		GetCurrentThreadId();
		GetFileType(eax_94);
		CreateFileA(4415535, 0x40000000, 0x05, null, 0x03, 0x26, 0x00);
		<anonymous> * eax_176 = (eax_94() ^ 0xC0000005) + 0x00401102;
		word32 esp_178;
		word32 ebp_179;
		byte SCZO_180;
		Eq_2 eax_181;
		byte Z_182;
		byte SZO_183;
		byte C_184;
		bcuiposr0 None_185;
		byte bh_186;
		byte ch_187;
		word32 edx_188;
		word16 dx_189;
		word16 ax_190;
		word32 ebx_191;
		byte cl_192;
		word32 ecx_193;
		byte al_194;
		byte P_195;
		eax_176();
		return eax_181;
	}
}

