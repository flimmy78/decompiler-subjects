// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401026: void fn00401026(Register byte al, Register word32 ecx, Register (ptr byte) edx, Register int32 ebx, Register (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr (ptr Eq_6))))))))))))))))))))))))))))))))))))))))))))))))))) ebp, Register (ptr Eq_7) esi)
void fn00401026(byte al, word32 ecx, byte * edx, int32 ebx,  * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * ebp, Eq_7 * esi)
{
	bool v4_5 = (*edx & 0x01 << cl) != 0x00;
	*edx = __ror(*edx, cl);
	ptr32 esp_1 = fp;
	bool C_33 = v4_5;
l00401027:
	word32 * esp_41 = esp_1 - 0x04;
	*esp_41 = ecx;
	byte al_44 = (byte) __aam(al);
	ebp = ebp - Mem42[esi + 0x00:word32] - C_33;
	byte al_47 = (byte) __aam(al_44);
	*(esp_41 - 0x04) = ecx;
	word16 ax_54 = __aad(__aam(al_47));
	esp_1 = esp_41 - 0x04;
	esi = esi + ebx;
	eax = DPB(eax, ax_54, 0);
	al = (byte) ax_54;
	do
	{
		ch = ch ^ dh;
		ecx = DPB(ecx_202, ch, 8);
		if (!P)
		{
			Eq_78 v19_80 = null[ebx].dw0000 >> 0x01;
			null[ebx].t0000 = v19_80;
			C_33 = cond(v19_80);
			if (v19_80 <= 0x00)
				goto l00401027;
			struct Eq_126 * eax_88 = DPB(eax, al & 0xB8, 0);
			struct Eq_126 ** esp_90 = esp_1 - 0x04;
			*esp_90 = (struct Eq_126 **) eax_88;
			*(esp_90 - 0x04) = ecx;
			*(esp_90 - 0x08) = (byte **) edx;
			*(esp_90 - 0x0C) = ebx;
			*(esp_90 - 0x10) = esp_1;
			Mem101[esp_90 - 0x14 + 0x00:word32] = ebp;
			*(esp_90 - 0x18) = (struct Eq_7 **) esi;
			*(esp_90 - 0x1C) = ebx *s ~0x2A;
			eax_88->dw5D27D73B = (char *) ebp + eax_88->dw5D27D73B;
		}
		***************************************************************************************************** esp_112 = esp_1 - 0x04;
		Mem113[esp_112 + 0x00:word32] = ebp;
		__aam(al);
		esi = esi + 0x01;
		word32 eax_122 = DPB(eax, esi->b0000, 8);
		*(esp_112 - ~0x50A3) = ecx + 0x01;
		__sti();
		edx = edx - 0x01;
		eax = (eax_122 ^ 4193834734) + 2083339001;
		ebp = esp_112;
		ecx = ecx + 0x01;
		ch = SLICE(ecx + 0x01, byte, 8);
		esp_1 = esp_112 - ~0x50A3;
		dh = SLICE(edx, byte, 8);
		word16 dx_131 = (word16) edx;
		al = (byte) eax;
		if (eax <= 0x00)
			null[ebx].b0000 = esi->b0000;
		word32 ecx_202 = ecx;
	} while (eax > 0x00);
	__outb(77, al);
	null[ebx].b0000 = al;
	*(esp_112 - ~0x509F) = ecx;
	__outb(dx_131, al);
	byte * edi_144 = ebx *s ~0x2A + 0x01;
	int32 eax_154 = __indw(dx_131);
	if ((eax & 1036320273) >= 0x00)
		;
	else
	{
		(int32 *) ~0x1CA81741 = eax_154;
		cu8 ch_168 = esp_112 - ~0x509F + eax_154 + 0x00EE + (bh < DPB(ecx_202, ~0x11, 8) + 0x4E);
		word32 eax_174 = esi[0x02];
		word16 dx_173 = DPB(dx_131, (byte) eax_154 + (DPB(ecx_202, ch_168, 8) + 0x00) + (ch_168 < 0x00), 0);
		byte al_175 = (byte) eax_174;
		__outb(dx_173, al_175);
		*edi_144 = __in(dx_173);
		__cli();
		byte al_189;
		byte ah_190;
		__aaa(al_175, SLICE(eax_174, byte, 8), &al_189, &ah_190);
	}
}

// 00413018: Register Eq_280 Win32CrtStartup()
Eq_280 Win32CrtStartup()
{
	GetModuleHandleA(4414750);
	GetCommandLineA();
	ptr32 esp_161 = fp - 88;
l00413056:
	struct Eq_293 * esp_61 = esp_161 - 0x04;
	&esp_61->t0000.u0->unused = 4414703;
	Eq_300 eax_63 = CreateFileW(esp_61->t0000, esp_61->t0004, esp_61->t0008, esp_61->t000C, esp_61->t0010, esp_61->t0014, esp_61->t0018);
	Eq_332 eax_65 = GetProcAddress(esp_61->t0000, esp_61->t0004);
	GetCommandLineA();
	*(esp_61 - 0x04) = 0x00;
	*(esp_61 - 0x08) = (HANDLE *) eax_63;
	GetFileType(*(esp_61 - 0x08));
	*(esp_61 - 0x0C) = 0x00;
	*(esp_61 - 0x10) = (HANDLE *) eax_63;
	GetFileType(*(esp_61 - 0x10));
	*(esp_61 - 0x14) = 0x00;
	ptr32 esp_210 = esp_61 - 0x14;
	do
	{
		HANDLE * esp_85 = esp_210 - 0x04;
		*esp_85 = (HANDLE *) null;
		*(esp_85 - 0x04) = 0x0101;
		*(esp_85 - 0x08) = 0x03;
		*(esp_85 - 0x0C) = 0x00;
		*(esp_85 - 0x10) = 0x00;
		*(esp_85 - 0x14) = 0x40000000;
		*(esp_85 - 0x18) = 4414582;
		Eq_300 eax_99 = CreateFileA(*(esp_85 - 0x18), *(esp_85 - 0x14), *(esp_85 - 0x10), *(esp_85 - 0x0C), *(esp_85 - 0x08), *(esp_85 - 0x04), *esp_85);
		Eq_692 eax_104 = eax_65();
		GetLastError();
		*(esp_85 - 0x1C) = (HANDLE *) eax_63;
		GetFileType(*(esp_85 - 0x1C));
		*(esp_85 - 0x20) = 0x00;
		*(esp_85 - 0x24) = (HANDLE *) eax_99;
		Eq_280 eax_132 = GetFileSize(*(esp_85 - 0x24), *(esp_85 - 0x20));
		ptr32 esp_133;
		word32 ebp_134;
		byte SCZO_135;
		word32 eax_136;
		byte SZO_137;
		byte C_138;
		byte Z_139;
		byte al_140;
		word32 ecx_141;
		word32 edx_142;
		word32 ebx_143;
		word32 esi_144;
		(*((word32) (eax_104 ^ 0xC0000005) + 0x00413114))();
		*(esp_133 - 0x04) = (HANDLE *) eax_63;
		GetFileType(*(esp_133 - 0x04));
		*(esp_133 - 0x08) = 0x00;
		*(esp_133 - 0x0C) = 0xA0;
		*(esp_133 - 0x10) = 0x03;
		*(esp_133 - 0x14) = 0x00;
		*(esp_133 - 0x18) = 0x04;
		*(esp_133 - 0x1C) = 0xC0000000;
		*(esp_133 - 0x20) = 4414634;
		esp_161 = esp_133 - 0x20;
		Eq_300 eax_163 = CreateFileW(*(esp_133 - 0x20), *(esp_133 - 0x1C), *(esp_133 - 0x18), *(esp_133 - 0x14), *(esp_133 - 0x10), *(esp_133 - 0x0C), *(esp_133 - 0x08));
		if (eax_163 != (void *) ~0x00)
			goto l00413056;
		*(esp_133 - 0x24) = fp - 0x10;
		*(esp_133 - 0x28) = 0x00;
		*(esp_133 - 44) = (HANDLE *) eax_163;
		GetFileSize(*(esp_133 - 44), *(esp_133 - 0x28));
		*(esp_133 - 0x30) = 0x40;
		*(esp_133 - 0x34) = 0x00011D22;
		*(esp_133 - 0x38) = 0x00;
		*(esp_133 - 0x3C) = 0x20;
		*(esp_133 - 0x40) = 0x03;
		*(esp_133 - 0x44) = 0x00;
		*(esp_133 - 0x48) = 0x06;
		*(esp_133 - 0x4C) = 0x40000000;
		*(esp_133 - 0x50) = 4414722;
		CreateFileA(*(esp_133 - 0x50), *(esp_133 - 0x4C), *(esp_133 - 0x48), *(esp_133 - 0x44), *(esp_133 - 0x40), *(esp_133 - 0x3C), *(esp_133 - 0x38));
		*(esp_133 - 0x54) = 0x00401000;
		*(esp_133 - 88) = 0x00;
		*(esp_133 - 0x5C) = 0x0103;
		*(esp_133 - 0x60) = 0x03;
		*(esp_133 - 100) = 0x00;
		*(esp_133 - 0x68) = 0x00;
		*(esp_133 - 0x6C) = 0x40000000;
		*(esp_133 - 0x70) = 4414656;
		esp_210 = esp_133 - 0x70;
		Eq_300 eax_212 = CreateFileW(*(esp_133 - 0x70), *(esp_133 - 0x6C), *(esp_133 - 0x68), *(esp_133 - 100), *(esp_133 - 0x60), *(esp_133 - 0x5C), *(esp_133 - 88));
	} while (eax_212 != (void *) ~0x00);
	*(esp_133 - 116) = (HANDLE *) eax_212;
	CloseHandle(*(esp_133 - 116));
	VirtualProtect(*(esp_133 - 116), *(esp_133 - 0x70), *(esp_133 - 0x6C), *(esp_133 - 0x68));
	*(esp_133 - 0x78) = 0x00;
	*(esp_133 - 0x7C) = 0xA0;
	*(esp_133 - 0x80) = 0x03;
	*(esp_133 - 0x84) = 0x00;
	*(esp_133 - 0x88) = 0x02;
	*(esp_133 - 0x8C) = 0xE0000000;
	*(esp_133 - 0x90) = 4414588;
	Eq_300 eax_235 = CreateFileW(*(esp_133 - 0x90), *(esp_133 - 0x8C), *(esp_133 - 0x88), *(esp_133 - 0x84), *(esp_133 - 0x80), *(esp_133 - 0x7C), *(esp_133 - 0x78));
	*(esp_133 - 0x94) = (union Eq_692 *) eax_104;
	*(esp_133 - 0x98) = 0x00011D22;
	*(esp_133 - 0x9C) = (HANDLE *) eax_63;
	GetFileType(*(esp_133 - 0x9C));
	*(esp_133 - 0xA0) = (HANDLE *) eax_235;
	GetFileType(*(esp_133 - 0xA0));
	*(esp_133 - 0xA4) = 0x00401000;
	*(esp_133 - 0xA8) = (HANDLE *) eax_63;
	GetFileType(*(esp_133 - 0xA8));
	*(esp_133 - 0xAC) = (HANDLE *) eax_235;
	GetFileType(*(esp_133 - 0xAC));
	*(esp_133 - 0xB0) = 0x00;
	*(esp_133 - 0xB4) = 0x0107;
	*(esp_133 - 0xB8) = 0x03;
	*(esp_133 - 188) = 0x00;
	*(esp_133 - 0xC0) = 0x07;
	*(esp_133 - 0xC4) = 0x60000000;
	*(esp_133 - 200) = 4414676;
	CreateFileW(*(esp_133 - 200), *(esp_133 - 0xC4), *(esp_133 - 0xC0), *(esp_133 - 188), *(esp_133 - 0xB8), *(esp_133 - 0xB4), *(esp_133 - 0xB0));
	GetLastError();
	*(esp_133 - 0xCC) = 0x00;
	*(esp_133 - 0xD0) = (HANDLE *) eax_99;
	Eq_280 eax_289 = GetFileSize(*(esp_133 - 0xD0), *(esp_133 - 0xCC));
	word32 esp_291;
	***************************************************************************************************** ebp_292;
	byte SCZO_293;
	Eq_280 eax_294;
	byte SZO_295;
	byte C_296;
	byte Z_297;
	byte al_298;
	word32 ecx_299;
	byte * edx_300;
	int32 ebx_301;
	struct Eq_7 * esi_302;
	(eax_104 - ~0x40412FD7)();
	fn00401026(al_298, ecx_299, edx_300, ebx_301, ebp_292, esi_302);
	return eax_294;
}

