//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2018 Retargetable Decompiler <info@retdec.com>
//

#include <stdint.h>
#include <stdlib.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _EXCEPTION_POINTERS {
    struct _EXCEPTION_RECORD * e0;
    struct _CONTEXT * e1;
};

struct _EXCEPTION_RECORD {
    int32_t e0;
    int32_t e1;
    struct _EXCEPTION_RECORD * e2;
    char * e3;
    int32_t e4;
    int32_t e5[1];
};

struct _M128A {
    int64_t e0;
    int64_t e1;
};

struct _CONTEXT {
    int64_t e0;
    int64_t e1;
    int64_t e2;
    int64_t e3;
    int64_t e4;
    int64_t e5;
    int32_t e6;
    int32_t e7;
    int16_t e8;
    int16_t e9;
    int16_t e10;
    int16_t e11;
    int16_t e12;
    int16_t e13;
    int32_t e14;
    int64_t e15;
    int64_t e16;
    int64_t e17;
    int64_t e18;
    int64_t e19;
    int64_t e20;
    int64_t e21;
    int64_t e22;
    int64_t e23;
    int64_t e24;
    int64_t e25;
    int64_t e26;
    int64_t e27;
    int64_t e28;
    int64_t e29;
    int64_t e30;
    int64_t e31;
    int64_t e32;
    int64_t e33;
    int64_t e34;
    int64_t e35;
    int64_t e36;
    int64_t e37;
    int32_t e38;
    struct _M128A e39[26];
    int64_t e40;
    int64_t e41;
    int64_t e42;
    int64_t e43;
    int64_t e44;
    int64_t e45;
};

// ------------------------- Classes --------------------------

// type_info

// ------------------- Function Prototypes --------------------

void entry_point(void);
int32_t function_401000(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_40106f(int32_t a1, int32_t a2, int32_t a3, int32_t a4);
int32_t function_4010a2(int32_t * a1);
void function_4010b8(int32_t a1);
int32_t function_401115(int32_t a1);
int32_t function_40111b(void);
int32_t function_401121(int32_t a1, int32_t a2, int32_t a3);
int32_t function_40133c(int32_t a1);
void function_401506(void);
int32_t (**function_401621(void))(struct _EXCEPTION_POINTERS *);
void function_401630(void);
int32_t function_401740(void);
void function_401795(void);
void function_4017e4(void);
int32_t function_4018ad(int32_t (***a1)());
int32_t function_40193e(void);
int32_t function_40198d(int32_t a1);
int32_t function_401997(void);
void function_40199a(void);
int32_t (**function_401a3b(void))();
void function_402d7b(void);
int32_t unknown_407230(void);
int32_t unknown_407238(int32_t a1);

// --------------------- Global Variables ---------------------

int32_t g1 = 0; // eax
void (**g2)() = (void (**)())-0x47a90075; // 0x40171a
char * g3 = "\x33\xc0\xc3\x33\xc0\xc3\xff\x25\xe8\x71\x40"; // 0x401994
int32_t g4 = -2; // 0x406050
int32_t g5 = 1; // 0x406054
int32_t g6 = 0; // 0x406168
char *** g7 = NULL; // 0x40616c
char *** g8 = NULL; // 0x406170
int32_t g9 = 0; // 0x406174
int32_t g10 = 0; // 0x406178
int32_t g11 = 0; // 0x40617c
int32_t g12 = 0; // 0x4064ac
int32_t g13 = 0; // 0x4064b0
int32_t g14 = 0; // 0x4064b4
int32_t g15 = 0; // 0x4064b8
int32_t g16 = 0; // 0x4064d0
int32_t g17 = 0; // 0x4064e0

// ------------------------ Functions -------------------------

// Address range: 0x401000 - 0x40106e
int32_t function_401000(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x401000
    abort();
    // UNREACHABLE
}

// Address range: 0x40106f - 0x4010a1
int32_t function_40106f(int32_t a1, int32_t a2, int32_t a3, int32_t a4) {
    // 0x40106f
    abort();
    // UNREACHABLE
}

// Address range: 0x4010a2 - 0x4010b7
int32_t function_4010a2(int32_t * a1) {
    // 0x4010a2
    int32_t v1;
    return _CxxFrameHandler3((int32_t *)v1, a1, NULL, NULL);
}

// Address range: 0x4010b8 - 0x4010c8
void function_4010b8(int32_t a1) {
    // 0x4010b8
    unknown_407238(a1);
}

// Address range: 0x401115 - 0x40111a
int32_t function_401115(int32_t a1) {
    // 0x401115
    return 0;
}

// Address range: 0x40111b - 0x401120
int32_t function_40111b(void) {
    // 0x40111b
    return *(int32_t *)24;
}

// Address range: 0x401121 - 0x40116b
int32_t function_401121(int32_t a1, int32_t a2, int32_t a3) {
    // 0x401121
    atexit((void (**)())&g2);
    g11 = g13;
    int32_t result = __getmainargs(&g6, (char ***)&g8, (char ***)&g7, g12, &g11); // 0x401151
    g10 = result;
    if (result <= 0) {
        // 0x401163
        _amsg_exit(8);
        // branch -> 0x40116b
    }
    // 0x40116b
    return result;
}

// Address range: 0x40133c - 0x4013f5
int32_t function_40133c(int32_t a1) {
    // 0x40133c
    int32_t v1; // 0x401393_4
    if (*(int16_t *)0x400000 == 0x5a4d) {
        int32_t v2 = *(int32_t *)0x40003c; // 0x40134e
        if (*(int32_t *)(v2 + 0x400000) == 0x4550) {
            // 0x40135f
            if (*(int16_t *)(v2 + 0x400018) == 267) {
                // 0x40136d
                int32_t v3;
                if (*(int32_t *)(v2 + 0x400074) >= 15) {
                    // 0x401376
                    v3 = *(int32_t *)(v2 + 0x4000e8) != 0;
                    // branch -> 0x401383
                } else {
                    v3 = 0;
                }
                // 0x401383
                g9 = v3;
                __set_app_type(1);
                v1 = (int32_t)EncodePointer((char *)-1);
                g16 = v1;
                g17 = v1;
                *(int32_t *)0x7370 = g15;
                *(int32_t *)0x7364 = g14;
                _RTC_Initialize();
                function_401997();
                if (g5 == 0) {
                    // 0x4013d0
                    __setusermatherr((int32_t)&g3);
                    // branch -> 0x4013dc
                }
                // 0x4013dc
                __setdefaultprecision();
                if (g4 == -1) {
                    // 0x4013ea
                    _configthreadlocale(-1);
                    // branch -> 0x4013f3
                }
                // 0x4013f3
                return 0;
            }
        }
    }
    // 0x401383
    g9 = 0;
    __set_app_type(1);
    v1 = (int32_t)EncodePointer((char *)-1);
    g16 = v1;
    g17 = v1;
    *(int32_t *)0x7370 = g15;
    *(int32_t *)0x7364 = g14;
    _RTC_Initialize();
    function_401997();
    if (g5 == 0) {
        // 0x4013d0
        __setusermatherr((int32_t)&g3);
        // branch -> 0x4013dc
    }
    // 0x4013dc
    __setdefaultprecision();
    if (g4 == -1) {
        // 0x4013ea
        _configthreadlocale(-1);
        // branch -> 0x4013f3
    }
    // 0x4013f3
    return 0;
}

// Address range: 0x4013f6 - 0x4013ff
void entry_point(void) {
    // 0x4013f6
    __security_init_cookie();
    _qm__qm__qm_();
}

// Address range: 0x401506 - 0x40150b
void function_401506(void) {
    // 0x401506
    _qm__qm_3_YAXPAX_Z();
}

// Address range: 0x401621 - 0x40162f
int32_t (**function_401621(void))(struct _EXCEPTION_POINTERS *) {
    // 0x401621
    SetUnhandledExceptionFilter((int32_t (**)(struct _EXCEPTION_POINTERS *))0x4015df);
    return NULL;
}

// Address range: 0x401630 - 0x40163b
void function_401630(void) {
    // 0x401630
    unknown_407230();
}

// Address range: 0x401740 - 0x40175f
int32_t function_401740(void) {
    // 0x401740
    _cexit();
    return g1;
}

// Address range: 0x401795 - 0x40179f
void function_401795(void) {
    // 0x401795
    return;
}

// Address range: 0x4017e4 - 0x4017ef
void function_4017e4(void) {
    // 0x4017e4
    return;
}

// Address range: 0x4018ad - 0x4018bf
int32_t function_4018ad(int32_t (***a1)()) {
    // 0x4018ad
    return _initterm_e(NULL, a1);
}

// Address range: 0x40193e - 0x401943
int32_t function_40193e(void) {
    // 0x40193e
    return _configthreadlocale(0);
}

// Address range: 0x40198d - 0x401996
int32_t function_40198d(int32_t a1) {
    // 0x40198d
    int32_t v1;
    __setusermatherr(v1);
    return g1;
}

// Address range: 0x401997 - 0x401999
int32_t function_401997(void) {
    // 0x401997
    return 0;
}

// Address range: 0x40199a - 0x40199f
void function_40199a(void) {
    // 0x40199a
    __set_app_type(0);
}

// Address range: 0x401a3b - 0x402d5f
int32_t (**function_401a3b(void))() {
    // 0x401a3b
    _crt_debugger_hook();
    return (int32_t (**)())g1;
}

// Address range: 0x402d7b - 0x403d80
void function_402d7b(void) {
    // 0x402d7b
    return;
}

// --------------- Statically Linked Functions ----------------

// void __cdecl __security_init_cookie(void);
// void __setdefaultprecision(void);
// void _qm__qm__qm_(void);
// void __cdecl _RTC_Initialize(void);
// int atexit(void(* func)(void));

// --------------- Dynamically Linked Functions ---------------

// int __getmainargs(int * Argc, char *** Argv, char *** Env, int DoWildCard, _startupinfo * StartInfo);
// void __set_app_type(int at);
// void __setusermatherr(_HANDLE_MATH_ERROR pf);
// void _amsg_exit(int rterrnum);
// void __cdecl _cexit(void);
// int __cdecl _configthreadlocale(_In_ int Flag);
// void _crt_debugger_hook(void);
// int _CxxFrameHandler3(EHExceptionRecord * pExcept, EHRegistrationNode * pRN, void * pContext, void * pDC);
// int __cdecl _initterm_e(_PIFV * First, _In_ _PIFV * Last);
// void _qm__qm_3_YAXPAX_Z(void);
// PVOID EncodePointer(_In_opt_ PVOID Ptr);
// LPTOP_LEVEL_EXCEPTION_FILTER SetUnhandledExceptionFilter(_In_opt_ LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft linker (10.0)
// Detected functions: 22
// Decompiler release: VERSION
// Decompilation date: DATE
