// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401027: void fn00401027(Register word32 esi, Register word32 edi, Stack word32 dwArg00)
void fn00401027(word32 esi, word32 edi, word32 dwArg00)
{
}

// 00412CFA: Register Eq_5 Win32CrtStartup()
Eq_5 Win32CrtStartup()
{
	GetLastError();
	ptr32 esp_11 = fp - 0x44;
l00412D0D:
	word32 * esp_28 = esp_11 - 0x04;
	*esp_28 = 0x03;
	*(esp_28 - 0x04) = 0x00;
	ptr32 esp_30 = esp_28 - 0x04;
l00412D14:
	struct Eq_13 * esp_39 = esp_30 - 0x04;
	esp_39->t0000.u0 = 0x07;
	*(esp_39 - 0x04) = 0x40000000;
	*(esp_39 - 0x08) = 4414573;
	Eq_33 eax_45 = CreateFileW(*(esp_39 - 0x08), *(esp_39 - 0x04), esp_39->t0000, esp_39->t0004, esp_39->t0008, esp_39->t000C, esp_39->t0010);
	GetCommandLineA();
	GetCommandLineA();
	GetLastError();
	*(esp_39 - 0x0C) = 0x00;
	ptr32 esp_140 = esp_39 - 0x0C;
	do
	{
		struct Eq_84 * esp_56 = esp_140 - 0x04;
		esp_56->t0000.u0 = 0x07;
		*(esp_56 - 0x04) = 0x03;
		*(esp_56 - 0x08) = 0x00;
		*(esp_56 - 0x0C) = 0x05;
		*(esp_56 - 0x10) = 0xE0000000;
		*(esp_56 - 0x14) = 4414408;
		esp_30 = esp_56 - 0x14;
		Eq_33 eax_68 = CreateFileW(*(esp_56 - 0x14), *(esp_56 - 0x10), *(esp_56 - 0x0C), *(esp_56 - 0x08), *(esp_56 - 0x04), esp_56->t0000, esp_56->t0004);
		if (eax_68 != (void *) ~0x00)
			goto l00412D14;
		*(esp_56 - 0x18) = 0x00;
		*(esp_56 - 0x1C) = (HANDLE *) eax_45;
		GetFileSize(*(esp_56 - 0x1C), *(esp_56 - 0x18));
		*(esp_56 - 0x20) = (HANDLE *) eax_68;
		CloseHandle(*(esp_56 - 0x20));
		*(esp_56 - 0x24) = 0x00;
		*(esp_56 - 0x28) = 0x0101;
		*(esp_56 - 44) = 0x03;
		*(esp_56 - 0x30) = 0x00;
		*(esp_56 - 0x34) = 0x07;
		*(esp_56 - 0x38) = 0x40000000;
		*(esp_56 - 0x3C) = 4414542;
		esp_11 = esp_56 - 0x3C;
		Eq_33 eax_96 = CreateFileA(*(esp_56 - 0x3C), *(esp_56 - 0x38), *(esp_56 - 0x34), *(esp_56 - 0x30), *(esp_56 - 44), *(esp_56 - 0x28), *(esp_56 - 0x24));
		if (eax_96 != (void *) ~0x00)
			goto l00412D0D;
		GetCommandLineA();
		*(esp_56 - 0x40) = (HANDLE *) eax_68;
		GetFileType(*(esp_56 - 0x40));
		GetCommandLineA();
		*(esp_56 - 0x44) = 0x00;
		*(esp_56 - 0x48) = (HANDLE *) eax_96;
		GetFileSize(*(esp_56 - 0x48), *(esp_56 - 0x44));
		*(esp_56 - 0x4C) = 0x00;
		*(esp_56 - 0x50) = 0x80;
		*(esp_56 - 0x54) = 0x03;
		*(esp_56 - 88) = 0x00;
		*(esp_56 - 0x5C) = 0x03;
		*(esp_56 - 0x60) = 0x00;
		*(esp_56 - 100) = 4414371;
		Eq_33 eax_126 = CreateFileW(*(esp_56 - 100), *(esp_56 - 0x60), *(esp_56 - 0x5C), *(esp_56 - 88), *(esp_56 - 0x54), *(esp_56 - 0x50), *(esp_56 - 0x4C));
		*(esp_56 - 0x68) = 0x00;
		*(esp_56 - 0x6C) = 292;
		*(esp_56 - 0x70) = 0x03;
		*(esp_56 - 116) = 0x00;
		*(esp_56 - 0x78) = 0x00;
		*(esp_56 - 0x7C) = 0x40000000;
		*(esp_56 - 0x80) = 4414441;
		esp_140 = esp_56 - 0x80;
		Eq_33 eax_142 = CreateFileW(*(esp_56 - 0x80), *(esp_56 - 0x7C), *(esp_56 - 0x78), *(esp_56 - 116), *(esp_56 - 0x70), *(esp_56 - 0x6C), *(esp_56 - 0x68));
	} while (eax_142 != (void *) ~0x00);
	*(esp_56 - 0x84) = (HANDLE *) eax_126;
	CloseHandle(*(esp_56 - 0x84));
	*(esp_56 - 0x88) = 0x00;
	*(esp_56 - 0x8C) = (HANDLE *) eax_96;
	GetFileSize(*(esp_56 - 0x8C), *(esp_56 - 0x88));
	GetLastError();
	*(esp_56 - 0x90) = (HANDLE *) eax_142;
	CloseHandle(*(esp_56 - 0x90));
	*(esp_56 - 0x94) = 4414495;
	Eq_562 eax_163 = GetModuleHandleA(*(esp_56 - 0x94));
	*(esp_56 - 0x98) = (HANDLE *) eax_126;
	GetFileType(*(esp_56 - 0x98));
	*(esp_56 - 0x9C) = 4414413;
	*(esp_56 - 0xA0) = (HMODULE *) eax_163;
	GetCommandLineA();
	Eq_597 eax_175 = GetProcAddress(*(esp_56 - 0xA0), *(esp_56 - 0x9C));
	*(esp_56 - 0xA4) = (HANDLE *) eax_68;
	CloseHandle(*(esp_56 - 0xA4));
	*(esp_56 - 0xA8) = 0x00;
	*(esp_56 - 0xAC) = (HANDLE *) eax_96;
	GetFileSize(*(esp_56 - 0xAC), *(esp_56 - 0xA8));
	*(esp_56 - 0xB0) = (HANDLE *) eax_142;
	CloseHandle(*(esp_56 - 0xB0));
	*(esp_56 - 0xB4) = (HANDLE *) eax_126;
	GetFileType(*(esp_56 - 0xB4));
	*(esp_56 - 0xB8) = 0x00;
	*(esp_56 - 188) = (HANDLE *) eax_45;
	GetFileType(*(esp_56 - 188));
	*(esp_56 - 0xC0) = 0x00;
	*(esp_56 - 0xC4) = 0x00;
	*(esp_56 - 200) = (HANDLE *) eax_96;
	GetFileSize(*(esp_56 - 200), *(esp_56 - 0xC4));
	*(esp_56 - 0xCC) = 0x00;
	*(esp_56 - 0xD0) = (HANDLE *) eax_126;
	GetFileSize(*(esp_56 - 0xD0), *(esp_56 - 0xCC));
	*(esp_56 - 212) = 0x00;
	*(esp_56 - 0xD8) = 0x00;
	*(esp_56 - 220) = 0x0121;
	*(esp_56 - 0xE0) = 0x03;
	*(esp_56 - 228) = 0x00;
	*(esp_56 - 232) = 0x04;
	*(esp_56 - 0xEC) = 0x80000000;
	*(esp_56 - 0xF0) = 4414473;
	Eq_33 eax_231 = CreateFileW(*(esp_56 - 0xF0), *(esp_56 - 0xEC), *(esp_56 - 232), *(esp_56 - 228), *(esp_56 - 0xE0), *(esp_56 - 220), *(esp_56 - 0xD8));
	Eq_828 eax_236 = eax_175();
	*(esp_56 - 244) = 0x00;
	*(esp_56 - 0xF8) = (HANDLE *) eax_96;
	GetFileSize(*(esp_56 - 0xF8), *(esp_56 - 244));
	GetLastError();
	GetCommandLineA();
	Eq_5 eax_259 = GetCommandLineA();
	word32 ebp_261;
	byte SCZO_262;
	word32 eax_263;
	byte Z_264;
	byte SZO_265;
	byte C_266;
	word32 esi_267;
	word32 edi_268;
	ptr32 esp_260;
	(*((word32) (eax_236 ^ 0xC0000005) + 4272007))();
l00412F87:
	word32 * esp_280 = esp_260 - 0x04;
	*esp_280 = 0x00;
	*(esp_280 - 0x04) = 0x0125;
	*(esp_280 - 0x08) = 0x03;
	*(esp_280 - 0x0C) = 0x00;
	*(esp_280 - 0x10) = 0x03;
	ptr32 esp_288 = esp_280 - 0x10;
	do
	{
		struct Eq_910 * esp_294 = esp_288 - 0x04;
		esp_294->t0000.u0 = 0xA0000000;
		*(esp_294 - 0x04) = 4414394;
		esp_260 = esp_294 - 0x04;
		if (CreateFileW(*(esp_294 - 0x04), esp_294->t0000, esp_294->t0004, esp_294->t0008, esp_294->t000C, esp_294->t0010, esp_294->t0014) != (void *) ~0x00)
			goto l00412F87;
		GetLastError();
		*(esp_294 - 0x08) = fp - 0x24;
		GetCommandLineA();
		*(esp_294 - 0x0C) = 0x40;
		*(esp_294 - 0x10) = 0x00;
		*(esp_294 - 0x14) = (HANDLE *) eax_142;
		GetFileSize(*(esp_294 - 0x14), *(esp_294 - 0x10));
		*(esp_294 - 0x18) = 72872;
		*(esp_294 - 0x1C) = (HANDLE *) eax_68;
		CloseHandle(*(esp_294 - 0x1C));
		*(esp_294 - 0x20) = (HANDLE *) eax_231;
		GetFileType(*(esp_294 - 0x20));
		*(esp_294 - 0x24) = 0x00401000;
		VirtualProtect(*(esp_294 - 0x24), *(esp_294 - 0x20), *(esp_294 - 0x1C), *(esp_294 - 0x18));
		*(esp_294 - 0x28) = 0x00;
		*(esp_294 - 44) = (HANDLE *) eax_142;
		GetFileSize(*(esp_294 - 44), *(esp_294 - 0x28));
		GetCommandLineA();
		*(esp_294 - 0x30) = 0x00401000;
		GetLastError();
		*(esp_294 - 0x34) = (union Eq_828 *) eax_236;
		*(esp_294 - 0x38) = 0x00;
		*(esp_294 - 0x3C) = 0x0100;
		*(esp_294 - 0x40) = 0x03;
		*(esp_294 - 0x44) = 0x00;
		*(esp_294 - 0x48) = 0x00;
		*(esp_294 - 0x4C) = 0xE0000000;
		*(esp_294 - 0x50) = 4414505;
		Eq_33 eax_355 = CreateFileW(*(esp_294 - 0x50), *(esp_294 - 0x4C), *(esp_294 - 0x48), *(esp_294 - 0x44), *(esp_294 - 0x40), *(esp_294 - 0x3C), *(esp_294 - 0x38));
		*(esp_294 - 0x54) = 72872;
		*(esp_294 - 88) = 0x00;
		*(esp_294 - 0x5C) = (HANDLE *) eax_68;
		GetFileSize(*(esp_294 - 0x5C), *(esp_294 - 88));
		GetLastError();
		*(esp_294 - 0x60) = (HANDLE *) eax_231;
		GetFileType(*(esp_294 - 0x60));
		*(esp_294 - 100) = 0x00;
		*(esp_294 - 0x68) = 0x0104;
		*(esp_294 - 0x6C) = 0x03;
		*(esp_294 - 0x70) = 0x00;
		*(esp_294 - 116) = 0x02;
		*(esp_294 - 0x78) = 0x80000000;
		*(esp_294 - 0x7C) = 4414531;
		esp_288 = esp_294 - 0x7C;
	} while (CreateFileA(*(esp_294 - 0x7C), *(esp_294 - 0x78), *(esp_294 - 116), *(esp_294 - 0x70), *(esp_294 - 0x6C), *(esp_294 - 0x68), *(esp_294 - 100)) != (void *) ~0x00);
	*(esp_294 - 0x80) = (HANDLE *) eax_355;
	Eq_5 eax_395 = GetFileType(*(esp_294 - 0x80));
	word32 esp_399;
	word32 ebp_400;
	byte SCZO_401;
	word32 eax_402;
	byte Z_403;
	byte SZO_404;
	byte C_405;
	word32 esi_406;
	word32 edi_407;
	(eax_236 - ~0x40412CB3)();
	Eq_5 eax_408 = GetCommandLineA();
	fn00401027(esi_406, edi_407, ebp);
	return eax_408;
}

