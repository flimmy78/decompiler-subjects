// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401024: Register (ptr Eq_2) fn00401024(Register (ptr Eq_2) eax, Register word32 ecx, Register (ptr word32) edx, Register (ptr byte) esi, Register (ptr byte) edi)
Eq_2 * fn00401024(Eq_2 * eax, word32 ecx, word32 * edx, byte * esi, byte * edi)
{
	eax->dw0072 = 990548253;
	bool C_19 = cond(*esi - *edi);
	word32 v7_11 = *edx;
	*edx = ecx;
	if (P)
	{
		while (C_19)
		{
			word32 v13_31 = (word32 *) 351038728 - v7_11;
			(word32 *) 351038728 = v13_31;
			C_19 = cond(v13_31);
		}
		word32 esp_22;
		word32 eax_23;
		byte SCZO_24;
		word32 esi_25;
		word32 edi_26;
		word32 edx_27;
		word32 ecx_28;
		byte P_29;
		byte C_30;
		fn00400FE8();
		return eax_23;
	}
}

// 00412513: Register Eq_45 Win32CrtStartup()
Eq_45 Win32CrtStartup()
{
	GetLastError();
	ptr32 esp_13 = fp - 0x48;
	do
	{
		struct Eq_271 * esp_168 = esp_13 - 0x04;
		esp_168->dw0000 = 0x00;
l0041252C:
		Eq_45 eax_131;
		struct Eq_166 * esp_37 = esp_168 - 0x04;
		esp_37->t0000.u0 = 0x00;
		*(esp_37 - 0x04) = 0x80000000;
		*(esp_37 - 0x08) = 0x0042F897;
		ptr32 esp_327 = esp_37 - 0x08;
		if (CreateFileW(*(esp_37 - 0x08), *(esp_37 - 0x04), esp_37->t0000, esp_37->t0004, esp_37->t0008, esp_37->t000C, esp_37->t0010) != ~0x00)
			goto l0041275E;
		*(esp_37 - 0x0C) = 0x0042F934;
		Eq_172 eax_134 = GetModuleHandleA(*(esp_37 - 0x0C));
		*(esp_37 - 0x10) = 4389083;
		*(esp_37 - 0x14) = 0x00;
		*(esp_37 - 0x18) = 0x01A1;
		*(esp_37 - 0x1C) = 0x03;
		*(esp_37 - 0x20) = 0x00;
		*(esp_37 - 0x24) = 0x06;
		*(esp_37 - 0x28) = 0xC0000000;
		*(esp_37 - 44) = 0x0042F8CC;
		esp_13 = esp_37 - 44;
	} while (CreateFileA(*(esp_37 - 44), *(esp_37 - 0x28), *(esp_37 - 0x24), *(esp_37 - 0x20), *(esp_37 - 0x1C), *(esp_37 - 0x18), *(esp_37 - 0x14)) != ~0x00);
	*(esp_37 - 0x30) = 0x00;
	*(esp_37 - 0x34) = 0x0122;
	*(esp_37 - 0x38) = 0x03;
	*(esp_37 - 0x3C) = 0x00;
	*(esp_37 - 0x40) = 0x04;
	*(esp_37 - 0x44) = 0x60000000;
	*(esp_37 - 0x48) = 4389131;
	esp_168 = esp_37 - 0x48;
	do
	{
		if (CreateFileW(esp_343->dw0000, esp_343[0x01], esp_343[0x02], esp_343[0x03], esp_343[0x04], esp_343[0x05], esp_343[0x06]) != ~0x00)
			goto l0041252C;
		HMODULE * esp_177 = esp_343 - 0x04;
		*esp_177 = (HMODULE *) eax_134;
		*(esp_177 - 0x04) = 0x00;
		*(esp_177 - 0x08) = 0x24;
		*(esp_177 - 0x0C) = 0x03;
		*(esp_177 - 0x10) = 0x00;
		*(esp_177 - 0x14) = 0x00;
		*(esp_177 - 0x18) = 0x00;
		*(esp_177 - 0x1C) = 4389143;
		esp_168 = esp_177 - 0x1C;
		struct Eq_271 * esp_343 = esp_168;
	} while (CreateFileW(*(esp_177 - 0x1C), *(esp_177 - 0x18), *(esp_177 - 0x14), *(esp_177 - 0x10), *(esp_177 - 0x0C), *(esp_177 - 0x08), *(esp_177 - 0x04)) != ~0x00);
	Eq_490 eax_197 = GetProcAddress(*(esp_177 - 0x1C), *(esp_177 - 0x18));
	GetLastError();
	*(esp_177 - 0x20) = 0x00;
	GetLastError();
	*(esp_177 - 0x24) = 0x00;
	*(esp_177 - 0x28) = 0x00;
	*(esp_177 - 44) = 0x0185;
	*(esp_177 - 0x30) = 0x03;
	*(esp_177 - 0x34) = 0x00;
	*(esp_177 - 0x38) = 0x00;
	*(esp_177 - 0x3C) = 0x80000000;
	*(esp_177 - 0x40) = 4389029;
	CreateFileA(*(esp_177 - 0x40), *(esp_177 - 0x3C), *(esp_177 - 0x38), *(esp_177 - 0x34), *(esp_177 - 0x30), *(esp_177 - 44), *(esp_177 - 0x28));
	*(esp_177 - 0x44) = 0x00;
	*(esp_177 - 0x48) = 0x00;
	*(esp_177 - 0x4C) = 0xA3;
	*(esp_177 - 0x50) = 0x03;
	*(esp_177 - 0x54) = 0x00;
	*(esp_177 - 88) = 0x03;
	*(esp_177 - 0x5C) = 0xE0000000;
	*(esp_177 - 0x60) = 0x0042F8F8;
	if (CreateFileW(*(esp_177 - 0x60), *(esp_177 - 0x5C), *(esp_177 - 88), *(esp_177 - 0x54), *(esp_177 - 0x50), *(esp_177 - 0x4C), *(esp_177 - 0x48)) == ~0x00)
		dwLoc3C = eax_197();
	GetCommandLineA();
	ptr32 esp_248 = esp_343 - 100;
	*(esp_248 - 0x04) = 0x00;
	*(esp_248 - 0x08) = 0x0101;
	*(esp_248 - 0x0C) = 0x03;
	*(esp_248 - 0x10) = 0x00;
	*(esp_248 - 0x14) = 0x05;
	*(esp_248 - 0x18) = 0xC0000000;
	*(esp_248 - 0x1C) = 0x0042F8BB;
	Eq_732 v10_252 = dwLoc3C ^ 0xC0000005;
	eax_131 = CreateFileW(*(esp_248 - 0x1C), *(esp_248 - 0x18), *(esp_248 - 0x14), *(esp_248 - 0x10), *(esp_248 - 0x0C), *(esp_248 - 0x08), *(esp_248 - 0x04));
	if (eax_131 == ~0x00)
	{
		Eq_45 eax_277 = GetLastError();
		ptr32 esp_278;
		word32 ebp_279;
		byte SCZO_280;
		word32 eax_281;
		byte Z_282;
		byte SZO_283;
		byte C_284;
		word32 ecx_285;
		word32 edx_286;
		word32 esi_287;
		word32 edi_288;
		(*((word32) v10_252 + 0x004126EF))();
		GetCommandLineA();
		*(esp_278 - 0x04) = fp - 0x10;
		*(esp_278 - 0x08) = 0x40;
		GetCommandLineA();
		*(esp_278 - 0x0C) = 0x00011252;
		GetLastError();
		*(esp_278 - 0x10) = 0x00401000;
		GetCommandLineA();
		VirtualProtect(*(esp_278 - 0x10), *(esp_278 - 0x0C), *(esp_278 - 0x08), *(esp_278 - 0x04));
		GetCommandLineA();
		GetCommandLineA();
		*(esp_278 - 0x14) = (union Eq_158 *) dwLoc3C;
		*(esp_278 - 0x18) = 0x00;
		*(esp_278 - 0x1C) = 0x0126;
		*(esp_278 - 0x20) = 0x03;
		*(esp_278 - 0x24) = 0x00;
		*(esp_278 - 0x28) = 0x03;
		*(esp_278 - 44) = 0x40000000;
		*(esp_278 - 0x30) = 0x0042F928;
		CreateFileW(*(esp_278 - 0x30), *(esp_278 - 44), *(esp_278 - 0x28), *(esp_278 - 0x24), *(esp_278 - 0x20), *(esp_278 - 0x1C), *(esp_278 - 0x18));
		GetLastError();
		*(esp_278 - 0x34) = 0x00011252;
		*(esp_278 - 0x38) = 0x00401000;
		esp_327 = esp_278 - 0x38;
l0041275E:
		GetCommandLineA();
		union Eq_45 * esp_91 = esp_327 - 0x04;
		*esp_91 = 0x00;
		*(esp_91 - 0x04) = 388;
		*(esp_91 - 0x08) = 0x03;
		*(esp_91 - 0x0C) = 0x00;
		*(esp_91 - 0x10) = 0x04;
		*(esp_91 - 0x14) = 0x60000000;
		*(esp_91 - 0x18) = 4389101;
		CreateFileA(*(esp_91 - 0x18), *(esp_91 - 0x14), *(esp_91 - 0x10), *(esp_91 - 0x0C), *(esp_91 - 0x08), *(esp_91 - 0x04), *esp_91);
		GetLastError();
		Eq_55 eax_113 = GetCommandLineA();
		word32 esp_120;
		word32 ebp_121;
		byte SCZO_122;
		struct Eq_2 * eax_123;
		byte Z_124;
		byte SZO_125;
		byte C_126;
		word32 ecx_127;
		word32 * edx_128;
		byte * esi_129;
		byte * edi_130;
		(dwLoc3C - 3216955433)();
		eax_131 = fn00401024(eax_123, ecx_127, edx_128, esi_129, edi_130);
	}
	return eax_131;
}

