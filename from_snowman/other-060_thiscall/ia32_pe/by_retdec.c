//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2018 Retargetable Decompiler <info@retdec.com>
//

#include <stdint.h>
#include <stdlib.h>
#include <string.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _EXCEPTION_POINTERS {
    struct _EXCEPTION_RECORD * e0;
    struct _CONTEXT * e1;
};

struct _EXCEPTION_RECORD {
    int32_t e0;
    int32_t e1;
    struct _EXCEPTION_RECORD * e2;
    char * e3;
    int32_t e4;
    int32_t e5[1];
};

struct _M128A {
    int64_t e0;
    int64_t e1;
};

struct _CONTEXT {
    int64_t e0;
    int64_t e1;
    int64_t e2;
    int64_t e3;
    int64_t e4;
    int64_t e5;
    int32_t e6;
    int32_t e7;
    int16_t e8;
    int16_t e9;
    int16_t e10;
    int16_t e11;
    int16_t e12;
    int16_t e13;
    int32_t e14;
    int64_t e15;
    int64_t e16;
    int64_t e17;
    int64_t e18;
    int64_t e19;
    int64_t e20;
    int64_t e21;
    int64_t e22;
    int64_t e23;
    int64_t e24;
    int64_t e25;
    int64_t e26;
    int64_t e27;
    int64_t e28;
    int64_t e29;
    int64_t e30;
    int64_t e31;
    int64_t e32;
    int64_t e33;
    int64_t e34;
    int64_t e35;
    int64_t e36;
    int64_t e37;
    int32_t e38;
    struct _M128A e39[26];
    int64_t e40;
    int64_t e41;
    int64_t e42;
    int64_t e43;
    int64_t e44;
    int64_t e45;
};

// ------------------- Function Prototypes --------------------

void entry_point(void);
int32_t function_401000(int32_t a1, int32_t a2);
int32_t function_4010c0(int32_t a1);
int32_t function_401110(int32_t a1);
int32_t function_401150(int32_t a1);
int32_t function_401190(char * a1, int32_t a2);
void function_401541(void);
int32_t function_401550(int32_t * a1, int32_t * a2);
int32_t function_401570(int32_t a1);
int32_t function_401580(int32_t * a1);
int32_t function_401620(int32_t a1);
int32_t function_401660(int32_t a1);
int32_t function_401690(int32_t a1);
int32_t function_401700(void);
int32_t function_40175e(void);
int32_t function_4017c4(int32_t a1);
int32_t function_4017d4(void);
int32_t function_4017db(void);
int32_t function_4017e1(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4019fc(int32_t a1);
int32_t (**function_401c08(void))(struct _EXCEPTION_POINTERS *);
void function_401c16(void);
int32_t function_401d26(void);
void function_401d75(void);
void function_401dc4(void);
int32_t function_401e8d(int32_t (***a1)());
int32_t function_401f1e(void);
int32_t function_401f6d(int32_t a1);
int32_t function_401f77(void);
void function_401f7a(void);
int32_t (**function_40201b(void))();
int32_t function_4032f0(int32_t * a1, char * a2);
int32_t unknown_408330(void);

// --------------------- Global Variables ---------------------

int32_t g1 = 0; // eax
int32_t g2 = 0; // ecx
void (**g3)() = (void (**)())-0x47a90075; // 0x401d00
char * g4 = "\x33\xc0\xc3\x33\xc0\xc3\xff\x25"; // 0x401f74
int32_t g5 = -0x44bf19b2; // 0x407000
int32_t g6 = -2; // 0x407010
int32_t g7 = 1; // 0x407014
int32_t g8 = 0; // 0x407120
char *** g9 = NULL; // 0x407124
char *** g10 = NULL; // 0x407128
int32_t g11 = 0; // 0x40712c
int32_t g12 = 0; // 0x407130
int32_t g13 = 0; // 0x407134
int32_t g14 = 0; // 0x407464
int32_t g15 = 0; // 0x407468
int32_t g16 = 0; // 0x40746c
int32_t g17 = 0; // 0x407470
int32_t g18 = 0; // 0x407488
int32_t g19 = 0; // 0x407498
int32_t g20 = 0x83d0; // 0x4082a0
int32_t g21 = 0x885a; // 0x408304
int32_t g22 = 0x884e; // 0x408308

// ------------------------ Functions -------------------------

// Address range: 0x401000 - 0x4010bf
int32_t function_401000(int32_t a1, int32_t a2) {
    // 0x401000
    int32_t v1;
    function_401110(v1);
    return 0;
}

// Address range: 0x4010c0 - 0x40110f
int32_t function_4010c0(int32_t a1) {
    // 0x4010c0
    *(int32_t *)g2 = a1;
    function_401190((char *)g20, (int32_t)"MyClass::MyClass()");
    _qm__qm_6_qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEAAV01_P6AAAV01_AAV01__Z_Z();
    return g2;
}

// Address range: 0x401110 - 0x40114f
int32_t function_401110(int32_t a1) {
    // 0x401110
    function_401190((char *)g20, (int32_t)"MyClass::~MyClass()");
    _qm__qm_6_qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEAAV01_P6AAAV01_AAV01__Z_Z();
    return 0;
}

// Address range: 0x401150 - 0x40118f
int32_t function_401150(int32_t a1) {
    // 0x401150
    _qm__qm_6_qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEAAV01_H_Z();
    _qm__qm_6_qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEAAV01_P6AAAV01_AAV01__Z_Z();
    return *(int32_t *)0x40829c;
}

// Address range: 0x401190 - 0x40152f
int32_t function_401190(char * a1, int32_t a2) {
    // 0x401190
    abort();
    // UNREACHABLE
}

// Address range: 0x401541 - 0x40154f
void function_401541(void) {
    // 0x401541
    return;
}

// Address range: 0x401550 - 0x40156f
int32_t function_401550(int32_t * a1, int32_t * a2) {
    // 0x401550
    return *a1 == *a2;
}

// Address range: 0x401570 - 0x40157f
int32_t function_401570(int32_t a1) {
    // 0x401570
    return -1;
}

// Address range: 0x401580 - 0x40161f
int32_t function_401580(int32_t * a1) {
    int32_t v1 = (int32_t)a1;
    int32_t result = g2; // 0x401583
    int32_t v2 = function_401690(v1); // 0x40158e
    _qm_good_ios_base_std__QBE_NXZ();
    int32_t v3 = v2 & 255; // 0x4015a4
    if (v3 == 0) {
        // 0x4015db
        _qm_good_ios_base_std__QBE_NXZ();
        *(char *)(result + 4) = (char)v1;
        return result;
    }
    // 0x4015ab
    _qm_tie__qm__basic_ios_DU_qm__char_traits_D_std___std__QBEPAV_qm__basic_ostream_DU_qm__char_traits_D_std___2_XZ();
    if (v3 != 0) {
        // 0x4015c0
        _qm_tie__qm__basic_ios_DU_qm__char_traits_D_std___std__QBEPAV_qm__basic_ostream_DU_qm__char_traits_D_std___2_XZ();
        _qm_flush__qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEAAV12_XZ();
        // branch -> 0x4015db
    }
    // 0x4015db
    _qm_good_ios_base_std__QBE_NXZ();
    *(char *)(result + 4) = (char)v1;
    return result;
}

// Address range: 0x401620 - 0x40165f
int32_t function_401620(int32_t a1) {
    // 0x401620
    _qm_uncaught_exception_std__YA_NXZ();
    if ((g1 & 255) == 0) {
        // 0x401634
        _qm__Osfx__qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEXXZ();
        // branch -> 0x40163f
    }
    // 0x40163f
    return function_401700();
}

// Address range: 0x401660 - 0x40168f
int32_t function_401660(int32_t a1) {
    // 0x401660
    return *(char *)(g2 + 4) == 0;
}

// Address range: 0x401690 - 0x4016ff
int32_t function_401690(int32_t a1) {
    int32_t result = g2; // 0x401696
    int32_t * v1 = (int32_t *)result; // 0x40169f_0
    *v1 = a1;
    _qm_rdbuf__qm__basic_ios_DU_qm__char_traits_D_std___std__QBEPAV_qm__basic_streambuf_DU_qm__char_traits_D_std___();
    if (*(int32_t *)(*(int32_t *)a1 + 4) + *v1 != 0) {
        int32_t v2 = *(int32_t *)*v1; // eax
        _qm_rdbuf__qm__basic_ios_DU_qm__char_traits_D_std___std__QBEPAV_qm__basic_streambuf_DU_qm__char_traits_D_std___();
        int32_t v3 = *(int32_t *)v2; // 0x4016d7
        g1 = v3;
        g2 = v2;
        ((int32_t (*)())*(int32_t *)(v3 + 4))();
        // branch -> 0x4016e1
    }
    // 0x4016e1
    return result;
}

// Address range: 0x401700 - 0x40175d
int32_t function_401700(void) {
    int32_t v1 = g2; // 0x401706
    g1 = v1;
    _qm_rdbuf__qm__basic_ios_DU_qm__char_traits_D_std___std__QBEPAV_qm__basic_streambuf_DU_qm__char_traits_D_std___();
    int32_t result; // 0x40174a_2
    if (g1 != 0) {
        int32_t v2 = *(int32_t *)*(int32_t *)v1; // eax
        _qm_rdbuf__qm__basic_ios_DU_qm__char_traits_D_std___std__QBEPAV_qm__basic_streambuf_DU_qm__char_traits_D_std___();
        int32_t v3 = *(int32_t *)v2; // 0x40173d
        g1 = v3;
        g2 = v2;
        ((int32_t (*)())*(int32_t *)(v3 + 8))();
        result = g1;
        // branch -> 0x401747
    } else {
        result = 0;
    }
    // 0x401747
    return result;
}

// Address range: 0x40175e - 0x4017c3
int32_t function_40175e(void) {
    // 0x40175e
    _qm__qm_6_qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEAAV01_P6AAAV01_AAV01__Z_Z();
    return g1;
}

// Address range: 0x4017c4 - 0x4017d3
int32_t function_4017c4(int32_t a1) {
    // 0x4017c4
    if (g2 == g5) {
        // 0x4017cc
        return g1;
    }
    // 0x4017ce
    __report_gsfailure();
    return g1;
}

// Address range: 0x4017d4 - 0x4017da
int32_t function_4017d4(void) {
    int32_t len = strlen(NULL); // 0x4017d4
    g1 = len;
    return len;
}

// Address range: 0x4017db - 0x4017e0
int32_t function_4017db(void) {
    int32_t result = *(int32_t *)24; // 0x4017db
    g1 = result;
    return result;
}

// Address range: 0x4017e1 - 0x40182b
int32_t function_4017e1(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4017e1
    atexit((void (**)())&g3);
    g13 = g15;
    int32_t result = __getmainargs(&g8, (char ***)&g10, (char ***)&g9, g14, &g13); // 0x401811
    g12 = result;
    if (result <= 0) {
        // 0x401823
        _amsg_exit(8);
        // branch -> 0x40182b
    }
    // 0x40182b
    return result;
}

// Address range: 0x4019fc - 0x401ab5
int32_t function_4019fc(int32_t a1) {
    // 0x4019fc
    int32_t v1; // 0x401a53_4
    if (*(int16_t *)0x400000 == 0x5a4d) {
        int32_t v2 = *(int32_t *)0x40003c; // 0x401a0e
        if (*(int32_t *)(v2 + 0x400000) == 0x4550) {
            // 0x401a1f
            if (*(int16_t *)(v2 + 0x400018) == 267) {
                // 0x401a2d
                int32_t v3;
                if (*(int32_t *)(v2 + 0x400074) >= 15) {
                    // 0x401a36
                    v3 = *(int32_t *)(v2 + 0x4000e8) != 0;
                    // branch -> 0x401a43
                } else {
                    v3 = 0;
                }
                // 0x401a43
                g11 = v3;
                __set_app_type(1);
                v1 = (int32_t)EncodePointer((char *)-1);
                g18 = v1;
                g19 = v1;
                *(int32_t *)g21 = g17;
                *(int32_t *)g22 = g16;
                _RTC_Initialize();
                function_401f77();
                if (g7 == 0) {
                    // 0x401a90
                    __setusermatherr((int32_t)&g4);
                    // branch -> 0x401a9c
                }
                // 0x401a9c
                __setdefaultprecision();
                if (g6 == -1) {
                    // 0x401aaa
                    _configthreadlocale(-1);
                    // branch -> 0x401ab3
                }
                // 0x401ab3
                return 0;
            }
        }
    }
    // 0x401a43
    g11 = 0;
    __set_app_type(1);
    v1 = (int32_t)EncodePointer((char *)-1);
    g18 = v1;
    g19 = v1;
    *(int32_t *)g21 = g17;
    *(int32_t *)g22 = g16;
    _RTC_Initialize();
    function_401f77();
    if (g7 == 0) {
        // 0x401a90
        __setusermatherr((int32_t)&g4);
        // branch -> 0x401a9c
    }
    // 0x401a9c
    __setdefaultprecision();
    if (g6 == -1) {
        // 0x401aaa
        _configthreadlocale(-1);
        // branch -> 0x401ab3
    }
    // 0x401ab3
    return 0;
}

// Address range: 0x401ab6 - 0x401abf
void entry_point(void) {
    // 0x401ab6
    __security_init_cookie();
    _qm__qm__qm_();
}

// Address range: 0x401c08 - 0x401c15
int32_t (**function_401c08(void))(struct _EXCEPTION_POINTERS *) {
    // 0x401c08
    SetUnhandledExceptionFilter((int32_t (**)(struct _EXCEPTION_POINTERS *))0x401bc6);
    return NULL;
}

// Address range: 0x401c16 - 0x401c21
void function_401c16(void) {
    // 0x401c16
    unknown_408330();
}

// Address range: 0x401d26 - 0x401d3f
int32_t function_401d26(void) {
    // 0x401d26
    _cexit();
    return g1;
}

// Address range: 0x401d75 - 0x401d7f
void function_401d75(void) {
    // 0x401d75
    return;
}

// Address range: 0x401dc4 - 0x401dcf
void function_401dc4(void) {
    // 0x401dc4
    return;
}

// Address range: 0x401e8d - 0x401e9f
int32_t function_401e8d(int32_t (***a1)()) {
    // 0x401e8d
    return _initterm_e(NULL, a1);
}

// Address range: 0x401f1e - 0x401f23
int32_t function_401f1e(void) {
    int32_t result = _configthreadlocale(0); // 0x401f1e
    g1 = result;
    return result;
}

// Address range: 0x401f6d - 0x401f76
int32_t function_401f6d(int32_t a1) {
    // 0x401f6d
    int32_t v1;
    __setusermatherr(v1);
    return g1;
}

// Address range: 0x401f77 - 0x401f79
int32_t function_401f77(void) {
    // 0x401f77
    g1 = 0;
    return 0;
}

// Address range: 0x401f7a - 0x401f7f
void function_401f7a(void) {
    // 0x401f7a
    __set_app_type(0);
}

// Address range: 0x40201b - 0x4032ef
int32_t (**function_40201b(void))() {
    // 0x40201b
    _crt_debugger_hook();
    return (int32_t (**)())g1;
}

// Address range: 0x4032f0 - 0x404310
int32_t function_4032f0(int32_t * a1, char * a2) {
    int32_t v1 = (int32_t)a2;
    int32_t v2 = v1 + 12; // 0x4032f4
    g1 = v2;
    g2 = *(int32_t *)(v1 - 104) ^ v2;
    function_4017c4(0);
    return _CxxFrameHandler3(NULL, a1, a2, NULL);
}

// --------------- Statically Linked Functions ----------------

// void __cdecl __report_gsfailure(void);
// void __cdecl __security_init_cookie(void);
// void __setdefaultprecision(void);
// void _qm__qm__qm_(void);
// void __cdecl _RTC_Initialize(void);
// int atexit(void(* func)(void));

// --------------- Dynamically Linked Functions ---------------

// int __getmainargs(int * Argc, char *** Argv, char *** Env, int DoWildCard, _startupinfo * StartInfo);
// void __set_app_type(int at);
// void __setusermatherr(_HANDLE_MATH_ERROR pf);
// void _amsg_exit(int rterrnum);
// void __cdecl _cexit(void);
// int __cdecl _configthreadlocale(_In_ int Flag);
// void _crt_debugger_hook(void);
// int _CxxFrameHandler3(EHExceptionRecord * pExcept, EHRegistrationNode * pRN, void * pContext, void * pDC);
// int __cdecl _initterm_e(_PIFV * First, _In_ _PIFV * Last);
// void _qm__Osfx__qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEXXZ(void);
// void _qm__qm_6_qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEAAV01_H_Z(void);
// void _qm__qm_6_qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEAAV01_P6AAAV01_AAV01__Z_Z(void);
// void _qm_flush__qm__basic_ostream_DU_qm__char_traits_D_std___std__QAEAAV12_XZ(void);
// void _qm_good_ios_base_std__QBE_NXZ(void);
// void _qm_rdbuf__qm__basic_ios_DU_qm__char_traits_D_std___std__QBEPAV_qm__basic_streambuf_DU_qm__char_traits_D_std___(void);
// void _qm_tie__qm__basic_ios_DU_qm__char_traits_D_std___std__QBEPAV_qm__basic_ostream_DU_qm__char_traits_D_std___2_XZ(void);
// void _qm_uncaught_exception_std__YA_NXZ(void);
// PVOID EncodePointer(_In_opt_ PVOID Ptr);
// LPTOP_LEVEL_EXCEPTION_FILTER SetUnhandledExceptionFilter(_In_opt_ LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);
// size_t strlen(const char * s);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft linker (10.0)
// Detected functions: 32
// Decompiler release: VERSION
// Decompilation date: DATE
