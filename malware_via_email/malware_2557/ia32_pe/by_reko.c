// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0041E0D5: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
Win32CrtStartup_entry:
	esp = fp
	esp = fp - 0x04
	dwLoc04 = ebp
	ebp = fp - 0x04
	esp = fp - 0x0C
	esp = fp - 0x10
	dwLoc10 = 0x00
	eax = GetCurrentProcessId()
	esp = fp - 0x14
	dwLoc14 = 0x00
	eax = GetOEMCP()
	esp = fp - 0x18
	dwLoc18 = 0x00
	esp = fp - 0x1C
	dwLoc1C.u0 = 0x00
	esp = fp - 0x20
	dwLoc20.u0 = 0x87
	esp = fp - 0x24
	dwLoc24.u0 = 0x03
	esp = fp - 0x28
	dwLoc28 = null
	esp = fp - 44
	dwLoc2C.u0 = 0x06
	esp = fp - 0x30
	dwLoc30.u0 = 0xC0000000
	esp = fp - 0x34
	dwLoc34 = (Eq_57) &globals->t421000
	eax = CreateFileA(&globals->t421000, 0xC0000000, 0x06, null, 0x03, 0x87, 0x00)
	al = (byte) eax
	ax = (word16) eax
	ah = SLICE(eax, byte, 8)
	dwLoc08 = eax
	SCZO = cond(eax - ~0x00)
	Z = SCZO
	branch Test(NE,Z) l0041E16E
	goto l0041E121
l0041E0D5:
l0041E121:
	NTDLL.DLL!ZwFindAtom()
	esp = fp - 0x38
	dwLoc38 = eax
	eax = GetCurrentThreadId()
	esp = fp - 0x3C
	dwLoc3C.u0 = 0x7642
	esp = fp - 0x40
	dwLoc40 = (Eq_96) &globals->t53000A
	eax = GetACP()
	ecx = fn0041E187(dwLoc40, dwLoc3C, dwLoc38, out edx)
	ch = SLICE(ecx, byte, 8)
	cl = (byte) ecx
	cx = (word16) ecx
	esp = fp - 0x34
	eax = GetACP()
	eax = fp - 0x0C
	esp = fp - 0x38
	dwLoc38 = fp - 0x0C
	eax = GetOEMCP()
	esp = fp - 0x3C
	dwLoc3C.u0 = 0x40
	esp = fp - 0x40
	dwLoc40 = (struct <anonymous> *) 0x7642
	esp = fp - 0x44
	dwLoc44 = (Eq_136) &globals->t53000A
	eax = VirtualProtect(&globals->t53000A, (struct <anonymous> *) 0x7642, 0x40, dwLoc38)
	esp = fp - 0x04
	ebp = dwLoc04
	ds_ebp = ebp
	bp = (word16) ebp
	esp = fp
	bl.u0 = 0xC5
	ebx = DPB(ebx, bl, 0)
	eax = *esi
	al = (byte) eax
	rArg0 = rArg0 / *((word32) ebx - 1277495681)
	ds_ebp = *((word32) ebp - 0x497A4C24)
	ebp = ds_ebp
	ds = SLICE(ds_ebp, selector, 32)
	esi = *((word32) ebx - 792800891) *s 606652805
	ch = ch & *((word32) ecx + 0x0038)
	C.u0 = false
	v16 = *((word32) esi + 0x003D) - 0x56 - C
	*((word32) esi + 0x003D) = v16
	esp = fp - 0x02
	wLoc02 = ds
	al = al | 0x17
	eax = DPB(eax, al, 0)
	C.u0 = false
	ch = ch - *esi - C
	ecx = DPB(ecx, ch, 8)
	cx = DPB(cx, ch, 8)
	SCZO = cond(ch)
	C = SCZO
	v19 = (byte) C.u0 + ((word64) (*((word32) ebx - 1164061059)) + al)
	((word32) ebx - 1164061059)->u0 = v19
	esp = fp - 0x03
	esp = fp - 0x05
	wLoc05 = es
	rLoc1 = (real64) *(edi - 0x43)
	v23 = (*((word32) eax - 2007053636) & 0x02) != 0x00
	((word32) eax - 2007053636)->u0 = __ror(*((word32) eax - 2007053636), 0x01)
	esp = fp - 0x09
	dwLoc09 = eax
	v25 = *esi | edx
	*esi = v25
	SZO = cond(*esi)
	ebp = ebp & *((word32) ebp + 951693610)
	ds_ebp = ebp
	bp = (word16) ebp
	SZO = cond(ebp)
	C.u0 = false
	goto l0053006F
l0041E16E:
	esp = fp - 0x04
	ebp = dwLoc04
	esp = fp
	return eax
l00530031:
l0053006F:
	ebp = ebp - 0x01
	ds_ebp = ebp
	bp = (word16) ebp
	SZO = cond(ebp)
	SCZO = SZO
	Z = SZO
	CZ = SZO
	CZP = SZO
	S = SZO
	es_edi = *((word32) ecx + 0x003A)
	edi = es_edi
	di = (word16) es_edi
	ebx = *esp
	bl = (byte) ebx
	bh = SLICE(ebx, byte, 8)
	bx = (word16) ebx
	esp = (word32) esp + 0x04
	eax = *esi.u0
	al = (byte) eax
	ax = (word16) eax
	esi.u0 = (byte) esi.u0 + 0x04
	__outw(dx, ax)
	branch Test(LE,SZO) l005300F6
l0053007B:
	ch = ch & bh
	ecx = DPB(ecx, ch, 8)
	cx = DPB(cx, ch, 8)
	C.u0 = false
	al = Mem0[ebx + (uint32) al:byte]
	eax = DPB(eax, al, 0)
	ax = DPB(ax, al, 0)
	dl = ~0x19
	edx = DPB(edx, dl, 0)
	dx = DPB(dx, dl, 0)
	esi = esi - edx - C
	*edi = eax
	edi = (word32) edi + 0x04
	SCZO = cond(*((word32) ebx - 339684089) - cl)
	CZ = SCZO
	esi.u0 = 0x0FB6D6CB
	branch Test(UGT,CZ) l0053006F
l00530091:
	FPUF = cond(rLoc1 - *((word32) ebx + ebx * 0x04))
	v34 = *ecx << 0x01
	*ecx = v34
	int3()
	ax = dh * al
	eax = DPB(eax, ax, 0)
	v36 = *((word32) ebx + 0x0028) << cl
	*((word32) ebx + 0x0028) = v36
	SCZO = cond(v36)
	bl.u0 = 0xD8
	ebx = DPB(ebx, bl, 0)
	bx = DPB(bx, bl, 0)
	ebp.u0 = ~0x77490292
	esp = esp - 0x04
	*esp = eax
	edi = *esp
	es_edi = edi
	di = (word16) edi
	esp = (word32) esp + 0x04
	v37 = eax
	eax = edx
	al = (byte) eax
	ax = (word16) eax
	ah = SLICE(eax, byte, 8)
	edx = v37
	dx = (word16) edx
	dl = (byte) edx
	dh = SLICE(edx, byte, 8)
	esp = esp - 0x04
	esp->u0 = ~0x4080460D
l005300A9:
	esp = esp - 0x04
	*esp = eax
	esi = 0x0FB6D6CB ^ (bx + ~0x2223) + di
	C.u0 = false
	ebp.u0 = 2293693806
	SZO = cond(2293693806)
	es = *esp
	esp = (word32) esp + 0x02
	ecx = ecx - 0x01
	ch = SLICE(ecx, byte, 8)
	cl = (byte) ecx
	cx = (word16) ecx
	branch ecx != 0x00 l00530107
l005300B7:
	ah = FPUF
	al = 0x8C
	edi = *esp
	esp = (word32) esp + 0x04
	esi = *esp
	esp = (word32) esp + 0x04
	ebp = *esp
	bp = (word16) ebp
	esp = (word32) esp + 0x04
	esp = (word32) esp + 0x04
	ebx = *esp
	esp = (word32) esp + 0x04
	edx = *esp
	esp = (word32) esp + 0x04
	ecx = *esp
	esp = (word32) esp + 0x04
	eax = *esp
	esp = (word32) esp + 0x04
	esi.u0 = (byte) esi.u0 + 0x01
	esp = esp - 0x02
	*esp = bp
	bp = esp
	esp = esp - ~0x37B2
	FPUF = cond(rLoc1 - *esi.u0)
	v42 = *((word32) ebx - 408616268) - ecx
	*((word32) ebx - 408616268) = v42
	edi = *esp
	esp = (word32) esp + 0x04
	esi = *esp
	esp = (word32) esp + 0x04
	ebp = *esp
	esp = (word32) esp + 0x04
	esp = (word32) esp + 0x04
	ebx = *esp
	esp = (word32) esp + 0x04
	edx = *esp
	dl = (byte) edx
	esp = (word32) esp + 0x04
	ecx = *esp
	ch = SLICE(ecx, byte, 8)
	esp = (word32) esp + 0x04
	eax = *esp
	esp = (word32) esp + 0x04
	dl = (byte) ((word64) *((byte) esi.u0 + 0x004A) + dl)
	edx = DPB(edx, dl, 0)
	rLoc1 = rLoc1 / *((word32) esp + ebx * 0x04)
	ebx = ebx - 0x01
	CZP = cond(rLoc1 - rArg6)
	C = CZP
	ebp = ebp - 0x01
	eax = *esp
	esp = (word32) esp + 0x04
	esp = esp - 0x02
	*esp = cs
	esi = eax + edx
	edi = *esp
	esp = (word32) esp + 0x04
	edx = edx - 0x01
	ch = (byte) C.u0 + ((word64) (*((byte) ebp.u0 + 2494007)) + ch)
	SCZO = cond(ch)
l005300F6:
	branch Test(NS,S) l005300A9
l005300F7:
	cl = 0x50
	ecx = DPB(ecx, cl, 0)
	cx = DPB(cx, cl, 0)
l005300F8:
	esp = esp - 0x04
	*esp = eax
l005300F9:
	eax = *((word32) ebx - 774134808) *s ~0x6B
	al = (byte) eax
	ax = (word16) eax
	ah = SLICE(eax, byte, 8)
	v47 = *(edx - 113) >> 0x01
	*(edx - 113) = v47
	SCZO = cond(v47)
	Z = SCZO
	SZO = SCZO
	C = SCZO
	CZ = SCZO
	CZP = SCZO
	v48 = *esi.u0
	*esi.u0 = bl
	bl = v48
	ebx = DPB(ebx, bl, 0)
	bx = DPB(bx, bl, 0)
	branch Test(PE,P) l005300F7
l00530107:
	al = al | 0x11
	eax = DPB(eax, al, 0)
	bl.u0 = ~0x51
	ebx = DPB(ebx, bl, 0)
	rLoc1 = rLoc1 - rArg3
	eax = (word32) eax + 0x70969B99
	al = (byte) eax
	cx = cx - 0x01
	ecx = DPB(ecx, cx, 0)
	esp = esp ^ ebx
	edi = *ecx *s ~0x7C
	ds_ebp = (union Eq_2 *) 0xF7680A74
	edi = edi | *((byte) esi.u0 - 2114797115)
	ds_ebp = (union Eq_2 *) 2022583348
	C = __daa(al, &al)
	v52 = *(edx - 0x5A) | bh
	*(edx - 0x5A) = v52
	SZO = cond(*(edx - 0x5A))
	C.u0 = false
	esi = esi - *((word32) ebx - 185044540) - C
	SCZO = cond(esi)
	C = SCZO
	C = !C
	__wait()
Win32CrtStartup_exit:
}

// 0041E187: Register uint32 fn0041E187(Stack Eq_96 dwArg04, Stack Eq_2 dwArg08, Stack Eq_2 dwArg0C, Register out ptr32 edxOut)
uint32 fn0041E187(SIZE_T dwArg04, Eq_2 dwArg08, Eq_2 dwArg0C, ptr32 & edxOut)
{
	Eq_96 edx_14 = dwArg04;
	uint32 ecx_10 = dwArg08 >> 0x02;
	do
	{
		edx_14->dw0000 = edx_14->dw0000 - dwArg0C;
		edx_14->dw0000 = edx_14->dw0000 - 0x69C96A2C;
		edx_14->dw0000 = __rol(edx_14->dw0000, 166);
		edx_14->dw0000 = edx_14->dw0000 - dwArg0C;
		edx_14->dw0000 = edx_14->dw0000 ^ dwArg0C;
		edx_14->dw0000 = edx_14->dw0000 - 2031541893;
		edx_14->dw0000 = edx_14->dw0000 ^ dwArg0C;
		edx_14->dw0000 = -edx_14->dw0000;
		edx_14->dw0000 = -edx_14->dw0000;
		edx_14->dw0000 = __ror(edx_14->dw0000, 44);
		edx_14 = (Eq_96) (edx_14 + 0x01);
		*edxOut = edx_14;
		ecx_10 = ecx_10 - 0x01;
	} while (ecx_10 != 0x00);
	return ecx_10;
}

