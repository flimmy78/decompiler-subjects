// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 004244C9: Register (ptr word32) fn004244C9(Stack (ptr word32) dwArg04, Stack uint32 dwArg08, Stack word32 dwArg0C)
word32 * fn004244C9(word32 * dwArg04, uint32 dwArg08, word32 dwArg0C)
{
	word32 * edx_16 = dwArg04;
	uint32 edi_19 = dwArg08 >> 0x02;
	do
	{
		*edx_16 = *edx_16 ^ dwArg0C;
		*edx_16 = *edx_16 ^ dwArg0C;
		*edx_16 = __ror(*edx_16, 11);
		*edx_16 = __ror(*edx_16, 0x39);
		*edx_16 = __ror(*edx_16, 0x28);
		edx_16 = edx_16 + 0x01;
		edi_19 = edi_19 - 0x01;
	} while (edi_19 != 0x00);
	return edx_16;
}

// 0042451B: Register Eq_60 Win32CrtStartup()
Eq_60 Win32CrtStartup()
{
	esp = fp;
	esp = fp - 0x04;
	dwLoc04 = ebp;
	ebp = fp - 0x04;
	esp = fp - 0x28;
	esp = fp - 44;
	dwLoc2C = ebx;
	esp = fp - 0x30;
	dwLoc30 = edi;
	esp = fp - 0x34;
	dwLoc34 = esi;
	eax = GetCommandLineA();
	dwLoc18 = eax;
	esp = fp - 0x38;
	dwLoc38.u0 = 0x00;
	esp = fp - 0x3C;
	dwLoc3C.u0 = 0x0100;
	esp = fp - 0x40;
	dwLoc40.u0 = 0x03;
	esp = fp - 0x44;
	&dwLoc44.u0->nLength = 0x00;
	esp = fp - 0x48;
	dwLoc48.u0 = 0x03;
	esp = fp - 0x4C;
	dwLoc4C.u0 = 0x60000000;
	esp = fp - 0x50;
	dwLoc50.u0 = 0x00432012;
	eax = CreateFileA(0x00432012, 0x60000000, 0x03, null, 0x03, 0x0100, 0x00);
	dwLoc20 = eax;
	esp = fp - 0x54;
	dwLoc54 = 0x00;
	eax = GetCommandLineW();
	esp = fp - 88;
	dwLoc58 = 0x00;
	esp = fp - 0x5C;
	dwLoc5C = 0x00;
	esp = fp - 0x60;
	dwLoc60.u0 = 0x00432008;
	eax = GetACP();
	eax = GetCommandLineW();
	eax = GetModuleHandleA(0x00432008);
	esp = fp - 100;
	dwLoc64 = 0x00432045;
	esp = fp - 0x68;
	dwLoc68 = eax;
	esp = fp - 0x6C;
	dwLoc6C.u0 = 0x00;
	esp = fp - 0x70;
	dwLoc70.u0 = 0x26;
	esp = fp - 116;
	dwLoc74.u0 = 0x03;
	esp = fp - 0x78;
	&dwLoc78.u0->nLength = 0x00;
	esp = fp - 0x7C;
	dwLoc7C.u0 = 0x01;
	esp = fp - 0x80;
	dwLoc80.u0 = 0xC0000000;
	esp = fp - 0x84;
	dwLoc84.u0 = 0x00432000;
	eax = CreateFileA(0x00432000, 0xC0000000, 0x01, null, 0x03, 0x26, 0x00);
	dwLoc0C = eax;
	SCZO = cond(eax - ~0x00);
	Z = SCZO;
	esp = fp - 0x88;
	dwLoc88.u0 = 0x00;
	esp = fp - 0x8C;
	dwLoc8C.u0 = 0x0182;
	esp = fp - 0x90;
	dwLoc90.u0 = 0x03;
	esp = fp - 0x94;
	&dwLoc94.u0->nLength = 0x00;
	esp = fp - 0x98;
	dwLoc98.u0 = 0x05;
	esp = fp - 0x9C;
	dwLoc9C.u0 = 0xE0000000;
	esp = fp - 0xA0;
	dwLocA0.u0 = 4399129;
	eax = CreateFileA(4399129, 0xE0000000, 0x05, null, 0x03, 0x0182, 0x00);
	dwLoc08 = eax;
	eax = GetProcAddress(4399129, 0xE0000000);
	eax();
	esp = esp - 0x04;
	esp->t0000.u2 = eax;
	v10 = dwLoc20;
	esp = esp - 0x04;
	esp->t0000.u2 = v10;
	esp = esp - 0x04;
	esp->t0000 = 0x00;
	eax = SizeofResource(esp->t0000, esp->t0004);
	esp = esp - 0x04;
	esp->t0000 = 0x733C;
	esp = esp - 0x04;
	esp->t0000 = 0x00;
	v11 = dwLoc20;
	esp = esp - 0x04;
	esp->t0000.u2 = v11;
	eax = GetFileSize(esp->t0000, esp->t0004);
	esp = esp - 0x04;
	esp->t0000 = 4366336;
	esp = esp - 0x04;
	esp->t0000 = 0x00;
	esp = esp - 0x04;
	esp->t0000 = 0x01;
	esp = esp - 0x04;
	esp->t0000 = 0x03;
	esp = esp - 0x04;
	esp->t0000 = 0x00;
	esp = esp - 0x04;
	esp->t0000 = 0x00;
	esp = esp - 0x04;
	esp->t0000 = 0x40000000;
	esp = esp - 0x04;
	esp->t0000 = 0x00432074;
	eax = CreateFileA(esp->t0000, esp->t0004, esp->t0008, esp->t000C, esp->t0010, esp->t0014, esp->t0018);
	dwLoc1C = eax;
	edx = fn004244C9(dwArg00, dwArg04, dwArg08);
	esp = &esp->t000C;
	eax = fp - 0x28;
	esp = esp - 0x04;
	esp->t0000 = fp - 0x28;
	esp = esp - 0x04;
	esp->t0000 = (struct _SECURITY_ATTRIBUTES *) 0x40;
	esp = esp - 0x04;
	esp->t0000 = (struct _SECURITY_ATTRIBUTES *) 0x733C;
	esp = esp - 0x04;
	esp->t0000 = &globals->t42A000;
	v12 = dwLoc08;
	esp = esp - 0x04;
	esp->t0000.u2 = v12;
	eax = GetFileType(esp->t0000);
	eax = GetCommandLineA();
	dwLoc14 = eax;
	eax = VirtualProtect(esp->t0000, esp->t0004, esp->t0008, esp->t000C);
	eax = GetACP();
	esi = esp->t0000;
	esp = &esp->t0004;
	esp = esp - 0x04;
	esp->t0000 = 0x00;
	v13 = dwLoc08;
	esp = esp - 0x04;
	esp->t0000.u2 = v13;
	eax = GetFileSize(esp->t0000, esp->t0004);
	edi = esp->t0000;
	esp = &esp->t0004;
	eax = GetOEMCP();
	ebx = esp->t0000;
	esp = fp - 0x04;
	ebp = dwLoc04;
	esp = fp;
	eax = GetOEMCP();
	al = (byte) eax;
	v15 = (byte) ((word32) *((word32) eax + 0x001B000E) + al);
	*((word32) eax + 0x001B000E) = v15;
	SCZO = cond(*esi - 0x00);
	v16 = (byte) ((word32) *eax + al);
	*eax = v16;
	v18 = (byte) ((word32) *eax + cl);
	*eax = v18;
	es = psegArg00;
	esp = (struct Eq_61 *) ((char *) &fp->t0000 + 0x02);
	al = al + al;
	SCZO = cond(al);
	if (Test(UGT,CZ))
	{
		v22 = (byte) ((word32) *(eax - 0x01) + dh);
		*(eax - 0x01) = v22;
		SCZO = cond(v22);
		v24 = *eax - al - C;
		*eax = v24;
		SCZO = cond(v24);
		eax = (word32) eax + 0x01;
		SZO = cond(eax);
		if (Test(GT,SZO))
			;
		v26 = eax;
		eax = esi;
		esi = v26;
		edx = edx + 0x01;
		SZO = cond(edx);
	}
	edx = edx - 0x01;
	SZO = cond(edx);
}

