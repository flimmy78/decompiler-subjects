// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401005: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 eax_26 = 0x00 - ecx + edi - ecx + edi - ecx + edi - ecx + edi;
	Mem57[fp - 44 + 0x00:word32] = fn0040105F(eax_26, eax_26, 81267607, 0x00, eax);
	word32 eax_58 = Mem57[fp - 44 + 0x00:word32];
	return fn0040105F(eax_58, dwArg00, dwArg14, dwArg18, dwArg24);
}

// 0040105F: Register word32 fn0040105F(Register word32 eax, Stack word32 dwArg00, Stack word32 dwArg14, Stack word32 dwArg18, Stack word32 dwArg24)
word32 fn0040105F(word32 eax, word32 dwArg00, word32 dwArg14, word32 dwArg18, word32 dwArg24)
{
	word32 eax_14 = dwArg00;
	word16 ax_15 = (word16) dwArg00;
	do
	{
		word32 eax_25 = DPB(eax_14, ax_15 & 0x00, 0);
		word32 ecx_33 = DPB(ecx, Mem0[eax_25 + 0x00:word16], 0);
		ecx = ecx_33 + 42418;
		word16 cx_43 = (word16) (ecx_33 + 42418);
		if (cx_43 == 0x01)
			break;
		eax_14 = eax_25 - 0x00010000;
		ax_15 = (word16) (eax_25 - 0x00010000);
	} while (eax_25 != 0x00010000);
	word32 ebx_225;
	word32 ecx_226 = fn0040164A(dwArg24, fp - 0x28, out ebx_225);
	word32 esp_272;
	word32 eax_273;
	byte SZO_274;
	word32 ecx_275;
	selector cs_276;
	word32 ebp_277;
	word32 edx_278;
	word16 ax_279;
	byte C_280;
	word16 cx_281;
	byte SCZO_282;
	byte Z_283;
	word32 esi_284;
	word32 ebx_285;
	word32 edi_286;
	selector fs_287;
	Mem0[ebx_225 + 0x20:word32]();
	Mem289[esp_272 - 0x04 + 0x00:word32] = eax_273;
	word32 eax_292 = Mem289[esi_284 - 0x02 + 0x00:word32];
	Mem297[esp_272 + 0x38:word32] = eax_292 >>u 0x08;
	Mem299[esp_272 - 0x04 + 0x00:word32] = eax_292 >>u 0x08;
	word32 eax_300 = Mem299[esp_272 - 0x04 + 0x00:word32];
	Mem306[esp_272 - 0x04 + 0x00:word32] = ebx_285;
	Mem308[esp_272 - 0x04 + 0x00:word32] = Mem306[esp_272 - 0x04 + 0x00:word32] - 0x04;
	Mem311[esp_272 - 0x08 + 0x00:word32] = eax_300 + 0x01;
	Mem316[esp_272 - 0x08 + 0x00:word32] = Mem311[esp_272 - 0x08 + 0x00:word32];
	Mem321[esp_272 - 0x08 + 0x00:word32] = Mem316[esp_272 - 0x08 + 0x00:word32];
	word32 eax_322 = Mem321[esp_272 - 0x08 + 0x00:word32];
	Mem324[esp_272 + 0x3C:word32] = ebx_285;
	Mem326[esp_272 - 0x08 + 0x00:word32] = eax_322;
	word32 eax_327 = Mem326[esp_272 - 0x08 + 0x00:word32];
	word32 edi_330 = Mem326[esp_272 - 0x04 + 0x00:word32];
	Mem333[esp_272 - 0x04 + 0x00:word32] = eax_327;
	Mem335[esp_272 - 0x08 + 0x00:word32] = ecx_275;
	Mem337[esp_272 - 0x0C + 0x00:word32] = eax_327;
	word32 eax_338 = Mem337[esp_272 - 0x0C + 0x00:word32];
	Mem342[esp_272 - 0x0C + 0x00:word32] = esp_272 - 0x08;
	Mem344[esp_272 - 0x10 + 0x00:word32] = eax_338;
	word32 eax_345 = Mem344[esp_272 - 0x10 + 0x00:word32];
	Mem348[esp_272 - 0x10 + 0x00:word32] = 0x40;
	Mem350[esp_272 - 0x14 + 0x00:word32] = eax_345;
	word32 eax_351 = Mem350[esp_272 - 0x14 + 0x00:word32];
	Mem355[esp_272 - 0x14 + 0x00:word32] = Mem350[esp_272 + 0x20:word32];
	Mem357[esp_272 - 0x18 + 0x00:word32] = eax_351;
	word32 eax_358 = Mem357[esp_272 - 0x18 + 0x00:word32];
	Mem362[esp_272 - 0x18 + 0x00:word32] = Mem357[esp_272 + 0x14:word32];
	Mem364[esp_272 - 0x1C + 0x00:word32] = eax_358;
	Mem369[esp_272 - 0x1C + 0x00:word32] = Mem364[esp_272 - 0x1C + 0x00:word32];
	word32 esp_376;
	word32 eax_377;
	byte SZO_378;
	word32 ecx_379;
	selector cs_380;
	word32 ebp_381;
	word32 edx_382;
	word16 ax_383;
	byte C_384;
	word16 cx_385;
	byte SCZO_386;
	byte Z_387;
	word32 esi_388;
	word32 ebx_389;
	word32 edi_390;
	selector fs_391;
	Mem369[edi_330 + 0x0C:word32]();
	Mem393[esp_376 - 0x04 + 0x00:word32] = eax_377;
	Mem399[esp_376 + 0x00:word32] = Mem393[esp_376 - 0x04 + 0x00:word32];
	Mem405[esp_376 + 0x04:word32] = Mem399[esp_376 + 0x00:word32];
	Mem411[esp_376 + 0x08:word32] = Mem405[esp_376 + 0x04:word32];
	Mem417[esp_376 + 0x0C:word32] = Mem411[esp_376 + 0x08:word32];
	Mem423[esp_376 + 0x10:word32] = Mem417[esp_376 + 0x0C:word32];
	Mem428[esp_376 + 0x10:word32] = Mem423[esp_376 + 0x10:word32] + 0x2F;
	Mem433[esp_376 + 0x10:word32] = Mem428[fs_391:Mem428[esp_376 + 0x10:word32] + 0x00:word32];
	word32 eax_434 = Mem433[esp_376 + 0x10:word32];
	word32 ecx_439 = Mem433[eax_434 + 0x04:word32];
	Mem442[esp_376 + 0x3C:word32] = Mem433[esp_376 + 0x3C:word32] ^ ecx_439;
	Mem445[esp_376 + 0x10:word32] = eax_434 + 0x04;
	Mem450[esp_376 + 0x10:word32] = Mem445[esp_376 + 0x1C:word32];
	word32 ecx_453 = Mem450[esp_376 + 44:word32];
	Mem455[esp_376 + 0x10:word32] = Mem450[esp_376 + 0x10:word32];
	Mem461[esp_376 - 0xF8 + 0x00:word32] = Mem455[esp_376 + 0x10:word32];
	Mem466[esp_376 - 0xF8 + 0x00:word32] = Mem461[esp_376 - 0xF8 + 0x00:word32];
	word32 eax_467 = Mem466[esp_376 - 0xF8 + 0x00:word32];
	Mem473[esp_376 - 244 + 0x00:word32] = eax_467;
	Mem475[esp_376 - 0xF8 + 0x00:word32] = eax_467;
	word32 eax_476 = Mem475[esp_376 - 0xF8 + 0x00:word32];
	Mem478[esp_376 - 0xF0 + 0x00:word32] = ecx_453;
	Mem480[esp_376 - 0xF8 + 0x00:word32] = eax_476;
	Mem487[esp_376 - 0xF8 + 0x00:word32] = 0x00;
	word32 eax_488 = Mem487[esp_376 - 0xF8 + 0x00:word32];
	return fn0040133E(eax_488);
}

// 0040133E: Register word32 fn0040133E(Register word32 eax)
word32 fn0040133E(word32 eax)
{
	ptr32 fp;
	word32 eax;
	esp_1 = fp;
	ecx_3 = fp + 0x08 + eax;
	esp_4 = fp - 0x04;
	dwLoc04_5 = eax;
	eax_6 = ecx_3;
	eax_7 = Hgomiqdjr(ecx_3, dwLoc04_5);
	return eax_7;
}

// 00401346: Register word32 Hgomiqdjr(Register word32 ecx, Stack word32 dwArg00)
word32 Hgomiqdjr(word32 ecx, word32 dwArg00)
{
	Mem6[ecx + 0x00:byte] = (byte) dwArg00;
	return Nckurdj(dwArg00 + 0x01, dwArg04, dwArg08, dwArg0110, dwArg011C, dwArg0120, dwArg0134, dwArg0138, dwArg013C);
}

// 00401363: Register word32 Nckurdj(Stack word32 dwArg00, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0110, Stack word32 dwArg011C, Stack word32 dwArg0120, Stack word32 dwArg0134, Stack word32 dwArg0138, Stack word32 dwArg013C)
word32 Nckurdj(word32 dwArg00, word32 dwArg04, word32 dwArg08, word32 dwArg0110, word32 dwArg011C, word32 dwArg0120, word32 dwArg0134, word32 dwArg0138, word32 dwArg013C)
{
	if (Z)
		return fn0040133E(dwArg00);
	else
	{
		word32 ecx_109 = 0x00;
		word32 esi_107 = 0x00;
		word32 ebp_108 = 0x00;
		word32 eax_111 = dwArg00;
		do
		{
			word32 eax_114 = DPB(eax_111, Mem0[fp + 0x0C + ebp_108:byte], 8);
			byte dl_142 = (byte) ((word32) Mem0[ecx_109 + dwArg08:byte] + ((word32) SLICE(eax_114, byte, 8) + esi_107));
			word32 edx_147 = (word32) dl_142;
			ecx_109 = ecx_109 + 0x01;
			if (ecx_109 >=u dwArg011C)
				ecx_109 = 0x00;
			byte al_176 = Mem0[fp + 0x0C + edx_147:byte];
			word32 eax_177 = DPB(eax_114, al_176, 0);
			word32 esi_185 = fp + 0x0C + ebp_108;
			Mem186[esi_185 + 0x00:byte] = 0x00;
			Mem193[esi_185 + 0x00:byte] = Mem186[esi_185 + 0x00:byte] + al_176;
			Mem226[fp - 0x0C + (edx_147 + 0x18):byte] = SLICE(eax_177, byte, 8);
			ebp_108 = ebp_108 + 0x01;
			eax_111 = eax_177;
			esi_107 = edx_147;
		} while (ebp_108 <u 0x0100);
		word32 ecx_254 = dwArg0138;
		byte ch_255 = SLICE(dwArg0138, byte, 8);
		if (ch_255 == ~0x05)
		{
			word32 esi_377 = 0x00;
			word32 ebp_396 = dwArg0120;
			word32 edi_403 = dwArg04;
			if (true)
			{
				word32 eax_463 = 0x00;
				do
				{
					word32 eax_482 = (word32) (byte) (eax_463 + 0x01);
					byte cl_487 = Mem226[fp + 0x0C + eax_482:byte];
					word32 edx_504 = (word32) (byte) ((word32) cl_487 + esi_377);
					word32 ecx_488 = DPB(ecx_254, cl_487, 0);
					byte dl_514 = Mem226[fp + 0x0C + edx_504:byte];
					Mem524[fp + 0x0C + eax_482:byte] = dl_514;
					Mem542[fp + 0x0C + edx_504:byte] = cl_487;
					esi_377 = edx_504;
					Mem597[edi_403 + 0x00:byte] = Mem542[edi_403 + 0x00:byte] ^ Mem542[(fp - 0x08) + ((word32) ((byte) (Mem542[(fp + 0x0C) + eax_482:word32] + ecx_488)) + 0x14):byte];
					ecx_254 = 0x00;
					edi_403 = edi_403 + 0x01;
					ebp_396 = ebp_396 - 0x01;
					eax_463 = eax_482;
				} while (ebp_396 != 0x00);
			}
			return dwArg0110;
		}
		else
		{
			word32 esp_279;
			word32 eax_280;
			byte Z_281;
			word32 ecx_282;
			selector cs_283;
			word32 ebp_284;
			word32 esi_285;
			word32 edi_286;
			byte SZO_287;
			byte C_288;
			word32 ebx_289;
			byte ah_290;
			word32 edx_291;
			byte SCZO_292;
			byte dl_293;
			byte al_294;
			byte bh_295;
			byte ch_296;
			byte CZ_297;
			byte cl_298;
			Mem226[dwArg013C - 0x04 + 0x00:word32]();
			Mem300[esp_279 - 0x04 + 0x00:word32] = eax_280;
			do
			{
				word32 esp_305;
				word32 eax_306;
				byte Z_307;
				word32 ecx_308;
				selector cs_309;
				word32 ebp_310;
				word32 esi_311;
				word32 edi_312;
				byte SZO_313;
				byte C_314;
				word32 ebx_315;
				byte ah_316;
				word32 edx_317;
				byte SCZO_318;
				byte dl_319;
				byte al_320;
				byte bh_321;
				byte ch_322;
				byte CZ_323;
				byte cl_324;
				Mem300[ebx_289 + 0x08:word32]();
				Mem326[esp_305 - 0x04 + 0x00:word32] = eax_306;
				Mem331[esp_305 - 0x04 + 0x00:word32] = Mem326[esp_305 - 0x04 + 0x00:word32];
				word32 eax_332 = Mem331[esp_305 - 0x04 + 0x00:word32];
				Mem337[esp_305 + 0x00:word32] = Mem331[esp_305 + 0x00:word32] | eax_332;
			} while (ebp_310 != 0x01);
			Mem346[esp_305 - 0x04 + 0x00:word32] = eax_332;
			Mem350[esp_305 - 0x04 + 0x00:word32] = Mem346[esp_305 - 0x04 + 0x00:word32];
			word32 esp_353;
			word32 eax_354;
			byte Z_355;
			word32 ecx_356;
			selector cs_357;
			word32 ebp_358;
			word32 esi_359;
			word32 edi_360;
			byte SZO_361;
			byte C_362;
			word32 ebx_363;
			byte ah_364;
			word32 edx_365;
			byte SCZO_366;
			byte dl_367;
			byte al_368;
			byte bh_369;
			byte ch_370;
			byte CZ_371;
			byte cl_372;
			Mem350[ebx_315 + 0x14:word32]();
			Mem374[esp_353 - 0x04 + 0x00:word32] = eax_354;
		}
	}
}

// 0040164A: Register word32 fn0040164A(Stack word32 dwArg00, Stack word32 dwArg04, Register out ptr32 ebxOut)
word32 fn0040164A(word32 dwArg00, word32 dwArg04, ptr32 & ebxOut)
{
	word32 eax_117 = dwArg00;
	do
	{
		word16 ax_31 = Mem0[DPB(eax_117, 0x00, 0) + 0x00:word16];
		word32 eax_39 = DPB(eax_117, ax_31 + 42421, 0);
		word32 eax_121 = eax_39;
		if (ax_31 == 42419)
			goto l004016AA;
		eax_117 = eax_39 - 0x00010000;
	} while (eax_39 != 0x00010000);
	eax_121 = eax_39 - 0x00010000;
l004016AA:
	word32 eax_56 = DPB(eax_121, 0x00, 0);
	word32 ecx_64 = Mem0[eax_56 + 0x3C:word32];
	word32 ecx_65 = eax_56 + ecx_64;
	word32 ecx_76 = Mem0[eax_56 + Mem0[ecx_65 + 0x80:word32]:word32];
	word32 ebx_91;
	*ebxOut = eax_56 + ecx_76 + 0x04;
	return ecx_76;
}

