// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401050: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 ebx_10 = Mem0[fs:0x18:word32];
	word32 edx_15 = fn00401170(ebx_10 + 0x0C00);
	Mem20[fp + ~0x1C4A + edx_15:word32] = edx_15;
	word32 eax_27 = 18966608 - (edx_15 << 11) & 0x00E05800 - (edx_15 << 11);
	word32 edx_36 = fp + ~0x1C3E + dwLoc20;
	Mem37[edx_36 + 0x00:word32] = (eax_27 + ~0x003835B3)[edx_15 * 0x0200] - 0x28;
	word32 eax_41 = eax_27 + Mem37[(((eax_27 + ~0x003835B3) + (edx_15 << 0x09)) - 0x04) + 0x00:word32] + 0x1C53 - dwLoc20;
	Mem46[fp - 0x5C + 0x00:word32] = dwLoc20;
	word32 esi_48;
	word32 ecx_49 = fn00401220(dwArg00, out esi_48);
	Mem53[fp - 0x5C + 0x00:word32] = fp - 0x08;
	Mem55[fp - 0x60 + 0x00:word32] = 0x04;
	Mem57[fp - 100 + 0x00:word32] = ecx_49;
	Mem59[fp - 0x68 + 0x00:word32] = esi_48;
	fn004011B0(dwLoc20, ebx_10, ebp);
	Mem63[fp - 0x6C + 0x00:word32] = dwLoc20;
	Mem70[fp - 0x70 + 0x00:word32] = dwLoc14;
	Mem73[fp - 116 + 0x00:word32] = eax_41;
	word32 esp_74;
	word32 ebp_75;
	byte SCZO_76;
	word32 ebx_77;
	selector fs_78;
	word32 esi_79;
	word32 eax_80;
	word32 edi_81;
	word32 ecx_82;
	word32 edx_83;
	byte SZO_84;
	byte C_85;
	(dwLoc20 + 4191461)();
	Mem93[esp_74 - 0x04 + 0x00:word32] = 0x00;
	word32 v19_90 = eax_41 + 0x1C5B - dwLoc20;
	Mem98[esp_74 - 0x08 + 0x00:word32] = v19_90 + 0x0BCA;
	word32 esp_99;
	word32 ebp_100;
	byte SCZO_101;
	word32 ebx_102;
	selector fs_103;
	word32 esi_104;
	word32 eax_105;
	word32 edi_106;
	word32 ecx_107;
	word32 edx_108;
	byte SZO_109;
	byte C_110;
	v19_90();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	int3();
	Mem112[esp_99 - 0x04 + 0x00:word32] = fp - 0x04;
	word32 edx_116 = Mem112[esp_99 + 0x0C:word32];
	word32 ecx_118 = Mem112[esp_99 + ~0x1C22 + edx_116:word32];
	word32 ebx_121 = (esp_99 + ~0x70A7)[edx_116 * 0x04];
	Mem123[esp_99 - 0x10 + 0x00:word32] = 129400141;
	word32 eax_126 = Mem123[esp_99 - 0x10 + 0x00:word32] - (edx_116 << 0x02);
	Mem128[esp_99 - 0x10 + 0x00:word32] = 0x0DBC8BEB;
	Mem129[esp_99 - 0x08 + 0x00:word32] = 0x01;
	Mem130[esp_99 - 0x0C + 0x00:word32] = Mem129[esp_99 - 0x10 + 0x00:word32];
	Mem133[esp_99 - 0x0C + 0x00:word32] = Mem130[esp_99 - 0x0C + 0x00:word32] + (edx_116 << 0x02);
	while (true)
	{
		Mem140[ebx_121 + 0x00:word32] = Mem133[ebx_121 + 0x00:word32] ^ eax_126;
		ecx_118 = ecx_118 - 0x04;
		if (ecx_118 <= 0x00)
			break;
		eax_126 = eax_126 + Mem140[(esp_99 - 0x0C) + 0x00:word32] + Mem140[(esp_99 - 0x08) + 0x00:word32];
		ebx_121 = ebx_121 + 0x1C2F - Mem140[esp_99 + 0x0C:word32];
		Mem150[esp_99 - 0x08 + 0x00:word32] = -Mem140[esp_99 - 0x08 + 0x00:word32];
	}
	return eax_126;
}

// 00401170: Register word32 fn00401170(Register word32 esi)
word32 fn00401170(word32 esi)
{
	word32 eax_7 = CancelIo + ~0x00;
	word32 esp_14;
	word32 ecx_15;
	word32 edx_16;
	word32 eax_17;
	byte SCZO_18;
	byte cl_19;
	byte Z_20;
	byte SZO_21;
	word32 esi_22;
	eax_7();
	return Mem0[esi_22 + ~0x0B:word32] - 3221218269;
}

// 004011B0: void fn004011B0(Register word32 ecx, Register word32 edi, Stack word32 dwArg00)
void fn004011B0(word32 ecx, word32 edi, word32 dwArg00)
{
	word32 eax_4 = fn004011C0(ecx, edi);
	fn004011E0(eax_4);
	word32 esp_8;
	word32 ebx_9;
	word32 eax_10;
	word32 ecx_11;
	word32 edi_12;
	eax_4();
	Mem14[esp_8 - 0x04 + 0x00:word32] = ebx_9;
}

// 004011C0: Register word32 fn004011C0(Register word32 ecx, Register word32 edi)
word32 fn004011C0(word32 ecx, word32 edi)
{
	return Mem0[Mem0[Mem0[Mem0[(edi + 4294952922)[ecx * 0x02] + 0x0C:word32] + 0x1C:word32] + 0x00:word32] + 0x08:word32];
}

// 004011E0: void fn004011E0(Register word32 eax)
void fn004011E0(word32 eax)
{
	word32 esi_11 = Mem0[Mem0[Mem0[eax + 0x3C:word32] + eax + 0x78:word32] + eax + 0x20:word32] + eax;
	word32 edx_15 = 0x00;
	while (Mem0[Mem0[esi_11 + edx_15:word32] + eax + 0x0C:word32] != 0x56007463)
		edx_15 = edx_15 + 0x04;
}

// 00401220: Register word32 fn00401220(Stack word32 dwArg04, Register out ptr32 esiOut)
word32 fn00401220(word32 dwArg04, ptr32 & esiOut)
{
	word32 eax_14 = (dwArg04 << 11) + 4284398112 & 0x006FAC00 - (dwArg04 << 0x0A);
	word32 eax_18 = eax_14 + 14768188 - (dwArg04 << 11);
	word32 esi_15;
	*esiOut = eax_14;
	return Mem0[Mem0[eax_18 + 0x00:word32] + 0x14 + eax_18:word32];
}

