// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00425C9A: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	GetCommandLineW();
	GetACP();
	GetCommandLineW();
	GetACP();
	Eq_13 eax_29 = LoadLibraryA(&globals->t43302A);
	GetCommandLineA();
	GetProcAddress(eax_29, &globals->t433034)();
	GetCommandLineW();
	ptr32 esp_150 = fp - 0x54;
l00425CED:
	HRSRC * ebp_105;
	word32 * esp_67 = esp_150 - 0x04;
	*esp_67 = 36362;
	*(esp_67 - 0x04) = 0x00429000;
	*(ebp_105 - 0x28) = (LPSTR *) GetCommandLineA();
	*(esp_67 - 0x08) = 0x00;
	ptr32 esp_177 = esp_67 - 0x08;
	do
	{
		struct Eq_84 * esp_85 = esp_177 - 0x04;
		esp_85->t0000 = 0x84;
		*(esp_85 - 0x04) = 0x03;
		*(esp_85 - 0x08) = 0x00;
		*(esp_85 - 0x0C) = 0x01;
		*(esp_85 - 0x10) = 0xC0000000;
		*(esp_85 - 0x14) = 4403223;
		Eq_92 eax_97 = CreateFileA(*(esp_85 - 0x14), *(esp_85 - 0x10), *(esp_85 - 0x0C), *(esp_85 - 0x08), *(esp_85 - 0x04), esp_85->t0000, esp_85->t0004);
		*(ebp_105 - 0x20) = (HANDLE *) eax_97;
		esp_150 = esp_85 - 0x14;
		if (eax_97 != (void *) ~0x00)
			goto l00425CED;
		ptr32 ecx_106 = fn00425E9B(dwArg00, dwArg04, dwArg08, out ebp_105);
		GetCurrentThreadId();
		*(esp_85 - 0x0C) = *(ebp_105 - 0x20);
		GetFileType(*(esp_85 - 0x0C));
		*(esp_85 - 0x10) = ebp_105 - 0x0C;
		*(esp_85 - 0x14) = *(ebp_105 - 0x20);
		CloseHandle(*(esp_85 - 0x14));
		*(esp_85 - 0x18) = 0x40;
		GetOEMCP();
		*(esp_85 - 0x1C) = *(ebp_105 - 0x20);
		*(esp_85 - 0x20) = 0x00;
		SizeofResource(*(esp_85 - 0x20), *(esp_85 - 0x1C));
		*(esp_85 - 0x24) = 36362;
		*(esp_85 - 0x28) = 0x00429000;
		GetACP();
		*(esp_85 - 44) = *(ebp_105 - 0x20);
		GetFileType(*(esp_85 - 44));
		VirtualProtect(*(esp_85 - 44), *(esp_85 - 0x28), *(esp_85 - 0x24), *(esp_85 - 0x20));
		*(esp_85 - 0x30) = *(ebp_105 - 0x20);
		*(esp_85 - 0x34) = 0x00;
		SizeofResource(*(esp_85 - 0x34), *(esp_85 - 0x30));
		*(esp_85 - 0x38) = *(ebp_105 - 0x20);
		*(esp_85 - 0x3C) = 0x00;
		Eq_267 eax_152 = LoadResource(*(esp_85 - 0x3C), *(esp_85 - 0x38));
		*(ebp_105 - 0x24) = (HGLOBAL *) eax_152;
		byte ch_107 = SLICE(ecx_106, byte, 8);
		byte cl_108 = (byte) ecx_106;
		esp_150 = esp_85 - 0x3C;
		if (eax_152 != null)
			goto l00425CED;
		ui32 esi_158 = *(esp_85 - 0x3C);
		GetCurrentThreadId();
		ptr32 edi_161 = *(esp_85 - 0x38);
		*(ebp_105 - 0x14) = (LPSTR *) GetCommandLineA();
		*(esp_85 - 0x38) = 0x00;
		*(esp_85 - 0x3C) = 0x24;
		*(esp_85 - 0x40) = 0x03;
		*(esp_85 - 0x44) = 0x00;
		*(esp_85 - 0x48) = 0x06;
		*(esp_85 - 0x4C) = 0xA0000000;
		*(esp_85 - 0x50) = 0x00433000;
		Eq_92 eax_179 = CreateFileA(*(esp_85 - 0x50), *(esp_85 - 0x4C), *(esp_85 - 0x48), *(esp_85 - 0x44), *(esp_85 - 0x40), *(esp_85 - 0x3C), *(esp_85 - 0x38));
		*(ebp_105 - 0x1C) = (HANDLE *) eax_179;
		esp_177 = esp_85 - 0x50;
	} while (eax_179 != (void *) ~0x00);
	int32 ebx_184 = *(esp_85 - 0x50);
	Eq_153 ebp_187 = *ebp_105;
	*ebp_105 = *(ebp_187 - 0x20);
	*(ebp_105 - 0x04) = 0x00;
	byte bl_185 = (byte) ebx_184;
	DWORD eax_194 = SizeofResource(*(ebp_105 - 0x04), *ebp_105);
	edx_47->ptr4670858D = edx_47;
	ebp_187->dw9D8D9288 = *(ebp_105 - 0x04);
	ecx_106 - 99 + ebx_184 = (byte *) ch_107;
	(edi_161 - 99)[eax_194].b0000 = bl_185;
	ebp_187->b59ED9DE5 = cl_108;
	*((word32) eax_194 + (esi_158 * 0x04 - 634325089)) = (Eq_2) bl_185;
	edx_47->dw1967E8B0 = edx_47->dw1967E8B0 >> 0x01;
}

// 00425E9B: Register word32 fn00425E9B(Stack (ptr word32) dwArg04, Stack uint32 dwArg08, Stack word32 dwArg0C, Register out ptr32 ebpOut)
word32 fn00425E9B(word32 * dwArg04, uint32 dwArg08, word32 dwArg0C, ptr32 & ebpOut)
{
	word32 * esi_17 = dwArg04;
	uint32 ebx_20 = dwArg08 >> 0x02;
	do
	{
		*esi_17 = *esi_17 + dwArg0C;
		*esi_17 = __rol(*esi_17, 0x11);
		*esi_17 = -*esi_17;
		*esi_17 = *esi_17 + dwArg0C;
		*esi_17 = *esi_17 - 272779949;
		*esi_17 = __ror(*esi_17, 0xA9);
		*esi_17 = *esi_17 - ~0x333B0B44;
		*esi_17 = *esi_17 - dwArg0C;
		*esi_17 = -*esi_17;
		*esi_17 = *esi_17 + dwArg0C;
		esi_17 = esi_17 + 0x01;
		ebx_20 = ebx_20 - 0x01;
	} while (ebx_20 != 0x00);
	word32 ebp_58;
	*ebpOut = ebp;
	return dwArg0C;
}

