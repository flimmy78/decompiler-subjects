// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401000: Register word32 fn00401000()
word32 fn00401000()
{
	word64 edx_eax_11 = __rdtsc();
	word32 eax_13 = (word32) edx_eax_11;
	return eax_13 ^ __rol(SLICE(edx_eax_11, word32, 32) *s eax_13 + SCZDOP, (byte) (eax_13 & 0x0F));
}

// 00401017: Register word16 fn00401017(Stack word32 dwArg04)
word16 fn00401017(word32 dwArg04)
{
	word32 ecx_12 = 0x00;
	word32 edi_19 = dwArg04;
	while (true)
	{
		edi_19 = edi_19 + 0x01;
		if (0x00 == Mem0[edi_19 + 0x00:byte])
			break;
		ecx_12 = ecx_12 + 0x01;
	}
	return (word16) ecx_12;
}

// 0040103C: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 eax_35;
	word32 esp_19;
	word32 ebp_20;
	word32 esi_21;
	byte SZO_22;
	byte C_23;
	word32 eax_24;
	byte SCZO_25;
	byte Z_26;
	byte cl_27;
	comdlg32.dll!LoadAlterBitmap();
	if (dwArg0C == 0x00 && (dwArg08 <u 0x04 && (word32) wArg04 == 0x00))
	{
		Mem72[esp_19 - 0x04 + 0x00:word32] = 0x00;
		Mem74[esp_19 - 0x08 + 0x00:word32] = 0x00;
		Mem76[esp_19 - 0x0C + 0x00:word32] = 0x00;
		word32 eax_78 = CreateMutexW(Mem76[esp_19 - 0x0C + 0x00:LPSECURITY_ATTRIBUTES], Mem76[esp_19 - 0x08 + 0x00:BOOL], Mem76[esp_19 - 0x04 + 0x00:LPCWSTR]);
		Mem81[esp_19 - 0x10 + 0x00:word32] = 0x02;
		word32 eax_83 = SetErrorMode(Mem81[esp_19 - 0x10 + 0x00:UINT]);
		Mem85[esp_19 - 0x14 + 0x00:word32] = eax_78;
		Mem87[esp_19 - 0x18 + 0x00:word32] = eax_83;
		Mem90[esp_19 - 0x1C + 0x00:word32] = dwArg08;
		Mem93[esp_19 - 0x20 + 0x00:word32] = dwArg04;
		word32 esi_94;
		eax_35 = fn004014DC(cl_27, ebp_20, dwArg00, dwArg04, dwArg0C, out esi_94);
	}
	else
	{
		Mem47[esp_19 - 0x04 + 0x00:word32] = 0x00;
		Mem49[esp_19 - 0x08 + 0x00:word32] = 0x00;
		Mem51[esp_19 - 0x0C + 0x00:word32] = 0x29;
		Mem53[esp_19 - 0x10 + 0x00:word32] = 0x00;
		word32 esi_56;
		fn004014DC(cl_27, ebp_20, dwArg00, dwArg04, dwArg0C, out esi_56);
		Mem60[esp_19 - 0x04 + 0x00:word32] = esi_56;
		ExitThread(Mem60[esp_19 - 0x04 + 0x00:DWORD]);
		eax_35 = 0x1F00;
	}
	return eax_35;
}

// 004010B5: void fn004010B5(Register word32 ecx, Register word32 edx)
void fn004010B5(word32 ecx, word32 edx)
{
	word32 eax_6 = Mem0[Mem0[edx + 0x3C:word32] + edx + 0x78:word32];
	if (eax_6 != 0x00)
	{
		word32 eax_30 = eax_6 + edx;
		Mem33[eax_30 + 0x1C:word32] = Mem0[eax_30 + 0x1C:word32] + ecx;
		Mem35[eax_30 + 0x24:word32] = Mem33[eax_30 + 0x24:word32] + ecx;
		Mem37[eax_30 + 0x20:word32] = Mem35[eax_30 + 0x20:word32] + ecx;
		Mem39[eax_30 + 0x0C:word32] = Mem37[eax_30 + 0x0C:word32] + ecx;
		word32 edi_45 = Mem39[eax_30 + 0x1C:word32] + edx;
		word32 esi_46 = 0x00;
		if (Mem39[eax_30 + 0x14:word32] >u 0x00)
		{
			do
			{
				edi_45[esi_46 * 0x04] = edi_45[esi_46 * 0x04] + ecx;
				word32 v18_75 = esi_46 + 0x01;
				esi_46 = v18_75;
			} while (v18_75 <u Mem72[eax_30 + 0x14:word32]);
		}
		word32 esi_53 = Mem39[eax_30 + 0x20:word32] + edx;
		word32 edx_54 = 0x00;
		if (Mem39[eax_30 + 0x18:word32] >u 0x00)
		{
			do
			{
				esi_53[edx_54 * 0x04] = esi_53[edx_54 * 0x04] + ecx;
				edx_54 = edx_54 + 0x01;
			} while (edx_54 <u Mem66[eax_30 + 0x18:word32]);
		}
	}
}

// 00401123: Register word32 fn00401123(Register byte cl, Register word32 ebx)
word32 fn00401123(byte cl, word32 ebx)
{
	word32 ecx_13 = Mem0[ebx + 0x00:word32];
	Mem15[ebx + 0x28:word32] = Mem0[ebx + 0x28:word32] & 0x00;
	word32 eax_19 = Mem15[Mem15[ecx_13 + 0x3C:word32] + 0x10 + ecx_13:word32] + ecx_13;
	word32 dwLoc0C_119 = eax_19;
	word32 edi_35 = ebx + 0x04;
	word32 esi_36 = eax_19 - ~0x0B;
	word32 ecx_37 = 0x24;
	while (ecx_37 != 0x00)
	{
		Mem44[edi_35 + 0x00:byte] = Mem15[esi_36 + 0x00:byte];
		esi_36 = esi_36 + 0x01;
		edi_35 = edi_35 + 0x01;
		ecx_37 = ecx_37 - 0x01;
	}
	word32 eax_49 = Mem15[ebx + 0x04:word32];
	Mem51[ebx + 0x14:word32] = Mem15[ebx + 0x14:word32] - eax_49;
	Mem53[ebx + 0x1C:word32] = Mem51[ebx + 0x1C:word32] + eax_49;
	Mem57[ebx + 0x0C:word32] = Mem53[ebx + 0x0C:word32] + eax_49 *s ~0x07;
	Mem63[ebx + 0x18:word32] = Mem57[ebx + 0x18:word32] + eax_49 *s ~0x0F;
	Mem66[ebx + 0x10:word32] = Mem63[ebx + 0x10:word32] + -eax_49 * 0x02;
	word32 ecx_68 = Mem66[ebx + 0x10:word32];
	word32 eax_111 = VirtualAlloc(0x00, ecx_68 + 0x24, 0x3000, 0x40);
	Mem80[ebx + 0x28:word32] = eax_111;
	word32 dwLoc08_118 = eax_111;
	word32 dwLoc10_115 = 0x04;
	do
	{
		word32 edi_101 = dwLoc08_118;
		word32 esi_100 = dwLoc0C_119 + 0x0C;
		word32 ecx_102 = Mem80[dwLoc0C_119 + 0x08:word32];
		while (ecx_102 != 0x00)
		{
			Mem105[edi_101 + 0x00:byte] = Mem80[esi_100 + 0x00:byte];
			esi_100 = esi_100 + 0x01;
			edi_101 = edi_101 + 0x01;
			ecx_102 = ecx_102 - 0x01;
		}
		word32 v23_114 = dwLoc10_115 - 0x01;
		eax_111 = eax_111 + Mem80[dwLoc0C_119 + 0x08:word32];
		dwLoc10_115 = v23_114;
		dwLoc08_118 = eax_111;
		dwLoc0C_119 = Mem80[dwLoc0C_119 + 0x00:word32] + Mem80[ebx + 0x00:word32];
	} while (v23_114 != 0x00);
	Mem121[ebx + 0x28:word32] = Mem80[ebx + 0x28:word32] + 11;
	Mem123[ebx + 0x28:word32] = Mem121[ebx + 0x28:word32] + 0x19;
	return ecx_68 + 0x24;
}

// 004011EA: Register word32 fn004011EA(Register word32 edi, Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn004011EA(word32 edi, word32 dwArg04, word32 dwArg08)
{
	word32 eax_111;
	word32 eax_15 = Mem0[dwArg04 + 0x3C:word32] + dwArg04;
	word32 esi_19 = Mem0[eax_15 + 0x78:word32];
	if (esi_19 == 0x00)
	{
		eax_111 = 0x00;
		return eax_111;
	}
	word32 edi_119;
	word32 esi_66 = esi_19 + dwArg04;
	word32 eax_61 = Mem0[eax_15 + 0x7C:word32];
	word32 eax_73 = Mem0[esi_66 + 0x24:word32] + dwArg04;
	word32 ebx_74 = Mem0[esi_66 + 0x20:word32] + dwArg04;
	word32 edi_75 = Mem0[esi_66 + 0x1C:word32] + dwArg04;
	if (dwArg08 < 0x00)
	{
		word32 edx_181 = (dwArg08 & 0x7FFFFFFF) - Mem0[esi_66 + 0x10:word32];
		if (edx_181 >=u Mem0[esi_66 + 0x14:word32])
			goto l00401317;
		edi_119 = edi_75[edx_181 * 0x04];
	}
	else
	{
		word32 edx_185 = 0x00;
		byte Z_188 = cond(0x00 - Mem0[esi_66 + 0x18:word32]);
		word32 dwLoc08_191 = 0x00;
		if (0x00 <u Mem0[esi_66 + 0x18:word32])
		{
			while (dwArg08 != fn0040175F(dwArg04, ebx_74[edx_185 * 0x04] + dwArg04))
			{
				word32 v15_222 = dwLoc08_191 + 0x01;
				dwLoc08_191 = v15_222;
				if (v15_222 >=u Mem0[esi_66 + 0x18:word32])
					break;
				edx_185 = v15_222;
			}
			edx_185 = dwLoc08_191;
			Z_188 = cond(dwLoc08_191 - Mem0[esi_66 + 0x18:word32]);
		}
		if (Z_188)
		{
l00401317:
			eax_111 = 0x00;
			return eax_111;
		}
		edi_119 = edi_75[(word32) eax_73[edx_185 * 0x02] * 0x04];
	}
	word32 edi_122 = edi_119 + dwArg04;
	if (edi_122 <u eax_61 + esi_66 && edi_122 >=u esi_66)
	{
		word32 esi_141 = 0x00;
		if (Mem0[edi_122 + 0x00:byte] != 0x2E)
		{
			do
				esi_141 = esi_141 + 0x01;
			while (Mem0[esi_141 + edi_122:byte] != 0x2E);
		}
		memcpy(fp - 0x0114, edi_122, esi_141);
		Mem161[fp - 0x0114 + esi_141:byte] = 0x00;
		word32 eax_162 = LoadLibraryA(fp - 0x0114);
		if (eax_162 == 0x00)
			goto l00401317;
		edi_122 = fn004011EA(edi_122, eax_162, fn0040175F(dwArg04, esi_141 + 0x01 + edi_122));
	}
	eax_111 = edi_122;
	return eax_111;
}

// 00401339: Register word32 fn00401339(Register word32 ecx, Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Register out ptr32 ebxOut, Register out ptr32 ediOut)
word32 fn00401339(word32 ecx, word32 ebp, word32 dwArg04, word32 dwArg08, word32 dwArg0C, ptr32 & ebxOut, ptr32 & ediOut)
{
	*ediOut = edi;
	*ebxOut = ebx;
	word32 ecx_19 = (word32) Mem0[dwArg08 + 0x0C:word16];
	word32 dwLoc08_10 = ecx & 0x00;
	word32 eax_20 = (word32) Mem0[dwArg08 + 0x0E:word16] + ecx_19;
	if (eax_20 != 0x00)
	{
		word32 ebx_51 = dwArg0C;
		word32 esp_53 = fp - 0x14;
		word32 edi_56 = dwArg04;
		word32 dwArg08_57 = dwArg08 + 0x14;
		do
		{
			word32 eax_66 = Mem0[dwArg08_57 + 0x00:word32];
			if (eax_66 < 0x00)
			{
				word32 esp_89 = esp_53 - 0x04;
				Mem90[esp_89 + 0x00:word32] = ebx_51;
				Mem94[esp_89 - 0x04 + 0x00:word32] = (eax_66 & 0x7FFFFFFF) + edi_56;
				Mem96[esp_89 - 0x08 + 0x00:word32] = edi_56;
				fn00401339(ecx_19, fp - 0x04, dwArg00, dwArg04, dwArg08_57, out ebx_51, out edi_56);
				esp_53 = esp_89 - 0x08;
			}
			else
			{
				word32 eax_101 = eax_66 + edi_56;
				Mem103[eax_101 + 0x00:word32] = Mem0[eax_101 + 0x00:word32] + ebx_51;
			}
			word32 v15_75 = dwLoc08_10 + 0x01;
			ecx_19 = (word32) Mem0[dwArg08 + 0x0C:word16];
			dwLoc08_10 = v15_75;
			dwArg08_57 = dwArg08_57 + 0x08;
			eax_20 = (word32) Mem0[dwArg08 + 0x0E:word16] + ecx_19;
		} while (v15_75 <u eax_20);
		word32 edi_84;
		*ediOut = Mem0[esp_53 + 0x00:word32];
		word32 ebx_86;
		*ebxOut = Mem0[esp_53 + 0x04:word32];
	}
	return eax_20;
}

// 004013AE: Register word32 fn004013AE(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg10, Register out ptr32 esiOut)
word32 fn004013AE(word32 dwArg04, word32 dwArg08, word32 dwArg10, ptr32 & esiOut)
{
	*esiOut = esi;
	word32 edi_17 = fp - 0x010C;
	word32 ecx_18 = 0x0100;
	while (ecx_18 != 0x00)
	{
		Mem24[edi_17 + 0x00:byte] = 0x00;
		edi_17 = edi_17 + 0x01;
		ecx_18 = ecx_18 - 0x01;
	}
	word32 ebx_103 = 0x00;
	byte bl_104 = 0x00;
	word32 esp_193 = fp - 292;
	word32 eax_42 = VirtualAlloc(0x00, dwArg08, 0x3000, 0x40);
	if (eax_42 != 0x00)
	{
		do
		{
			byte al_111 = (byte) fn00401000();
			word32 eax_114 = fp - 0x010C + (word32) al_111;
			if (Mem0[eax_114 + 0x00:byte] == bl_104)
			{
				Mem194[eax_114 + 0x00:byte] = 0x01;
				word32 edi_195 = eax_42;
				word32 esi_196 = dwArg04;
				word32 ecx_197 = dwArg08;
				while (ecx_197 != 0x00)
				{
					Mem204[edi_195 + 0x00:byte] = Mem194[esi_196 + 0x00:byte];
					esi_196 = esi_196 + 0x01;
					edi_195 = edi_195 + 0x01;
					ecx_197 = ecx_197 - 0x01;
				}
				word32 esi_209 = eax_42;
				word32 edi_210 = eax_42;
				word32 ecx_212 = dwArg08;
				byte cl_213 = (byte) dwArg08;
				byte dl_218 = al_111;
				do
				{
					Mem239[edi_210 + 0x00:byte] = Mem194[esi_209 + 0x00:byte] ^ dl_218;
					ecx_212 = ecx_212 - 0x01;
					esi_209 = esi_209 + 0x01;
					edi_210 = edi_210 + 0x01;
					dl_218 = __rol(dl_218 + cl_213, 0x03);
					cl_213 = (byte) ecx_212;
				} while (ecx_212 != 0x00);
				ebx_103 = 0x00;
				bl_104 = 0x00;
			}
			word32 edx_129 = dwArg08;
			word32 eax_131 = eax_42;
			word32 ecx_134 = 0x3ADE6018;
			do
			{
				ecx_134 = ecx_134 *s 33 ^ (word32) Mem0[eax_131 + 0x00:byte];
				eax_131 = eax_131 + 0x01;
				edx_129 = edx_129 + ~0x00;
			} while (edx_129 != 0x00);
		} while (ecx_134 != dwArg10);
		word32 edi_156 = dwArg04;
		word32 esi_157 = eax_42;
		word32 ecx_158 = dwArg08;
		while (ecx_158 != 0x00)
		{
			Mem165[edi_156 + 0x00:byte] = Mem0[esi_157 + 0x00:byte];
			esi_157 = esi_157 + 0x01;
			edi_156 = edi_156 + 0x01;
			ecx_158 = ecx_158 - 0x01;
		}
		VirtualAlloc(ebx_103, ebx_103, 0x3000, 0x40);
		VirtualFree(eax_42, ebx_103, 0x8000);
		word32 esi_192;
		*esiOut = eax_42;
		esp_193 = fp - 0x0140;
	}
	return Mem0[esp_193 + 0x04:word32];
}

// 004014DC: Register word32 fn004014DC(Register byte cl, Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg10, Register out ptr32 esiOut)
word32 fn004014DC(byte cl, word32 ebp, word32 dwArg04, word32 dwArg08, word32 dwArg10, ptr32 & esiOut)
{
	word32 ebp_201 = fp - 0x04;
	word32 esp_18 = fp + ~0x63;
	if (dwArg10 == 0x00)
	{
		GetModuleHandleA(0x00);
		esp_18 = fp + ~0x67;
	}
	word32 esp_123;
	word32 eax_147;
	if (dwArg10 != 0x00 && dwArg08 != 0x01)
	{
l0040173E:
		word32 esp_62 = esp_18 - 0x04;
		Mem63[esp_62 + 0x00:word32] = Mem0[ebp_201 + 0x10:word32];
		word32 ecx_64 = Mem63[ebp_201 - 0x54 + 0x00:word32];
		Mem67[esp_62 - 0x04 + 0x00:word32] = Mem63[ebp_201 + 0x0C:word32];
		word32 eax_68 = Mem67[ecx_64 + 0x3C:word32];
		Mem71[esp_62 - 0x08 + 0x00:word32] = Mem67[ebp_201 + 0x08:word32];
		word32 eax_72 = Mem71[eax_68 + 0x28 + ecx_64:word32];
		Mem75[esp_62 - 0x0C + 0x00:word32] = Mem71[ebp_201 + 0x14:word32];
		word32 eax_76 = eax_72 + ecx_64;
		word32 ebp_89;
		byte SCZO_90;
		word32 ebx_91;
		word32 esi_92;
		byte SZO_93;
		byte C_94;
		word32 edi_95;
		byte Z_96;
		word32 ecx_98;
		byte cl_99;
		bcuiposr0 None_100;
		word32 edx_101;
		byte CZ_102;
		byte ah_103;
		word16 ax_104;
		byte al_105;
		byte bh_106;
		eax_76();
		goto l00401758;
	}
	word32 esi_108 = fn00401123(cl, fp - 88);
	word32 esp_115 = esp_18 - 0x04;
	Mem116[esp_115 + 0x00:word32] = 0x40;
	Mem120[esp_115 - 0x04 + 0x00:word32] = 0x3000;
	Mem122[esp_115 - 0x08 + 0x00:word32] = dwLoc48;
	Mem124[esp_115 - 0x0C + 0x00:word32] = esi_108;
	word32 ecx_118 = (word32) (dwLoc48 != dwLoc4C);
	esp_123 = esp_115 - 0x0C;
	word32 eax_127 = VirtualAlloc(Mem124[esp_115 - 0x0C + 0x00:LPVOID], Mem124[esp_115 - 0x08 + 0x00:SIZE_T], Mem124[esp_115 - 0x04 + 0x00:DWORD], Mem124[esp_115 + 0x00:DWORD]);
	if (eax_127 == esi_108)
	{
l00401550:
		eax_147 = 0x00;
l00401758:
		word32 esi_49;
		*esiOut = Mem0[esp_123 + 0x04:word32];
		return eax_147;
	}
	word32 edi_153 = eax_127;
	word32 esi_155 = dwLoc30;
	word32 ecx_156 = dwLoc48;
	while (ecx_156 != 0x00)
	{
		Mem163[edi_153 + 0x00:byte] = Mem124[esi_155 + 0x00:byte];
		esi_155 = esi_155 + 0x01;
		edi_153 = edi_153 + 0x01;
		ecx_156 = ecx_156 - 0x01;
	}
	word32 edi_200;
	Mem171[esp_115 - 0x10 + 0x00:word32] = dwLoc34;
	Mem175[esp_115 - 0x14 + 0x00:word32] = dwLoc38;
	Mem178[esp_115 - 0x18 + 0x00:word32] = dwLoc48;
	Mem180[esp_115 - 0x1C + 0x00:word32] = eax_127;
	word32 esi_184;
	word32 ebx_185 = fn004013AE(dwArg00, dwArg04, dwArg0C, out esi_184);
	word32 eax_192 = dwLoc48 - dwLoc3C + ebx_185;
	if (ecx_118 != 0x00)
	{
		Mem428[esp_115 - 0x10 + 0x00:word32] = eax_192;
		Mem431[esp_115 - 0x14 + 0x00:word32] = dwLoc4C;
		Mem433[esp_115 - 0x18 + 0x00:word32] = ebx_185;
		word32 eax_435 = fn00401A31(esi_184, dwArg00, dwArg04, dwArg08, out ebp_201);
		Mem438[ebp_201 - 0x18 + 0x00:word32] = eax_435;
		edi_200 = eax_435;
	}
	else
		edi_200 = ebx_185;
	esp_123 = esp_18 - 0x10;
	if (edi_200 == 0x00)
		goto l00401550;
	word32 esi_207 = Mem180[edi_200 + 0x3C:word32];
	Mem209[ebp_201 - 0x20 + 0x00:word32] = Mem180[ebp_201 - 0x40 + 0x00:word32] + edi_200;
	word32 eax_210 = Mem209[ebp_201 - 0x54 + 0x00:word32];
	word32 ebx_212 = Mem209[eax_210 + 0x3C:word32] + eax_210;
	Mem216[ebp_201 - 0x14 + 0x00:word32] = (word32) Mem209[ebx_212 + 0x14:word16] + 0x18 + ebx_212;
	word32 esi_217 = esi_207 + edi_200;
	Mem221[ebp_201 - 0x10 + 0x00:word32] = (word32) Mem216[esi_217 + 0x14:word16] + 0x18 + esi_217;
	Mem224[esp_123 - 0x04 + 0x00:word32] = ebp_201 - 0x1C;
	Mem226[esp_123 - 0x08 + 0x00:word32] = 0x04;
	Mem228[esp_123 - 0x0C + 0x00:word32] = 0x01;
	Mem230[esp_123 - 0x10 + 0x00:word32] = ebx_212;
	VirtualProtect(Mem230[esp_123 - 0x10 + 0x00:LPVOID], Mem230[esp_123 - 0x0C + 0x00:SIZE_T], Mem230[esp_123 - 0x08 + 0x00:DWORD], Mem230[esp_123 - 0x04 + 0x00:PDWORD]);
	Mem235[esp_123 - 0x14 + 0x00:word32] = Mem230[ebp_201 - 0x40 + 0x00:word32];
	Mem237[esp_123 - 0x18 + 0x00:word32] = edi_200;
	word32 esi_239;
	word32 ebx_238;
	word32 eax_240 = fn0040188A(ebx_212, ebp_201, dwArg00, dwArg04, out ebx_238, out esi_239);
	Mem243[ebp_201 - 0x04 + 0x00:word32] = eax_240;
	word32 edi_244 = eax_240 - Mem243[(ebp_201 - 0x54) + 0x00:word32];
	Mem248[ebp_201 - 0x24 + 0x00:word32] = edi_244;
	if (Mem243[ebp_201 + 0x14:word32] != 0x00)
	{
		word32 eax_418 = Mem248[esi_239 + 0x78:word32];
		if (eax_418 != 0x00)
		{
			Mem426[ebx_238 + 0x78:word32] = eax_418 + edi_244;
l0040161D:
			word32 ecx_253 = Mem248[esi_239 + 0x88:word32];
			if (ecx_253 != 0x00)
			{
				Mem389[ebx_238 + 0x88:word32] = ecx_253 + edi_244;
				word32 ecx_390 = Mem389[esi_239 + 0x8C:word32];
				word32 eax_391 = Mem389[ebx_238 + 0x88:word32];
				Mem392[ebx_238 + 0x8C:word32] = ecx_390;
				word32 eax_393 = eax_391 + Mem392[(ebp_201 - 0x54) + 0x00:word32];
				Mem396[esp_123 - 0x14 + 0x00:word32] = edi_244;
				Mem398[esp_123 - 0x18 + 0x00:word32] = eax_393;
				Mem400[esp_123 - 0x1C + 0x00:word32] = eax_393;
				word32 eax_407 = (fn00401339(ecx_390, ebp_201, dwArg00, dwArg04, dwArg08, out ebx_238, out edi_244) | ~0x00) - Mem400[(ebp_201 - 0x54) + 0x00:word32];
				Mem409[ebx_238 + 0x50:word32] = eax_407;
			}
			word32 eax_261 = Mem248[ebp_201 - 0x20 + 0x00:word32];
			word32 ecx_265 = Mem248[ebp_201 - 0x04 + 0x00:word32] - Mem248[esi_239 + 0x34:word32];
			Mem269[ebp_201 - 0x0C + 0x00:word32] = 0x00;
			word32 esp_259 = esp_18 - 0x20;
			if (Mem248[eax_261 + 0x00:word32] >u 0x00)
			{
				Mem368[esp_259 - 0x6D + 0x00:byte] = Mem269[esp_259 - 0x6D + 0x00:byte];
				Mem371[ebp_201 - 0x08 + 0x00:word32] = eax_261 - ~0x03;
				do
				{
					word32 eax_374 = Mem371[Mem371[ebp_201 - 0x08 + 0x00:word32] + 0x00:word32] + Mem371[(ebp_201 - 0x04) + 0x00:word32];
					Mem376[ebp_201 - 0x08 + 0x00:word32] = Mem371[ebp_201 - 0x08 + 0x00:word32] + 0x01;
					Mem378[ebp_201 - 0x08 + 0x00:word32] = Mem376[ebp_201 - 0x08 + 0x00:word32] - ~0x02;
					Mem380[eax_374 + 0x00:word32] = Mem378[eax_374 + 0x00:word32] + ecx_265;
					Mem382[ebp_201 - 0x0C + 0x00:word32] = Mem380[ebp_201 - 0x0C + 0x00:word32] + 0x01;
				} while (Mem382[ebp_201 - 0x0C + 0x00:word32] <u Mem382[Mem382[(ebp_201 - 0x20) + 0x00:word32] + 0x00:word32]);
			}
			Mem274[esp_259 - 0x04 + 0x00:word32] = Mem269[ebp_201 - 0x04 + 0x00:word32];
			esp_123 = esp_259;
			byte bh_275;
			if (fn004017C7(ebp_201, dwArg00, out bh_275) != 0x00)
			{
				word32 eax_281 = Mem274[ebp_201 - 0x04 + 0x00:word32];
				Mem283[esp_259 - 0x04 + 0x00:word32] = eax_281;
				esp_123 = esp_259;
				if (fn00401956(eax_281, bh_275, dwArg00) != 0x00)
				{
					if (Mem283[ebp_201 + 0x14:word32] != 0x00)
						fn004010B5(edi_244, Mem283[ebp_201 - 0x54 + 0x00:word32]);
					Mem294[ebx_238 + 0x28:word32] = Mem283[esi_239 + 0x28:word32] + edi_244;
					Mem301[ebx_238 + 0x06:word16] = (word16) (word32) Mem294[esi_239 + 0x06:word16];
					word32 edx_297 = 0x00;
					if (true)
					{
						do
						{
							word32 eax_328 = Mem301[ebp_201 - 0x14 + 0x00:word32];
							word32 esi_326 = Mem301[ebp_201 - 0x10 + 0x00:word32];
							word32 edi_327 = Mem301[ebp_201 - 0x14 + 0x00:word32];
							Mem332[ebp_201 - 0x10 + 0x00:word32] = Mem301[ebp_201 - 0x10 + 0x00:word32] + 0x10;
							Mem337[ebp_201 - 0x10 + 0x00:word32] = Mem332[ebp_201 - 0x10 + 0x00:word32] - ~0x17;
							Mem340[esp_259 - 0x04 + 0x00:word32] = 0x0A;
							word32 ecx_341 = Mem340[esp_259 - 0x04 + 0x00:word32];
							while (ecx_341 != 0x00)
							{
								Mem349[edi_327 + 0x00:word32] = Mem340[esi_326 + 0x00:word32];
								esi_326 = esi_326 + 0x04;
								edi_327 = edi_327 + 0x04;
								ecx_341 = ecx_341 - 0x01;
							}
							Mem356[eax_328 + 0x0C:word32] = Mem340[eax_328 + 0x0C:word32] + Mem340[(ebp_201 - 0x24) + 0x00:word32];
							Mem359[ebp_201 - 0x14 + 0x00:word32] = eax_328 - ~0x27;
							edx_297 = edx_297 + 0x01;
						} while (edx_297 <u (word32) Mem359[ebx_238 + 0x06:word16]);
					}
					Mem314[esp_259 - 0x04 + 0x00:word32] = 0x8000;
					Mem316[esp_259 - 0x08 + 0x00:word32] = 0x00;
					Mem319[esp_259 - 0x0C + 0x00:word32] = Mem316[ebp_201 - 0x18 + 0x00:word32];
					VirtualFree(Mem319[esp_259 - 0x0C + 0x00:LPVOID], Mem319[esp_259 - 0x08 + 0x00:SIZE_T], Mem319[esp_259 - 0x04 + 0x00:DWORD]);
					esp_18 = esp_259 - 0x0C;
					goto l0040173E;
				}
			}
			goto l00401550;
		}
	}
	Mem416[ebx_238 + 0x78:word32] = 0x00;
	Mem417[ebx_238 + 0x7C:word32] = 0x00;
	goto l0040161D;
}

// 0040175F: Register word32 fn0040175F(Register word32 ecx, Register word32 edx)
word32 fn0040175F(word32 ecx, word32 edx)
{
	word32 dwLoc08_12 = ecx & 0x00;
	word16 ax_18 = fn00401017(edx);
	while (Mem0[edx + 0x00:byte] != 0x00)
	{
		dwLoc08_12 = dwLoc08_12 *s 65599 + (word32) Mem0[edx + 0x00:word16];
		edx = edx + 0x01;
	}
	if ((dwLoc08_12 & 0x80000000) != 0x00)
		dwLoc08_12 = DPB(dwLoc08_12, (word16) dwLoc08_12 ^ (ax_18 ^ 23232), 0) & 0x7FFFFFFF;
	return dwLoc08_12;
}

// 004017C7: Register word32 fn004017C7(Register word32 ebp, Stack word32 dwArg04, Register out ptr32 bhOut)
word32 fn004017C7(word32 ebp, word32 dwArg04, ptr32 & bhOut)
{
	*bhOut = bh;
	word32 eax_116;
	word32 edi_12 = dwArg04;
	word32 eax_16 = Mem0[Mem0[dwArg04 + 0x3C:word32] + dwArg04 + 0x80:word32];
	if (eax_16 == 0x00)
		eax_116 = eax_16 + 0x01;
	else
	{
		word32 ebx_58 = eax_16 + dwArg04;
		word32 dwLoc0C_132 = dwLoc0C & 0x00;
		word32 eax_136 = ebx_58 + 0x0C;
		word32 esp_115 = fp - 0x1C;
		if (Mem0[ebx_58 + 0x0C:word32] != 0x00)
		{
			word32 esi_135 = ebx_58;
			do
			{
				word32 esp_102 = esp_115 - 0x04;
				Mem103[esp_102 + 0x00:word32] = Mem0[eax_136 + 0x00:word32] + edi_12;
				word32 eax_105 = LoadLibraryA(Mem103[esp_102 + 0x00:LPCSTR]);
				if (eax_105 == 0x00)
				{
l00401886:
					esp_115 = esp_102;
					eax_116 = 0x00;
					goto l0040187F;
				}
				dwLoc08 = dwLoc08 & 0x00;
				word32 esi_123 = Mem103[esi_135 + 0x10:word32] + edi_12;
				if (Mem103[esi_123 + 0x00:word32] != 0x00)
				{
					word32 edi_139 = esi_123;
					do
					{
						Mem146[esp_102 - 0x04 + 0x00:word32] = Mem103[edi_139 + 0x00:word32];
						Mem149[esp_102 - 0x08 + 0x00:word32] = eax_105;
						word32 eax_151 = fn004011EA(edi_139, dwArg00, dwArg04);
						if (eax_151 == 0x00)
							goto l00401886;
						word32 v17_156 = dwLoc08 + 0x01;
						Mem158[edi_139 + 0x00:word32] = eax_151;
						dwLoc08 = v17_156;
						edi_139 = esi_123 + v17_156 * 0x04;
					} while (Mem158[edi_139 + 0x00:word32] != 0x00);
					edi_12 = dwArg04;
				}
				word32 v18_131 = dwLoc0C_132 + 0x01;
				esi_135 = v18_131 *s 0x14 + ebx_58;
				esp_115 = esp_102;
				dwLoc0C_132 = v18_131;
				eax_136 = esi_135 + 0x0C;
			} while (Mem103[esi_135 + 0x0C:word32] != 0x00);
		}
		eax_116 = 0x01;
l0040187F:
		byte bh_78;
		*bhOut = Mem0[esp_115 + 0x05:byte];
	}
	return eax_116;
}

// 0040188A: Register word32 fn0040188A(Register word32 ebx, Register word32 ebp, Stack word32 dwArg04, Stack word32 dwArg08, Register out ptr32 ebxOut, Register out ptr32 esiOut)
word32 fn0040188A(word32 ebx, word32 ebp, word32 dwArg04, word32 dwArg08, ptr32 & ebxOut, ptr32 & esiOut)
{
	word32 esp_11 = fp + ~0x040F;
	word32 edi_17 = VirtualAlloc;
	do
	{
		word32 eax_101;
		word32 esp_20 = esp_11 - 0x04;
		Mem21[esp_20 + 0x00:word32] = 0x04;
		Mem23[esp_20 - 0x04 + 0x00:word32] = 0x2000;
		Mem27[esp_20 - 0x08 + 0x00:word32] = dwArg08;
		Mem30[esp_20 - 0x0C + 0x00:word32] = 0x00;
		word32 ebp_32;
		byte SCZO_33;
		word32 esi_34;
		byte SZO_36;
		byte C_37;
		word32 eax_38;
		byte Z_39;
		word32 ebx_40;
		word32 ecx_41;
		word32 esp_114;
		edi_17();
		(fp - 0x0408)[esi_34 * 0x04] = eax_38;
		if (eax_38 == 0x00)
		{
			eax_101 = 0x00;
			goto l00401950;
		}
		Mem64[esp_114 - 0x04 + 0x00:word32] = 0x01;
		Mem66[esp_114 - 0x04 + 0x00:word32] = Mem64[esp_114 - 0x04 + 0x00:word32] + esi_34;
		word32 esi_67 = Mem66[esp_114 - 0x04 + 0x00:word32];
		esp_11 = esp_114;
	} while (esi_67 <u 0x0100);
	Mem72[esp_114 - 0x04 + 0x00:word32] = ebx_40;
	Mem74[esp_114 - 0x08 + 0x00:word32] = esi_67;
	word32 eax_76 = fn00401AA2(dwArg00);
	word32 esp_133 = esp_114 - 0x04;
	esi_132 = esi_67;
	if (esi_67 != 0x00)
	{
		do
		{
			word32 esi_132;
			if (esi_132 != eax_76)
			{
				word32 esp_142 = esp_133 - 0x04;
				Mem143[esp_142 + 0x00:word32] = 0x8000;
				Mem145[esp_142 - 0x04 + 0x00:word32] = 0x00;
				Mem148[esp_142 - 0x08 + 0x00:word32] = (fp - 0x0408)[esi_132 * 0x04];
				VirtualFree(Mem148[esp_142 - 0x08 + 0x00:LPVOID], Mem148[esp_142 - 0x04 + 0x00:SIZE_T], Mem148[esp_142 + 0x00:DWORD]);
				esp_133 = esp_142 - 0x08;
			}
			esi_132 = esi_132 - 0x01;
		} while (esi_132 != 0x00);
	}
	word32 ebx_83 = (fp - 0x0408)[eax_76 * 0x04];
	word32 esp_84 = esp_133 - 0x04;
	Mem85[esp_84 + 0x00:word32] = 0x04;
	Mem87[esp_84 - 0x04 + 0x00:word32] = 0x1000;
	Mem90[esp_84 - 0x08 + 0x00:word32] = dwArg08;
	Mem92[esp_84 - 0x0C + 0x00:word32] = ebx_83;
	word32 esp_94;
	word32 ebp_95;
	byte SCZO_96;
	word32 esi_97;
	word32 edi_98;
	byte SZO_99;
	byte C_100;
	byte Z_102;
	word32 ebx_103;
	word32 ecx_104;
	edi_17();
	if (eax_101 != 0x00)
	{
		word32 edi_116 = ebx_103;
		word32 esi_118 = dwArg04;
		word32 ecx_119 = dwArg08;
		while (ecx_119 != 0x00)
		{
			Mem124[edi_116 + 0x00:byte] = Mem92[esi_118 + 0x00:byte];
			esi_118 = esi_118 + 0x01;
			edi_116 = edi_116 + 0x01;
			ecx_119 = ecx_119 - 0x01;
		}
		eax_101 = ebx_103;
	}
	word32 ebx_113;
	*ebxOut = Mem92[esp_94 + 0x00:word32];
	esp_114 = esp_94 + 0x04;
l00401950:
	word32 esi_57;
	*esiOut = Mem45[esp_114 + 0x04:word32];
	return eax_101;
}

// 00401956: Register word32 fn00401956(Register word32 eax, Register byte bh, Stack word32 dwArg04)
word32 fn00401956(word32 eax, byte bh, word32 dwArg04)
{
	word32 eax_135;
	word32 esi_22 = Mem0[eax + 0x3C:word32] + eax;
	word32 esp_107 = fp - 0x18;
	word32 eax_30 = (word32) Mem0[esi_22 + 0x14:word16] + 0x18 + esi_22;
	word32 dwLoc08_110 = 0x00;
	if (Mem0[esi_22 + 0x06:word16] >u 0x00)
	{
		word32 edi_113 = eax_30 + 0x24;
		do
		{
			word32 ecx_84 = Mem0[edi_113 + 0x00:word32];
			word32 eax_138 = 0x00;
			if ((ecx_84 & 0x20000000) != 0x00)
			{
				eax_138 = (0x00 - (-(ecx_84 & 0x80000000) == 0x00) & 0x20) - ~0x1F;
				goto l004019CE;
			}
			word32 esp_158;
			if (ecx_84 < 0x00)
			{
				esp_158 = esp_107 - 0x04 + 0x04;
				Mem162[esp_158 + 0x00:word32] = 0x04;
				goto l004019CD;
			}
			if ((ecx_84 & 0x40000000) != 0x00)
			{
				esp_158 = esp_107 - 0x04;
				Mem167[esp_158 + 0x00:word32] = 0x02;
l004019CD:
				eax_138 = Mem0[esp_158 + 0x00:word32];
				esp_107 = esp_158 + 0x00;
			}
l004019CE:
			if ((ecx_84 & 0x04000000) != 0x00)
				eax_138 = eax_138 | 0x0200;
			if (eax_138 != 0x00)
			{
				word32 edx_117 = Mem0[edi_113 - 0x1C + 0x00:word32];
				word32 ecx_119 = Mem0[edi_113 - 0x18 + 0x00:word32] + dwArg04;
				word32 esp_122 = esp_107 - 0x04;
				Mem123[esp_122 + 0x00:word32] = fp - 0x0C;
				Mem125[esp_122 - 0x04 + 0x00:word32] = eax_138;
				Mem127[esp_122 - 0x08 + 0x00:word32] = edx_117;
				Mem129[esp_122 - 0x0C + 0x00:word32] = ecx_119;
				esp_107 = esp_122 - 0x0C;
				if (VirtualProtect(Mem129[esp_122 - 0x0C + 0x00:LPVOID], Mem129[esp_122 - 0x08 + 0x00:SIZE_T], Mem129[esp_122 - 0x04 + 0x00:DWORD], Mem129[esp_122 + 0x00:PDWORD]) == 0x00)
				{
					eax_135 = 0x00;
					return eax_135;
				}
			}
			word32 v18_109 = dwLoc08_110 + 0x01;
			dwLoc08_110 = v18_109;
			edi_113 = edi_113 + 0x28;
		} while (v18_109 <u (word32) Mem0[esi_22 + 0x06:word16]);
	}
	eax_135 = 0x01;
	return eax_135;
}

// 00401A31: Register word32 fn00401A31(Register word32 esi, Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C, Register out ptr32 ebpOut)
word32 fn00401A31(word32 esi, word32 dwArg04, word32 dwArg08, word32 dwArg0C, ptr32 & ebpOut)
{
	word32 esp_46;
	word32 eax_45;
	word32 eax_20 = VirtualAlloc(0x00, dwArg08, 0x3000, 0x40);
	word32 esp_29;
	word32 ebp_30;
	word32 edi_31;
	word32 eax_32;
	byte SCZO_33;
	byte Z_34;
	word32 esi_35;
	byte SZO_36;
	byte C_37;
	dwArg0C();
	if (eax_32 != ~0x00 && eax_32 == dwArg08)
	{
		Mem89[esp_29 - 0x04 + 0x00:word32] = 0x8000;
		Mem91[esp_29 - 0x08 + 0x00:word32] = 0x00;
		Mem94[esp_29 - 0x0C + 0x00:word32] = dwArg04;
		VirtualFree(Mem94[esp_29 - 0x0C + 0x00:LPVOID], Mem94[esp_29 - 0x08 + 0x00:SIZE_T], Mem94[esp_29 - 0x04 + 0x00:DWORD]);
		esp_46 = esp_29 - 0x0C;
		eax_45 = edi_31;
	}
	else
	{
		Mem54[esp_29 - 0x04 + 0x00:word32] = esi_35;
		Mem57[esp_29 - 0x08 + 0x00:word32] = 0x8000;
		Mem59[esp_29 - 0x0C + 0x00:word32] = 0x00;
		Mem61[esp_29 - 0x10 + 0x00:word32] = edi_31;
		VirtualFree(Mem98[esp_29 - 0x10 + 0x00:LPVOID], Mem99[esp_29 - 0x0C + 0x00:SIZE_T], Mem100[esp_29 - 0x08 + 0x00:DWORD]);
		Mem74[esp_64 - 0x04 + 0x00:word32] = 0x8000;
		Mem76[esp_64 - 0x08 + 0x00:word32] = 0x00;
		Mem79[esp_64 - 0x0C + 0x00:word32] = dwArg04;
		VirtualFree(Mem79[esp_64 - 0x0C + 0x00:LPVOID], Mem79[esp_64 - 0x08 + 0x00:SIZE_T], Mem79[esp_64 - 0x04 + 0x00:DWORD]);
		eax_45 = 0x00;
		esp_46 = esp_64 - 0x08;
	}
	word32 ebp_50;
	*ebpOut = Mem0[esp_46 + 0x04:word32];
	return eax_45;
}

// 00401AA2: Register word32 fn00401AA2(Stack word32 dwArg04)
word32 fn00401AA2(word32 dwArg04)
{
	word32 eax_13;
	if (dwArg04 == 0x00)
		eax_13 = 0x00;
	else
		eax_13 = (uint32) ((uint64) (uint32) fn00401000() % dwArg04);
	return eax_13;
}

