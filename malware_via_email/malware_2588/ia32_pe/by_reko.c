// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401027: void fn00401027(Register Eq_2 eax, Register word16 dx, Register (ptr word32) edi)
void fn00401027(Eq_2 eax, word16 dx, word32 * edi)
{
	*edi = __in(dx);
}

// 004147C5: Register Eq_2 Win32CrtStartup()
Eq_2 Win32CrtStartup()
{
	GetCommandLineA();
	GetCommandLineA();
	CreateFileA(&globals->t42FB31, 0x60000000, 0x02, null, 0x03, 166, 0x00);
	Eq_35 eax_28 = GetModuleHandleA(&globals->t42FB31);
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	Eq_46 eax_38 = GetProcAddress(eax_28, &globals->t42FB00);
	ptr32 esp_321 = fp - 0x90;
l00414839:
	word32 * esp_94 = esp_321 - 0x04;
	*esp_94 = 0x03;
	*(esp_94 - 0x04) = 0x00;
	ptr32 esp_122 = esp_94 - 0x04;
l00414840:
	struct Eq_537 * esp_123 = esp_122 - 0x04;
	esp_123->t0000.u0 = 0x03;
	*(esp_123 - 0x04) = 0xA0000000;
	*(esp_123 - 0x08) = 0x0042FB8B;
	CreateFileW(*(esp_123 - 0x08), *(esp_123 - 0x04), esp_123->t0000, esp_123->t0004, esp_123->t0008, esp_123->t000C, esp_123->t0010);
	*(esp_123 - 0x0C) = 0x00;
	GetLastError();
	*(esp_123 - 0x10) = 0x00;
	*(esp_123 - 0x14) = 0x0107;
	*(esp_123 - 0x18) = 0x03;
	ptr32 esp_138 = esp_123 - 0x18;
l0041486D:
	ptr32 esp_342;
	struct Eq_337 * esp_162 = esp_138 - 0x04;
	esp_162->t0000 = null;
	*(esp_162 - 0x04) = 0x01;
	*(esp_162 - 0x08) = 0xA0000000;
	*(esp_162 - 0x0C) = 0x0042FB3F;
	ptr32 esp_168 = esp_162 - 0x0C;
	if (CreateFileA(*(esp_162 - 0x0C), *(esp_162 - 0x08), *(esp_162 - 0x04), esp_162->t0000, esp_162->t0004, esp_162->t0008, esp_162->t000C) == ~0x00)
	{
		*(esp_162 - 0x10) = 0x00;
		*(esp_162 - 0x14) = 0x00;
		*(esp_162 - 0x18) = 0x23;
		*(esp_162 - 0x1C) = 0x03;
		*(esp_162 - 0x20) = 0x00;
		esp_342 = esp_162 - 0x20;
		do
		{
			struct Eq_954 * esp_428 = esp_342 - 0x04;
			esp_428->t0000.u0 = 0x03;
			*(esp_428 - 0x04) = 0xC0000000;
			*(esp_428 - 0x08) = 4389738;
			CreateFileW(*(esp_428 - 0x08), *(esp_428 - 0x04), esp_428->t0000, esp_428->t0004, esp_428->t0008, esp_428->t000C, esp_428->t0010);
			*(esp_428 - 0x0C) = 0x00;
			*(esp_428 - 0x10) = 0x00;
			*(esp_428 - 0x14) = 0xA7;
			*(esp_428 - 0x18) = 0x03;
			*(esp_428 - 0x1C) = 0x00;
			*(esp_428 - 0x20) = 0x05;
			*(esp_428 - 0x24) = 0xC0000000;
			*(esp_428 - 0x28) = 4389482;
			esp_168 = esp_428 - 0x28;
			Eq_2 eax_452 = CreateFileW(*(esp_428 - 0x28), *(esp_428 - 0x24), *(esp_428 - 0x20), *(esp_428 - 0x1C), *(esp_428 - 0x18), *(esp_428 - 0x14), *(esp_428 - 0x10));
			do
			{
				if (eax_452 != ~0x00)
					goto l00414B05;
				union Eq_2 * esp_459 = esp_168 - 0x04;
				*esp_459 = 0x00;
				*(esp_459 - 0x04) = 0x0105;
				*(esp_459 - 0x08) = 0x03;
				*(esp_459 - 0x0C) = 0x00;
				*(esp_459 - 0x10) = 0x04;
				*(esp_459 - 0x14) = 0x20000000;
				*(esp_459 - 0x18) = 4389593;
				esp_168 = esp_459 - 0x18;
				eax_452 = CreateFileA(*(esp_459 - 0x18), *(esp_459 - 0x14), *(esp_459 - 0x10), *(esp_459 - 0x0C), *(esp_459 - 0x08), *(esp_459 - 0x04), *esp_459);
			} while (eax_452 != ~0x00);
			int32 eax_481 = eax_38();
			*(esp_459 - 0x1C) = 0x00;
			*(esp_459 - 0x20) = 0x07;
			*(esp_459 - 0x24) = 0x03;
			*(esp_459 - 0x28) = 0x00;
			*(esp_459 - 44) = 0x06;
			*(esp_459 - 0x30) = 0x40000000;
			*(esp_459 - 0x34) = 0x0042FAF1;
			dwLoc14 = eax_481;
			esp_122 = esp_459 - 0x34;
			if (CreateFileW(*(esp_459 - 0x34), *(esp_459 - 0x30), *(esp_459 - 44), *(esp_459 - 0x28), *(esp_459 - 0x24), *(esp_459 - 0x20), *(esp_459 - 0x1C)) != ~0x00)
				goto l00414840;
			GetLastError();
			GetCommandLineA();
			GetCommandLineA();
			GetLastError();
			*(esp_459 - 0x38) = 0x00;
			*(esp_459 - 0x3C) = 0xA4;
			*(esp_459 - 0x40) = 0x03;
			*(esp_459 - 0x44) = 0x00;
			*(esp_459 - 0x48) = 0x01;
			*(esp_459 - 0x4C) = 0x00;
			*(esp_459 - 0x50) = 4389511;
			CreateFileA(*(esp_459 - 0x50), *(esp_459 - 0x4C), *(esp_459 - 0x48), *(esp_459 - 0x44), *(esp_459 - 0x40), *(esp_459 - 0x3C), *(esp_459 - 0x38));
			Eq_15 eax_534 = GetCommandLineA();
			ptr32 esp_535;
			word32 ebp_536;
			byte SCZO_537;
			word32 eax_538;
			byte Z_539;
			byte SZO_540;
			byte C_541;
			word16 dx_542;
			word32 edi_543;
			(*((word32) (eax_481 ^ 0xC0000005) + 0x004149D1))();
			GetCommandLineA();
			*(esp_535 - 0x04) = 0x00;
			*(esp_535 - 0x08) = 0x26;
			*(esp_535 - 0x0C) = 0x03;
			*(esp_535 - 0x10) = 0x00;
			*(esp_535 - 0x14) = 0x01;
			*(esp_535 - 0x18) = 0x80000000;
			*(esp_535 - 0x1C) = 4389843;
			esp_138 = esp_535 - 0x1C;
			if (CreateFileW(*(esp_535 - 0x1C), *(esp_535 - 0x18), *(esp_535 - 0x14), *(esp_535 - 0x10), *(esp_535 - 0x0C), *(esp_535 - 0x08), *(esp_535 - 0x04)) != ~0x00)
				goto l0041486D;
l00414A05:
			union Eq_2 * esp_309 = esp_138 - 0x04;
			*esp_309 = 0x00;
			*(esp_309 - 0x04) = 0x01A4;
			*(esp_309 - 0x08) = 0x03;
			*(esp_309 - 0x0C) = 0x00;
			*(esp_309 - 0x10) = 0x05;
			*(esp_309 - 0x14) = 0x20000000;
			*(esp_309 - 0x18) = 0x0042FB4D;
			esp_321 = esp_309 - 0x18;
			if (CreateFileW(*(esp_309 - 0x18), *(esp_309 - 0x14), *(esp_309 - 0x10), *(esp_309 - 0x0C), *(esp_309 - 0x08), *(esp_309 - 0x04), *esp_309) != ~0x00)
				goto l00414839;
			*(esp_309 - 0x1C) = fp - 0x28;
			*(esp_309 - 0x20) = 0x00;
			*(esp_309 - 0x24) = 0x86;
			*(esp_309 - 0x28) = 0x03;
			*(esp_309 - 44) = 0x00;
			*(esp_309 - 0x30) = 0x06;
			*(esp_309 - 0x34) = 0x60000000;
			*(esp_309 - 0x38) = 0x0042FBBC;
			esp_342 = esp_309 - 0x38;
		} while (CreateFileW(*(esp_309 - 0x38), *(esp_309 - 0x34), *(esp_309 - 0x30), *(esp_309 - 44), *(esp_309 - 0x28), *(esp_309 - 0x24), *(esp_309 - 0x20)) != ~0x00);
		*(esp_309 - 0x3C) = 0x40;
		*(esp_309 - 0x40) = 0x00;
		*(esp_309 - 0x44) = 0x86;
		*(esp_309 - 0x48) = 0x03;
		*(esp_309 - 0x4C) = 0x00;
		*(esp_309 - 0x50) = 0x02;
		*(esp_309 - 0x54) = 0x00;
		*(esp_309 - 88) = 0x0042FAB0;
		CreateFileA(*(esp_309 - 88), *(esp_309 - 0x54), *(esp_309 - 0x50), *(esp_309 - 0x4C), *(esp_309 - 0x48), *(esp_309 - 0x44), *(esp_309 - 0x40));
		GetCommandLineA();
		*(esp_309 - 0x5C) = 0x00013503;
		GetCommandLineA();
		*(esp_309 - 0x60) = 0x00401000;
		*(esp_309 - 100) = 0x00;
		*(esp_309 - 0x68) = 288;
		*(esp_309 - 0x6C) = 0x03;
		*(esp_309 - 0x70) = 0x00;
		*(esp_309 - 116) = 0x04;
		*(esp_309 - 0x78) = 0x20000000;
		*(esp_309 - 0x7C) = 4389518;
		CreateFileW(*(esp_309 - 0x7C), *(esp_309 - 0x78), *(esp_309 - 116), *(esp_309 - 0x70), *(esp_309 - 0x6C), *(esp_309 - 0x68), *(esp_309 - 100));
		*(esp_309 - 0x80) = 0x00;
		*(esp_309 - 0x84) = 0x04;
		*(esp_309 - 0x88) = 0x03;
		*(esp_309 - 0x8C) = 0x00;
		*(esp_309 - 0x90) = 0x06;
		*(esp_309 - 0x94) = 0xA0000000;
		*(esp_309 - 0x98) = 4389656;
		CreateFileA(*(esp_309 - 0x98), *(esp_309 - 0x94), *(esp_309 - 0x90), *(esp_309 - 0x8C), *(esp_309 - 0x88), *(esp_309 - 0x84), *(esp_309 - 0x80));
		VirtualProtect(*(esp_309 - 0x98), *(esp_309 - 0x94), *(esp_309 - 0x90), *(esp_309 - 0x8C));
		esp_168 = esp_309 - 0x98;
	}
l00414B05:
	GetLastError();
	int32 * esp_194 = esp_168 - 0x04;
	*esp_194 = dwLoc14;
	GetLastError();
	*(esp_194 - 0x04) = 0x00;
	*(esp_194 - 0x08) = 0x81;
	*(esp_194 - 0x0C) = 0x03;
	*(esp_194 - 0x10) = 0x00;
	*(esp_194 - 0x14) = 0x05;
	*(esp_194 - 0x18) = 0x00;
	*(esp_194 - 0x1C) = 0x0042FB12;
	CreateFileA(*(esp_194 - 0x1C), *(esp_194 - 0x18), *(esp_194 - 0x14), *(esp_194 - 0x10), *(esp_194 - 0x0C), *(esp_194 - 0x08), *(esp_194 - 0x04));
	*(esp_194 - 0x20) = 0x00013503;
	GetCommandLineA();
	*(esp_194 - 0x24) = 0x00;
	*(esp_194 - 0x28) = 0x26;
	*(esp_194 - 44) = 0x03;
	*(esp_194 - 0x30) = 0x00;
	*(esp_194 - 0x34) = 0x06;
	*(esp_194 - 0x38) = 0xC0000000;
	*(esp_194 - 0x3C) = 0x0042FBAA;
	CreateFileW(*(esp_194 - 0x3C), *(esp_194 - 0x38), *(esp_194 - 0x34), *(esp_194 - 0x30), *(esp_194 - 44), *(esp_194 - 0x28), *(esp_194 - 0x24));
	*(esp_194 - 0x40) = 0x00401000;
	GetCommandLineA();
	*(esp_194 - 0x44) = 0x00;
	*(esp_194 - 0x48) = 0x0103;
	*(esp_194 - 0x4C) = 0x03;
	*(esp_194 - 0x50) = 0x00;
	*(esp_194 - 0x54) = 0x07;
	*(esp_194 - 88) = 0xA0000000;
	*(esp_194 - 0x5C) = 0x0042FA94;
	ptr32 v13_236 = dwLoc14 - 0xC0000005;
	esp_138 = esp_194 - 0x5C;
	Eq_2 eax_253 = CreateFileW(*(esp_194 - 0x5C), *(esp_194 - 88), *(esp_194 - 0x54), *(esp_194 - 0x50), *(esp_194 - 0x4C), *(esp_194 - 0x48), *(esp_194 - 0x44));
	if (eax_253 == ~0x00)
	{
		ptr32 esp_260;
		word32 ebp_261;
		byte SCZO_262;
		word32 eax_263;
		byte Z_264;
		byte SZO_265;
		byte C_266;
		word16 dx_267;
		word32 * edi_268;
		(v13_236 + 0x00414C17)();
		*(esp_260 - 0x04) = 0x00;
		*(esp_260 - 0x08) = 422;
		*(esp_260 - 0x0C) = 0x03;
		*(esp_260 - 0x10) = 0x00;
		*(esp_260 - 0x14) = 0x06;
		*(esp_260 - 0x18) = 0x60000000;
		*(esp_260 - 0x1C) = 0x0042FB76;
		Eq_2 eax_283 = CreateFileW(*(esp_260 - 0x1C), *(esp_260 - 0x18), *(esp_260 - 0x14), *(esp_260 - 0x10), *(esp_260 - 0x0C), *(esp_260 - 0x08), *(esp_260 - 0x04));
		fn00401027(eax_283, dx_267, edi_268);
		return eax_283;
	}
	goto l00414A05;
}

