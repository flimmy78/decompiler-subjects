// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00400300: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	fn00400493();
	bool Z_16 = __arpl(*edx, bx, &*edx);
	fp->tFFFFFFEC = (Eq_22) &globals->v40031C;
	GetFileSize(fp->tFFFFFFEC, fp->tFFFFFFF0);
	GetLastError();
	fp->dwFFFFFFE8 = 0x0E;
	fp->dwFFFFFFE4 = 0xC0;
	struct Eq_48 * eax_35 = fn004003F8();
	word32 ebx_36 = eax_35->dw0050;
	fp->dwFFFFFFE0 = ebx_36;
	fp->dwFFFFFFDC = eax_35->dw0034;
	<anonymous> * eax_42 = fn00400415();
	fp->dwFFFFFFD8 = 0x0040035D;
	word32 esp_45;
	word32 ebp_46;
	byte SCZO_47;
	byte Z_48;
	word32 edx_49;
	word16 bx_50;
	Eq_2 eax_51;
	word32 ebx_52;
	eax_42();
	return eax_51;
}

// 004003F8: Register Eq_81 fn004003F8()
HMODULE fn004003F8()
{
	return GetModuleHandleA(null) + Mem0[0x00400308:word32];
}

// 00400415: Register word32 fn00400415()
word32 fn00400415()
{
	word32 ecx_15 = 0x0D;
	byte * eax_13 = globals->a400510;
	do
	{
		*eax_13 = __ror(*eax_13, 0x01);
		byte * eax_9 = eax_13 + 0x01;
		*eax_9 = __rol(*eax_9, 0x01);
		eax_13 = eax_9 + 0x01;
		ecx_15 = ecx_15 - 0x01;
	} while (ecx_15 != 0x00);
	Eq_86 eax_18 = GetModuleHandleA(&globals->t40051D);
	Eq_132 edx_23 = eax_18 + (&(eax_18 + (&eax_18->unused)[0x0F] / 0x04)->unused)[0x001E] / 0x04;
	word32 eax_25[] = eax_18 + edx_23->dw0020 / 0x04;
	int32 ebp_29 = 0x00;
	do
	{
		byte * esi_34 = eax_18 + eax_25[ebp_29] / 0x04;
		bool Z_38 = cond(esi_34);
		word32 ecx_39 = 0x0D;
		byte * edi_40 = globals->a400510;
		while (ecx_39 != 0x00)
		{
			Z_38 = cond(*esi_76 - *edi_77);
			esi_34 = esi_76 + 0x01;
			edi_40 = edi_77 + 0x01;
			ecx_39 = ecx_39 - 0x01;
			byte * esi_76 = esi_34;
			byte * edi_77 = edi_40;
			if (*esi_76 == *edi_77)
				break;
		}
		if (Z_38)
			return (Mem0[edx_23 + 0x1C:word32] + eax_18)[ebp_29 * 0x04] + eax_18;
		ebp_29 = ebp_29 + 0x01;
	} while (ebp_29 != edx_23->dw0018);
	return (Mem11[edx_23 + 0x1C:word32] + eax_18)[ebp_29 * 0x04] + eax_18;
}

// 00400493: void fn00400493()
void fn00400493()
{
	globals->dw400316 = ~globals->dw400316;
	globals->dw400359 = ~globals->dw400359;
	globals->t400308 = ~globals->t400308;
	EnumTimeFormatsA(&globals->t40046D, 0x00, 0x00);
}

