// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401E14: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	struct Eq_4 * esp_24 = fp - 0x20;
	struct Eq_8 * ebp_132 = &globals->t40900C;
	if (globals->b40954A != 0x01)
	{
		globals->b40954A = 0x01;
		ptr32 eax_104 = 0x0040900C - globals->dw409557;
		globals->ptr409520 = (ptr32) 0x0040900C;
		globals->dw409597 = eax_104;
		word32 eax_108 = globals->dw409597 + globals->dw40957B;
		globals->dw40954F = eax_108;
		if (globals->b409548 == 0x01)
		{
			ebx = globals->dw409573 + globals->dw409597;
			globals->dw409573 = ebx;
			word32 v13_582 = globals->dw40957F;
			globals->dw40957F = *ebx;
			*ebx = v13_582;
			eax_108 = v13_582;
		}
		ptr32 eax_135;
		ptr32 ebx_134;
		fn0040951C();
		ptr32 esp_125 = fp - 0x30;
		if (eax_108 == 0x00)
		{
			eax_135 = (ptr32) 0x004094C3;
			ebx_134 = (ptr32) 4232339;
l004092D8:
			word32 * esp_136 = esp_125 - 0x04;
			*esp_136 = ~0x00;
			*(esp_136 - 0x04) = ~0x00;
			word32 edx_140 = ebp_132->dw05AD;
			<anonymous> * ecx_141 = ebp_132->ptr05B5;
			*(esp_136 - 0x08) = 0x30;
			*(esp_136 - 0x0C) = ebx_134;
			*(esp_136 - 0x10) = eax_135;
			*(esp_136 - 0x14) = 0x00;
			*(esp_136 - 0x18) = edx_140;
			word32 esp_155;
			byte Z_156;
			Eq_2 eax_157;
			word32 ecx_158;
			word32 edx_159;
			word32 ebx_160;
			word32 ebp_161;
			word32 esi_162;
			word32 edi_163;
			byte SCZO_164;
			byte SZO_165;
			byte C_166;
			byte S_167;
			word16 bx_168;
			byte bl_169;
			word16 ax_170;
			ecx_141();
			return eax_157;
		}
		globals->dw40956F = eax_108;
		word32 * esi_173 = globals->dw409567 + 0x0040900C;
		while (true)
		{
			word32 eax_185 = *esi_173;
			struct Eq_184 * esi_186 = esi_173 + 0x01;
			if (eax_185 == 0x00)
				break;
			byte * edi_193 = eax_185 + globals->dw409597;
			word32 ecx_196 = esi_186->dw0000;
			esi_173 = (word32 *) (&esi_186->dw0004 + 0x01);
			if (esi_186->dw0004 != 0x00)
			{
				*(fp - 0x34) = &esi_186->dw0004 + 0x01;
				*(fp - 0x38) = (byte **) edi_193;
				byte * esi_207 = edi_193;
				byte * edi_208 = globals->dw40956F;
				while (ecx_196 != 0x00)
				{
					*edi_208 = *esi_207;
					esi_207 = esi_207 + 0x01;
					edi_208 = edi_208 + 0x01;
					ecx_196 = ecx_196 - 0x01;
				}
				word32 edi_217 = *(fp - 0x38);
				*(fp - 0x38) = edi_217;
				*(fp - 0x3C) = edi_217;
				*(fp - 0x40) = globals->dw40956F;
				word32 eax_228 = fn0040934F(dwArg00, dwArg04);
				struct Eq_252 * edi_230 = *(fp - 0x38);
				*(fp - 0x38) = edx;
				*(fp - 0x3C) = ebx;
				int32 eax_232 = eax_228 - 0x05;
				struct Eq_272 * ecx_234 = null;
				word32 edx_239 = 0x00;
				if (false)
				{
					while (true)
					{
						eax_232 = eax_232 - 0x01;
						if (eax_232 == 0x00 || eax_232 < 0x00)
							break;
						word16 bx_270 = Mem238[ecx_234 + edi_230:word16];
						byte bl_272 = (byte) bx_270;
						if (bl_272 != 232 && bl_272 != 233)
						{
							if (bx_270 != 0x25FF)
								ecx_234 = ecx_234 + 0x01;
							else
							{
								Mem289[ecx_234 + 0x02 + edi_230:word32] = Mem238[ecx_234 + 0x02 + edi_230:word32] - edx_239;
								ecx_234 = ecx_234 + 0x06;
								edx_239 = edx_239 - 0x04;
								eax_232 = eax_232 - 0x05;
							}
						}
						else
						{
							Mem277[ecx_234 + 0x01 + edi_230:word32] = Mem238[ecx_234 + 0x01 + edi_230:word32] - ecx_234;
							ecx_234 = ecx_234 + 0x05;
							eax_232 = eax_232 - 0x04;
						}
					}
				}
				globals->b4090DF = ~0x07;
				ebx = *(fp - 0x3C);
				edx = *(fp - 0x38);
				esi_173 = *(fp - 0x34);
			}
		}
		*(fp - 0x34) = 0x04;
		*(fp - 0x38) = globals->dw40956B;
		*(fp - 0x3C) = globals->dw40956F;
		fn00409522();
		esp_24 = fp - 0x3C;
		if (globals->b409548 == 0x01)
			*globals->dw409573 = globals->dw40957F;
		globals->dw40954B = globals->dw40954F;
		globals->dw409553 = globals->dw40954F - globals->dw40954B + globals->dw409597;
		word32 esi_312 = globals->dw409577;
		if (esi_312 != 0x00)
		{
			word32 esi_550 = esi_312 + globals->dw409597;
			struct Eq_481 * esi_551 = esi_550 + 0x10;
			word32 edx_553 = globals->dw40954F - globals->dw409593;
			if (edx_553 != 0x00)
				esi_551 = fn004092F3(edx_553, &globals->t40900C, esi_550 + 0x10);
			word32 edx_560 = globals->dw409597 - globals->dw40959B;
			if (edx_560 != 0x00)
				fn004092F3(edx_560, &globals->t40900C, esi_551);
		}
		int32 ecx_321 = globals->dw409597;
		struct Eq_470 * edx_322 = globals->dw40954F;
		while (true)
		{
			int32 eax_333 = edx_322->dw000C;
			if (eax_333 == 0x00)
				break;
			edx_322->dw000C = ecx_321;
			word32 eax_340 = eax_333 + globals->dw409553;
			struct Eq_4 * esp_342 = esp_24 - 0x04;
			esp_342->ptr0000 = edx_322;
			*(esp_342 - 0x04) = ecx_321;
			*(esp_342 - 0x08) = eax_340;
			*(esp_342 - 0x0C) = eax_340;
			globals->dw40955F = eax_340;
			fn00409528();
			word32 ebx_352 = *(esp_342 - 0x0C);
			ecx_321 = *(esp_342 - 0x08);
			struct Eq_564 * edx_358 = *(esp_342 - 0x04);
			esp_24 = esp_342;
			if (eax_340 == 0x00)
			{
				*(esp_342 - 0x04) = (struct Eq_564 **) edx_358;
				*(esp_342 - 0x08) = ecx_321;
				*(esp_342 - 0x0C) = ebx_352;
				fn0040952E();
				if (eax_340 == 0x00)
				{
					*(esp_342 - 0x10) = (ptr32) 4232666;
					*(esp_342 - 0x14) = ebx_352;
					*(esp_342 - 0x18) = (ptr32) 0x004094DD;
					*(esp_342 - 0x1C) = (ptr32) 4232666;
					struct Eq_636 * esp_526;
					byte Z_527;
					word32 eax_528;
					word32 ecx_529;
					word32 edx_530;
					word32 ebx_531;
					word32 esi_533;
					word32 edi_534;
					byte SCZO_535;
					byte SZO_536;
					byte C_537;
					byte S_538;
					word16 bx_539;
					byte bl_540;
					word16 ax_541;
					globals->ptr4095C5();
					eax_135 = esp_526->ptr000C;
					esp_125 = &esp_526->ptr000C + 0x01;
					ebx_134 = (char *) ebp_132 + 1181;
					goto l004092D8;
				}
				ecx_321 = *(esp_342 - 0x0C);
				edx_358 = (struct Eq_564 *) *(esp_342 - 0x08);
				esp_24 = esp_342 - 0x04;
			}
			globals->dw409245 = eax_340;
			int32 esi_371 = edx_358->dw0000;
			edx_358->dw0000 = ecx_321;
			int32 edi_373 = edx_358->dw0010;
			edx_358->dw0010 = ecx_321;
			int32 esi_375 = esi_371;
			if (esi_371 == 0x00)
				esi_375 = edi_373;
			int32 * esi_380 = esi_375 + globals->dw409553;
			ptr32 edi_381 = edi_373 + globals->dw409553;
			while (true)
			{
				int32 eax_391 = *esi_380;
				word16 ax_393 = (word16) eax_391;
				if (eax_391 == 0x00)
					break;
				ptr32 eax_400;
				*esi_380 = ecx_321;
				if (eax_391 < 0x00)
					eax_400 = (word32) ax_393;
				else
				{
					word16 * eax_491 = eax_391 + globals->dw409553;
					*eax_491 = 0x00;
					eax_400 = eax_491 + 0x01;
				}
				ptr32 * esp_402 = esp_24 - 0x04;
				*esp_402 = eax_400;
				*(esp_402 - 0x04) = (struct Eq_564 **) edx_358;
				*(esp_402 - 0x08) = esi_380;
				*(esp_402 - 0x0C) = edi_381;
				*(esp_402 - 0x10) = ecx_321;
				*(esp_402 - 0x14) = ebx_352;
				*(esp_402 - 0x18) = eax_400;
				*(esp_402 - 0x1C) = eax_400;
				*(esp_402 - 0x20) = 305419896;
				fn00409534();
				ui32 ebx_420 = *(esp_402 - 0x20);
				if (eax_400 == 0x00)
				{
					ptr32 edi_447 = 0x00409502;
					if ((ebx_420 & 0xFFFF0000) != 0x00)
						edi_447 = (ptr32) 4232431;
					*(esp_402 - 0x20) = (ptr32) 4232666;
					*(esp_402 - 0x24) = globals->dw40955F;
					*(esp_402 - 0x28) = ebx_420;
					*(esp_402 - 44) = edi_447;
					*(esp_402 - 0x30) = (ptr32) 4232666;
					struct Eq_851 * esp_464;
					byte Z_465;
					word32 eax_466;
					word32 ecx_467;
					word32 edx_468;
					word32 ebx_469;
					word32 esi_471;
					word32 edi_472;
					byte SCZO_473;
					byte SZO_474;
					byte C_475;
					byte S_476;
					word16 bx_477;
					byte bl_478;
					word16 ax_479;
					globals->ptr4095C5();
					eax_135 = esp_464->ptr0010;
					esp_125 = &esp_464->ptr0010 + 0x01;
					ebx_134 = (char *) ebp_132 + 1181;
					goto l004092D8;
				}
				ecx_321 = *(esp_402 - 0x18);
				ptr32 * edi_433 = *(esp_402 - 0x14);
				*edi_433 = eax_400;
				edx_358 = (struct Eq_564 *) *(esp_402 - 0x0C);
				ebx_352 = *(esp_402 - 0x08);
				esp_24 = esp_402 - 0x04;
				esi_380 = *(esp_402 - 0x10) + 0x04;
				edi_381 = edi_433 + 0x01;
			}
			edx_322 = (struct Eq_470 *) (&edx_358->dw0010 + 0x01);
		}
	}
	esp_24[0x07] = (struct Eq_4) (globals->dw409563 + globals->dw409597);
	<anonymous> * eax_78 = esp_24[0x07];
	word32 esp_86;
	byte Z_87;
	Eq_2 eax_88;
	word32 ecx_89;
	word32 edx_90;
	word32 ebx_91;
	word32 ebp_92;
	word32 esi_93;
	word32 edi_94;
	byte SCZO_95;
	byte SZO_96;
	byte C_97;
	byte S_98;
	word16 bx_99;
	byte bl_100;
	word16 ax_101;
	eax_78();
	return eax_88;
}

// 004092F3: Register (ptr Eq_481) fn004092F3(Register word32 edx, Register (ptr Eq_511) ebp, Register (ptr Eq_481) esi)
Eq_481 * fn004092F3(word32 edx, Eq_511 * ebp, Eq_481 * esi)
{
	word32 eax_4 = esi->w0000;
	struct Eq_481 * esi_107 = (char *) &esi->w0001 + 0x03;
	if (eax_4 != 0x00)
	{
		word32 * ebx_29 = eax_4 + ebp->dw058B;
		*ebx_29 = *ebx_29 + edx;
		while (true)
		{
			Eq_940 al_40 = esi_107->w0000;
			esi_107 = &esi_107->w0001;
			*(esi_107 - 0x01) = dl;
			word32 eax_44 = (word32) al_40;
			byte al_45 = (byte) eax_44;
			Eq_907 eax_104 = DPB(eax_44, al_45, 0);
			if (al_45 == 0x00)
				break;
			if (al_45 != 0x01)
			{
				if (al_45 != 0x02)
				{
					if (al_45 == 0x03)
					{
						word32 ecx_69 = (word32) esi_107->w0000;
						byte cl_70 = (byte) ecx_69;
						struct Eq_925 * esi_101 = &esi_107->w0001;
						Eq_928 ecx_102 = DPB(ecx_69, cl_70, 0);
						if (cl_70 != 0x00)
						{
							if (cl_70 == 0x01)
							{
								esi_101 = (struct Eq_925 *) (&esi_107->w0001 + 0x02);
								ecx_102.u0 = esi_107->w0001;
							}
						}
						else
						{
							esi_101 = (struct Eq_925 *) (esi_107 + 0x01);
							ecx_102 = (word32) esi_107->w0001;
						}
						esi_107 = (struct Eq_481 *) ((char *) &esi_101->t0000 + 0x01);
						int32 eax_83 = (word32) esi_101->t0000;
						do
						{
							ebx_29 = ebx_29 + eax_83;
							*ebx_29 = *ebx_29 + edx;
							ecx_102 = ecx_102 - 0x01;
						} while (ecx_102 != 0x00);
						continue;
					}
				}
				else
				{
					eax_104.u1 = esi_107->w0000;
					esi_107 = (struct Eq_481 *) ((char *) &esi_107->w0001 + 0x03);
				}
			}
			else
			{
				esi_107 = (struct Eq_481 *) ((char *) &esi_107->w0001 + 0x01);
				eax_104 = (word32) esi_107->w0000;
			}
			ebx_29 = ebx_29 + eax_104;
			*ebx_29 = *ebx_29 + edx;
		}
	}
	return esi_107;
}

// 0040934F: Register ptr32 fn0040934F(Stack (ptr bui8) dwArg04, Stack (ptr byte) dwArg08)
ptr32 fn0040934F(bui8 * dwArg04, byte * dwArg08)
{
	Eq_989 ebp_239 = fp - 0x04;
	bui8 * esi_111 = dwArg04;
	byte * edi_182 = dwArg08;
	Eq_995 dl_104 = 0x80;
	while (true)
	{
		*edi_182 = *esi_111;
		esi_111 = esi_111 + 0x01;
		edi_182 = edi_182 + 0x01;
		while (true)
		{
			dl_104 = dl_104 * 0x02;
			bool C_527 = cond(dl_104);
			if (dl_104 == 0x00)
			{
				dl_104 = (byte) (*esi_111 * 0x02) + (dl_104 < 0x00);
				esi_111 = esi_111 + 0x01;
				C_527 = cond(dl_104);
			}
			if (C_527)
				break;
			dl_104 = dl_104 * 0x02;
			bool C_518 = cond(dl_104);
			if (dl_104 == 0x00)
			{
				dl_104 = (byte) (*esi_111 * 0x02) + (dl_104 < 0x00);
				esi_111 = esi_111 + 0x01;
				C_518 = cond(dl_104);
			}
			if (C_518)
			{
				Eq_1036 eax_287 = 0x01;
				do
				{
					Eq_1094 dl_294 = dl_104 * 0x02;
					byte C_299 = cond(dl_294);
					if (dl_294 == 0x00)
					{
						dl_294 = (byte) (*esi_111 * 0x02) + (dl_294 < 0x00);
						esi_111 = esi_111 + 0x01;
						C_299 = cond(dl_294);
					}
					dl_104 = dl_294 * 0x02;
					eax_287 = (word32) (eax_287 * 0x02) + C_299;
					bool C_312 = cond(dl_104);
					if (dl_104 == 0x00)
					{
						dl_104 = (byte) (*esi_111 * 0x02) + (dl_104 < 0x00);
						esi_111 = esi_111 + 0x01;
						C_312 = cond(dl_104);
					}
				} while (C_312);
				if (eax_287 == 0x02)
				{
					Eq_1240 ecx_326 = 0x01;
					do
					{
						Eq_1242 dl_331 = dl_104 * 0x02;
						byte C_336 = cond(dl_331);
						if (dl_331 == 0x00)
						{
							dl_331 = (byte) (*esi_111 * 0x02) + (dl_331 < 0x00);
							esi_111 = esi_111 + 0x01;
							C_336 = cond(dl_331);
						}
						dl_104 = dl_331 * 0x02;
						ecx_326 = (word32) (ecx_326 * 0x02) + C_336;
						bool C_348 = cond(dl_104);
						if (dl_104 == 0x00)
						{
							dl_104 = (byte) (*esi_111 * 0x02) + (dl_104 < 0x00);
							esi_111 = esi_111 + 0x01;
							C_348 = cond(dl_104);
						}
					} while (C_348);
					byte * esi_361 = edi_182 - ebp_239;
					while (ecx_326 != 0x00)
					{
						*edi_182 = *esi_361;
						esi_361 = esi_361 + 0x01;
						edi_182 = edi_182 + 0x01;
						ecx_326 = ecx_326 - 0x01;
					}
					continue;
				}
				Eq_989 eax_395 = DPB(eax_287 - 0x03 << 0x08, *esi_111, 0);
				bui8 * esi_396 = esi_111 + 0x01 + 0x01;
				ebp_239 = eax_395;
				Eq_1238 ecx_399 = 0x01;
				do
				{
					Eq_1305 dl_404 = dl_104 * 0x02;
					byte C_409 = cond(dl_404);
					if (dl_404 == 0x00)
					{
						dl_404 = (byte) (*esi_396 * 0x02) + (dl_404 < 0x00);
						esi_396 = esi_396;
						C_409 = cond(dl_404);
					}
					dl_104 = dl_404 * 0x02;
					ecx_399 = (word32) (ecx_399 * 0x02) + C_409;
					bool C_421 = cond(dl_104);
					if (dl_104 == 0x00)
					{
						dl_104 = (byte) (*esi_396 * 0x02) + (dl_104 < 0x00);
						esi_396 = esi_396 + 0x01;
						C_421 = cond(dl_104);
					}
				} while (C_421);
				if (eax_395 < 0x7D00)
				{
					if (eax_395 >= 0x0500)
					{
						Eq_1351 ecx_457 = (word32) ecx_399 + 0x01;
						byte * esi_461 = edi_182 - eax_395;
						while (ecx_457 != 0x00)
						{
							*edi_182 = *esi_461;
							esi_461 = esi_461 + 0x01;
							edi_182 = edi_182 + 0x01;
							ecx_457 = ecx_457 - 0x01;
						}
						esi_111 = esi_396;
						continue;
					}
					if (eax_395 <= 0x7F)
						goto l00409450;
				}
				else
				{
l00409450:
					ecx_399 = (word32) ecx_399 + 0x02;
				}
				byte * esi_439 = edi_182 - eax_395;
				while (ecx_399 != 0x00)
				{
					*edi_182 = *esi_439;
					esi_439 = esi_439 + 0x01;
					edi_182 = edi_182 + 0x01;
					ecx_399 = ecx_399 - 0x01;
				}
				esi_111 = esi_396;
				continue;
			}
			dl_104 = dl_104 * 0x02;
			bool C_109 = cond(dl_104);
			if (dl_104 == 0x00)
			{
				dl_104 = (byte) (*esi_111 * 0x02) + (dl_104 < 0x00);
				esi_111 = esi_111 + 0x01;
				C_109 = cond(dl_104);
			}
			if (C_109)
			{
				bu8 al_228 = *esi_111;
				bui8 * esi_229 = esi_111 + 0x01;
				Eq_989 eax_232 = (word32) (al_228 >> 0x01);
				if (al_228 >> 0x01 == 0x00)
					return edi_182 - dwArg08;
				else
				{
					Eq_1117 ecx_238 = (al_228 >> 0x01 < 0x00) + 0x02;
					ebp_239 = eax_232;
					byte * esi_243 = edi_182 - eax_232;
					while (ecx_238 != 0x00)
					{
						*edi_182 = *esi_243;
						esi_243 = esi_243 + 0x01;
						edi_182 = edi_182 + 0x01;
						ecx_238 = ecx_238 - 0x01;
					}
					esi_111 = esi_229;
					continue;
				}
			}
			Eq_1069 dl_119 = dl_104 * 0x02;
			bui8 C_124 = cond(dl_119);
			if (dl_119 == 0x00)
			{
				dl_119 = (byte) (*esi_111 * 0x02) + (dl_119 < 0x00);
				esi_111 = esi_111 + 0x01;
				C_124 = cond(dl_119);
			}
			Eq_1076 dl_132 = dl_119 * 0x02;
			byte C_137 = cond(dl_132);
			if (dl_132 == 0x00)
			{
				dl_132 = (byte) (*esi_111 * 0x02) + (dl_132 < 0x00);
				esi_111 = esi_111 + 0x01;
				C_137 = cond(dl_132);
			}
			Eq_1139 dl_145 = dl_132 * 0x02;
			Eq_1142 eax_143 = (word32) (C_124 * 0x02) + C_137;
			byte C_150 = cond(dl_145);
			if (dl_145 == 0x00)
			{
				dl_145 = (byte) (*esi_111 * 0x02) + (dl_145 < 0x00);
				esi_111 = esi_111 + 0x01;
				C_150 = cond(dl_145);
			}
			dl_104 = dl_145 * 0x02;
			Eq_1168 eax_156 = (word32) (eax_143 * 0x02) + C_150;
			byte C_163 = cond(dl_104);
			if (dl_104 == 0x00)
			{
				dl_104 = (byte) (*esi_111 * 0x02) + (dl_104 < 0x00);
				esi_111 = esi_111 + 0x01;
				C_163 = cond(dl_104);
			}
			Eq_1187 eax_171 = (word32) (eax_156 * 0x02) + C_163;
			byte al_172 = (byte) eax_171;
			if (eax_171 != 0x00)
				al_172 = Mem59[edi_182 - eax_171 + 0x00:byte];
			*edi_182 = al_172;
			edi_182 = edi_182 + 0x01;
		}
	}
}

// 0040951C: void fn0040951C()
void fn0040951C()
{
	word32 esp_4;
	word32 ebp_5;
	ebp->ptr05A5();
}

// 00409522: void fn00409522()
void fn00409522()
{
	word32 esp_4;
	word32 ebp_5;
	ebp->ptr05A9();
}

// 00409528: void fn00409528()
void fn00409528()
{
	word32 esp_4;
	word32 ebp_5;
	ebp->ptr0599();
}

// 0040952E: void fn0040952E()
void fn0040952E()
{
	word32 esp_4;
	word32 ebp_5;
	ebp->ptr059D();
}

// 00409534: void fn00409534()
void fn00409534()
{
	word32 esp_4;
	word32 ebp_5;
	ebp->ptr05A1();
}

