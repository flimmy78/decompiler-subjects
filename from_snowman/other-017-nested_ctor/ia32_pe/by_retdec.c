//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
// Copyright (c) 2018 Retargetable Decompiler <info@retdec.com>
//

#include <stdint.h>
#include <stdlib.h>
#include <windows.h>

// ------------------------ Structures ------------------------

struct _EXCEPTION_POINTERS {
    struct _EXCEPTION_RECORD * e0;
    struct _CONTEXT * e1;
};

struct _EXCEPTION_RECORD {
    int32_t e0;
    int32_t e1;
    struct _EXCEPTION_RECORD * e2;
    char * e3;
    int32_t e4;
    int32_t e5[1];
};

struct _M128A {
    int64_t e0;
    int64_t e1;
};

struct _CONTEXT {
    int64_t e0;
    int64_t e1;
    int64_t e2;
    int64_t e3;
    int64_t e4;
    int64_t e5;
    int32_t e6;
    int32_t e7;
    int16_t e8;
    int16_t e9;
    int16_t e10;
    int16_t e11;
    int16_t e12;
    int16_t e13;
    int32_t e14;
    int64_t e15;
    int64_t e16;
    int64_t e17;
    int64_t e18;
    int64_t e19;
    int64_t e20;
    int64_t e21;
    int64_t e22;
    int64_t e23;
    int64_t e24;
    int64_t e25;
    int64_t e26;
    int64_t e27;
    int64_t e28;
    int64_t e29;
    int64_t e30;
    int64_t e31;
    int64_t e32;
    int64_t e33;
    int64_t e34;
    int64_t e35;
    int64_t e36;
    int64_t e37;
    int32_t e38;
    struct _M128A e39[26];
    int64_t e40;
    int64_t e41;
    int64_t e42;
    int64_t e43;
    int64_t e44;
    int64_t e45;
};

struct vtable_403740_type {
    int32_t (*e0)();
};

struct vtable_40374c_type {
    int32_t (*e0)();
};

struct vtable_403758_type {
    int32_t (*e0)();
};

// ------------------------- Classes --------------------------

// AAAAA
// BBBBB (base classes: AAAAA)
// type_info

// ------------------- Function Prototypes --------------------

void entry_point(void);
int32_t function_401000(void);
int32_t function_401040(void);
void function_401060(void);
int32_t function_401070(int32_t a1);
void function_401090(void);
void function_4010a0(void);
int32_t function_401166(int32_t a1);
int32_t function_4011bd(int32_t a1);
void function_4011c2(void);
int32_t function_4011cf(int32_t a1, int32_t a2, int32_t a3);
int32_t function_4013ea(int32_t a1);
int32_t (**function_4015c9(void))(struct _EXCEPTION_POINTERS *);
void function_4015d8(void);
int32_t function_4016e8(void);
void function_401735(void);
void function_401784(void);
int32_t function_40184d(int32_t (***a1)());
int32_t function_4018de(void);
int32_t function_40192d(int32_t a1);
int32_t function_401937(void);
void function_40193a(void);
int32_t (**function_4019db(void (****a1)()))();
int32_t function_401a0a(void);
int32_t function_401b22(void);
int32_t unknown_40622c(void);
int32_t unknown_406238(void);

// --------------------- Global Variables ---------------------

int32_t g1 = 0; // eax
int32_t g2 = 0; // ecx
void (**g3)() = (void (**)())-0x47a90075; // 0x4016c2
char * g4 = "\x33\xc0\xc3\x33\xc0\xc3\xff\x25\xf8\x61\x40"; // 0x401934
int32_t g8 = -2; // 0x405050
int32_t g9 = 1; // 0x405054
int32_t g10 = 0; // 0x405170
char *** g11 = NULL; // 0x405174
char *** g12 = NULL; // 0x405178
int32_t g13 = 0; // 0x40517c
int32_t g14 = 0; // 0x405180
int32_t g15 = 0; // 0x405184
int32_t g16 = 0; // 0x405190
int32_t g17 = 0; // 0x405194
int32_t g18 = 0; // 0x405198
int32_t g19 = 0; // 0x40519c
int32_t g20 = 0; // 0x4054d8
int32_t g21 = 0; // 0x4054e8
struct vtable_403740_type g5 = {
    .e0 = function_40100a
}; // 0x403740
struct vtable_40374c_type g6 = {
    .e0 = function_401005
}; // 0x40374c
struct vtable_403758_type g7 = {
    .e0 = function_401171
}; // 0x403758

// ------------------------ Functions -------------------------

// Address range: 0x401000 - 0x40103f
int32_t function_401000(void) {
    // 0x401000
    function_401090();
    return g1;
}

// Address range: 0x401040 - 0x40105f
// From class:    AAAAA
// Type:          constructor
int32_t function_401040(void) {
    // 0x401040
    g1 = g2;
    *(int32_t *)g2 = (int32_t)&g5;
    *(int32_t *)(g2 + 4) = 100;
    return g2;
}

// Address range: 0x401060 - 0x40106f
void function_401060(void) {
    // 0x401060
    return;
}

// Address range: 0x401070 - 0x40108f
// From class:    BBBBB
// Type:          constructor
int32_t function_401070(int32_t a1) {
    // 0x401070
    function_401040();
    int32_t * v1 = (int32_t *)(g2 + 4); // 0x401078_0
    *v1 = *v1 + 1;
    *(int32_t *)g2 = (int32_t)&g6;
    return g2;
}

// Address range: 0x401090 - 0x40109f
void function_401090(void) {
    // 0x401090
    g1 = *(int32_t *)(g2 + 4);
}

// Address range: 0x4010a0 - 0x401165
void function_4010a0(void) {
    int32_t v1 = 0; // 0x4010a3
    _qm__qm_2_YAPAXI_Z(8);
    int32_t v2 = g1; // 0x4010ae
    int32_t v3 = 0;
    if (v2 != 0) {
        // 0x4010b2
        g2 = v2;
        int32_t v4 = function_401070(v1); // 0x4010b4
        g1 = v4;
        v3 = v4;
        // branch -> 0x4010bf
    }
    _qm__qm_2_YAPAXI_Z(8);
    int32_t v5 = g1; // 0x4010c9
    int32_t v6 = 0;
    if (v5 != 0) {
        // 0x4010cd
        g2 = v5;
        int32_t v7 = function_401040(); // 0x4010cf
        g1 = v7;
        v6 = v7;
        // branch -> 0x4010da
    }
    _qm__qm_2_YAPAXI_Z(8);
    int32_t v8 = g1; // 0x4010e4
    int32_t v9 = 0;
    if (v8 != 0) {
        // 0x4010e8
        g2 = v8;
        int32_t v10 = function_401070(v1); // 0x4010ea
        g1 = v10;
        v9 = v10;
        // branch -> 0x4010f5
    }
    _qm__qm_2_YAPAXI_Z(8);
    int32_t v11 = g1; // 0x4010ff
    int32_t v12;
    if (v11 != 0) {
        // 0x401103
        g2 = v11;
        v12 = function_401040();
        // branch -> 0x401110
    } else {
        v12 = 0;
    }
    int32_t v13 = *(int32_t *)v6; // 0x401110
    g1 = v13;
    g2 = v6;
    ((int32_t (*)())*(int32_t *)v13)();
    int32_t v14 = *(int32_t *)v12; // 0x40111a
    g1 = v14;
    g2 = v12;
    ((int32_t (*)())*(int32_t *)v14)();
    int32_t v15 = *(int32_t *)v9; // 0x401125
    g1 = v15;
    g2 = v9;
    ((int32_t (*)())*(int32_t *)v15)();
    int32_t v16 = *(int32_t *)v3; // 0x40112f
    g1 = v16;
    g2 = v3;
    ((int32_t (*)())*(int32_t *)v16)();
}

// Address range: 0x401166 - 0x401170
// From class:    type_info
// Type:          constructor
int32_t function_401166(int32_t a1) {
    // 0x401166
    *(int32_t *)g2 = (int32_t)&g7;
    return g2;
}

// Address range: 0x4011bd - 0x4011c1
int32_t function_4011bd(int32_t a1) {
    // 0x4011bd
    return g2;
}

// Address range: 0x4011c2 - 0x4011ce
void function_4011c2(void) {
    // 0x4011c2
    unknown_406238();
}

// Address range: 0x4011cf - 0x401219
int32_t function_4011cf(int32_t a1, int32_t a2, int32_t a3) {
    // 0x4011cf
    atexit((void (**)())&g3);
    g15 = g17;
    int32_t result = __getmainargs(&g10, (char ***)&g12, (char ***)&g11, g16, &g15); // 0x4011ff
    g14 = result;
    if (result <= 0) {
        // 0x401211
        _amsg_exit(8);
        // branch -> 0x401219
    }
    // 0x401219
    return result;
}

// Address range: 0x4013ea - 0x4014a3
int32_t function_4013ea(int32_t a1) {
    // 0x4013ea
    int32_t v1; // 0x401441_4
    if (*(int16_t *)0x400000 == 0x5a4d) {
        int32_t v2 = *(int32_t *)0x40003c; // 0x4013fc
        if (*(int32_t *)(v2 + 0x400000) == 0x4550) {
            // 0x40140d
            if (*(int16_t *)(v2 + 0x400018) == 267) {
                // 0x40141b
                int32_t v3;
                if (*(int32_t *)(v2 + 0x400074) >= 15) {
                    // 0x401424
                    v3 = *(int32_t *)(v2 + 0x4000e8) != 0;
                    // branch -> 0x401431
                } else {
                    v3 = 0;
                }
                // 0x401431
                g13 = v3;
                __set_app_type(1);
                v1 = (int32_t)EncodePointer((char *)-1);
                g20 = v1;
                g21 = v1;
                *(int32_t *)0x634c = g19;
                *(int32_t *)0x6340 = g18;
                _RTC_Initialize();
                function_401937();
                if (g9 == 0) {
                    // 0x40147e
                    __setusermatherr((int32_t)&g4);
                    // branch -> 0x40148a
                }
                // 0x40148a
                __setdefaultprecision();
                if (g8 == -1) {
                    // 0x401498
                    _configthreadlocale(-1);
                    // branch -> 0x4014a1
                }
                // 0x4014a1
                return 0;
            }
        }
    }
    // 0x401431
    g13 = 0;
    __set_app_type(1);
    v1 = (int32_t)EncodePointer((char *)-1);
    g20 = v1;
    g21 = v1;
    *(int32_t *)0x634c = g19;
    *(int32_t *)0x6340 = g18;
    _RTC_Initialize();
    function_401937();
    if (g9 == 0) {
        // 0x40147e
        __setusermatherr((int32_t)&g4);
        // branch -> 0x40148a
    }
    // 0x40148a
    __setdefaultprecision();
    if (g8 == -1) {
        // 0x401498
        _configthreadlocale(-1);
        // branch -> 0x4014a1
    }
    // 0x4014a1
    return 0;
}

// Address range: 0x4014a4 - 0x4014b3
void entry_point(void) {
    // 0x4014a4
    __security_init_cookie();
    _qm__qm__qm_();
}

// Address range: 0x4015c9 - 0x4015d7
int32_t (**function_4015c9(void))(struct _EXCEPTION_POINTERS *) {
    // 0x4015c9
    SetUnhandledExceptionFilter((int32_t (**)(struct _EXCEPTION_POINTERS *))0x401587);
    return NULL;
}

// Address range: 0x4015d8 - 0x4015e3
void function_4015d8(void) {
    // 0x4015d8
    unknown_40622c();
}

// Address range: 0x4016e8 - 0x4016ff
int32_t function_4016e8(void) {
    // 0x4016e8
    _cexit();
    return g1;
}

// Address range: 0x401735 - 0x40173f
void function_401735(void) {
    // 0x401735
    return;
}

// Address range: 0x401784 - 0x40178f
void function_401784(void) {
    // 0x401784
    return;
}

// Address range: 0x40184d - 0x40185f
int32_t function_40184d(int32_t (***a1)()) {
    // 0x40184d
    return _initterm_e(NULL, a1);
}

// Address range: 0x4018de - 0x4018e3
int32_t function_4018de(void) {
    int32_t result = _configthreadlocale(0); // 0x4018de
    g1 = result;
    return result;
}

// Address range: 0x40192d - 0x401936
int32_t function_40192d(int32_t a1) {
    // 0x40192d
    int32_t v1;
    __setusermatherr(v1);
    return g1;
}

// Address range: 0x401937 - 0x401939
int32_t function_401937(void) {
    // 0x401937
    g1 = 0;
    return 0;
}

// Address range: 0x40193a - 0x40193f
void function_40193a(void) {
    // 0x40193a
    __set_app_type(0);
}

// Address range: 0x4019db - 0x401a09
int32_t (**function_4019db(void (****a1)()))() {
    // 0x4019db
    _qm_terminate__YAXXZ((int32_t)a1);
    return (int32_t (**)())g1;
}

// Address range: 0x401a0a - 0x401a1b
int32_t function_401a0a(void) {
    int32_t result = _except_handler4_common(); // 0x401a0a
    g1 = result;
    return result;
}

// Address range: 0x401b22 - 0x402e0d
int32_t function_401b22(void) {
    // 0x401b22
    _crt_debugger_hook();
    return g1;
}

// --------------- Statically Linked Functions ----------------

// void __cdecl __security_init_cookie(void);
// void __setdefaultprecision(void);
// void _qm__qm__qm_(void);
// void __cdecl _RTC_Initialize(void);
// int atexit(void(* func)(void));

// --------------- Dynamically Linked Functions ---------------

// int __getmainargs(int * Argc, char *** Argv, char *** Env, int DoWildCard, _startupinfo * StartInfo);
// void __set_app_type(int at);
// void __setusermatherr(_HANDLE_MATH_ERROR pf);
// void _amsg_exit(int rterrnum);
// void __cdecl _cexit(void);
// int __cdecl _configthreadlocale(_In_ int Flag);
// void _crt_debugger_hook(void);
// int _except_handler4_common(void);
// int __cdecl _initterm_e(_PIFV * First, _In_ _PIFV * Last);
// void _qm__qm_2_YAPAXI_Z(int32_t a1);
// void _qm_terminate__YAXXZ(int32_t a1);
// PVOID EncodePointer(_In_opt_ PVOID Ptr);
// LPTOP_LEVEL_EXCEPTION_FILTER SetUnhandledExceptionFilter(_In_opt_ LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: microsoft linker (10.0)
// Detected functions: 25
// Decompiler release: VERSION
// Decompilation date: DATE
