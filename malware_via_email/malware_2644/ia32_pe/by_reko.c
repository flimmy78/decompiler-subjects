// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 0040108C: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	ptr32 esp_456;
	ptr32 esp_380;
	ptr32 esp_217;
	ptr32 esp_293;
	ptr32 esp_306;
	Eq_8 eax_13 = OpenMutexA(0x001F0001, 0x00, &globals->t4371E9);
	if (eax_13 == null)
	{
		GetFileSize(OpenMutexA(0x001F0001, 0x01, &globals->t437260), 0x00);
		Eq_8 eax_551 = OpenMutexA(0x001F0001, 0x00, &globals->t437288);
		esp_456 = fp - 0x84;
		dwLoc0C = eax_551;
		if (eax_551 == null)
		{
			CloseHandle(eax_551);
			GetFileSize(eax_551, 0x00);
			Eq_8 eax_580 = OpenMutexA(0x001F0001, 0x00, &globals->t437237);
			esp_380 = fp - 0x9C;
			dwLoc4C = eax_580;
			if (eax_580 == null)
			{
				esp_217 = fp - 0xA4;
l00401124:
				struct Eq_266 * esp_347 = esp_217 - 0x04;
				esp_347->t0000 = 0x001F0001;
				dwLoc10 = OpenMutexA(esp_347->t0000, esp_347->t0004, esp_347->t0008);
				*(esp_347 - 0x04) = 0x00;
				*(esp_347 - 0x08) = (HANDLE *) eax_13;
				GetFileSize(*(esp_347 - 0x08), *(esp_347 - 0x04));
				esp_293 = esp_347 - 0x08;
l0040113D:
				HANDLE * esp_295 = esp_293 - 0x04;
				*esp_295 = (HANDLE *) dwLoc0C;
				GetFileType(*esp_295);
				*(esp_295 - 0x04) = (HANDLE *) dwLoc10;
				GetFileType(*(esp_295 - 0x04));
				*(esp_295 - 0x08) = (HANDLE *) dwLoc0C;
				CloseHandle(*(esp_295 - 0x08));
				*(esp_295 - 0x0C) = 0x00;
				esp_306 = esp_295 - 0x0C;
l0040115A:
				struct Eq_309 * esp_89 = esp_306 - 0x04;
				esp_89->t0000 = dwLoc4C;
				GetFileSize(esp_89->t0000, esp_89->t0004);
				*(esp_89 - 0x04) = 4420261;
				*(esp_89 - 0x08) = 0x00;
				*(esp_89 - 0x0C) = 0x001F0001;
				Eq_8 eax_98 = OpenMutexA(*(esp_89 - 0x0C), *(esp_89 - 0x08), *(esp_89 - 0x04));
				*(esp_89 - 0x10) = (HANDLE *) dwLoc0C;
				GetFileType(*(esp_89 - 0x10));
				*(esp_89 - 0x14) = 4420092;
				Eq_540 eax_106 = LoadLibraryA(*(esp_89 - 0x14));
				*(esp_89 - 0x18) = (HANDLE *) dwLoc10;
				CloseHandle(*(esp_89 - 0x18));
				*(esp_89 - 0x1C) = 4420209;
				*(esp_89 - 0x20) = (HANDLE *) eax_98;
				CloseHandle(*(esp_89 - 0x20));
				*(esp_89 - 0x24) = (HMODULE *) eax_106;
				*(esp_89 - 0x28) = 0x00;
				*(esp_89 - 44) = (HANDLE *) dwLoc0C;
				GetFileSize(*(esp_89 - 44), *(esp_89 - 0x28));
				*(esp_89 - 0x30) = 0x00;
				*(esp_89 - 0x34) = (HANDLE *) dwLoc0C;
				GetFileSize(*(esp_89 - 0x34), *(esp_89 - 0x30));
				Eq_626 eax_133 = GetProcAddress(*(esp_89 - 0x34), *(esp_89 - 0x30));
				*(esp_89 - 0x38) = (HANDLE *) eax_13;
				CloseHandle(*(esp_89 - 0x38));
				*(esp_89 - 0x3C) = 4420199;
				*(esp_89 - 0x40) = 0x01;
				*(esp_89 - 0x44) = 0x001F0001;
				OpenMutexA(*(esp_89 - 0x44), *(esp_89 - 0x40), *(esp_89 - 0x3C));
				*(esp_89 - 0x48) = (HANDLE *) dwLoc0C;
				GetFileType(*(esp_89 - 0x48));
				*(esp_89 - 0x4C) = 0x00;
				*(esp_89 - 0x50) = (HANDLE *) eax_98;
				GetFileSize(*(esp_89 - 0x50), *(esp_89 - 0x4C));
				*(esp_89 - 0x54) = (HANDLE *) dwLoc10;
				GetFileType(*(esp_89 - 0x54));
				*(esp_89 - 88) = 0x00;
				*(esp_89 - 0x5C) = 0x00;
				*(esp_89 - 0x60) = (HANDLE *) dwLoc10;
				GetFileSize(*(esp_89 - 0x60), *(esp_89 - 0x5C));
				*(esp_89 - 100) = 0x00;
				*(esp_89 - 0x68) = 0x00;
				*(esp_89 - 0x6C) = (HANDLE *) dwLoc0C;
				GetFileSize(*(esp_89 - 0x6C), *(esp_89 - 0x68));
				*(esp_89 - 0x70) = 0x00;
				*(esp_89 - 116) = (HANDLE *) eax_13;
				GetFileType(*(esp_89 - 116));
				Eq_388 eax_192 = eax_133();
				*(esp_89 - 0x78) = 4420171;
				*(esp_89 - 0x7C) = 0x01;
				*(esp_89 - 0x80) = 0x001F0001;
				Eq_8 eax_203 = OpenMutexA(*(esp_89 - 0x80), *(esp_89 - 0x7C), *(esp_89 - 0x78));
				*(esp_89 - 0x84) = 0x00;
				*(esp_89 - 0x88) = (HANDLE *) dwLoc10;
				GetFileSize(*(esp_89 - 0x88), *(esp_89 - 0x84));
				*(esp_89 - 0x8C) = 4420249;
				*(esp_89 - 0x90) = 0x00;
				*(esp_89 - 0x94) = 0x001F0001;
				esp_217 = esp_89 - 0x94;
				if (OpenMutexA(*(esp_89 - 0x94), *(esp_89 - 0x90), *(esp_89 - 0x8C)) == null)
				{
					*(esp_89 - 0x98) = 0x00;
					*(esp_89 - 0x9C) = (HANDLE *) eax_203;
					GetFileSize(*(esp_89 - 0x9C), *(esp_89 - 0x98));
					*(esp_89 - 0xA0) = 4420102;
					*(esp_89 - 0xA4) = 0x00;
					*(esp_89 - 0xA8) = 0x001F0001;
					*(esp_89 - 0xAC) = (HANDLE *) OpenMutexA(*(esp_89 - 0xA8), *(esp_89 - 0xA4), *(esp_89 - 0xA0));
					Eq_2 eax_246 = GetFileType(*(esp_89 - 0xAC));
					word32 esp_247;
					word32 ebp_248;
					byte SCZO_249;
					Eq_2 eax_250;
					byte SZO_251;
					byte C_252;
					byte Z_253;
					(*((word32) eax_192 - 2143300902))();
					return eax_250;
				}
				goto l00401124;
			}
			goto l004013E9;
		}
	}
	else
	{
		GetFileType(dwLoc54);
		Eq_8 eax_606 = OpenMutexA(0x001F0001, 0x01, &globals->t4371E2);
		CloseHandle(eax_606);
		GetFileType(dwLoc28);
		OpenMutexA(0x001F0001, 0x00, &globals->t437213);
		dwLoc58 = eax_606;
		esp_456 = fp - 0x98;
	}
	struct Eq_69 * esp_457 = esp_456 - 0x04;
	esp_457->t0000.u0 = 0x00;
	*(esp_457 - 0x04) = (HANDLE *) dwLoc54;
	GetFileSize(*(esp_457 - 0x04), esp_457->t0000);
	VirtualProtect(*(esp_457 - 0x04), esp_457->t0000, esp_457->t0004, esp_457->t0008);
	*(esp_457 - 0x08) = 4420060;
	*(esp_457 - 0x0C) = 0x00;
	*(esp_457 - 0x10) = 0x001F0001;
	dwLoc30 = OpenMutexA(*(esp_457 - 0x10), *(esp_457 - 0x0C), *(esp_457 - 0x08));
	*(esp_457 - 0x14) = 0x00431000;
	*(esp_457 - 0x18) = 0x00437242;
	*(esp_457 - 0x1C) = 0x01;
	*(esp_457 - 0x20) = 0x001F0001;
	esp_306 = esp_457 - 0x20;
	if (OpenMutexA(*(esp_457 - 0x20), *(esp_457 - 0x1C), *(esp_457 - 0x18)) != null)
		goto l0040115A;
	*(esp_457 - 0x24) = 0x00;
	*(esp_457 - 0x28) = dwLoc40;
	GetFileSize(*(esp_457 - 0x28), *(esp_457 - 0x24));
	*(esp_457 - 44) = dwLoc3C;
	*(esp_457 - 0x30) = 4420124;
	*(esp_457 - 0x34) = 0x00;
	*(esp_457 - 0x38) = 0x001F0001;
	Eq_8 eax_504 = OpenMutexA(*(esp_457 - 0x38), *(esp_457 - 0x34), *(esp_457 - 0x30));
	*(esp_457 - 0x3C) = 0x1877;
	*(esp_457 - 0x40) = (HANDLE *) eax_504;
	CloseHandle(*(esp_457 - 0x40));
	*(esp_457 - 0x44) = 0x00;
	*(esp_457 - 0x48) = (HANDLE *) dwLoc0C;
	GetFileSize(*(esp_457 - 0x48), *(esp_457 - 0x44));
	*(esp_457 - 0x4C) = (HANDLE *) dwLoc28;
	CloseHandle(*(esp_457 - 0x4C));
	*(esp_457 - 0x50) = dwLoc1C;
	CloseHandle(*(esp_457 - 0x50));
	dwLoc50 = dwLoc3C + 1856631165;
	esp_380 = esp_457 - 0x50;
l004013E9:
	HANDLE * esp_382 = esp_380 - 0x04;
	*esp_382 = (HANDLE *) dwLoc58;
	Eq_12 eax_384 = CloseHandle(*esp_382);
	<anonymous> * v39_385 = dwLoc50 - 3999932777;
	ptr32 esp_396;
	word32 ebp_397;
	byte SCZO_398;
	word32 eax_399;
	byte SZO_400;
	byte C_401;
	byte Z_402;
	v39_385();
	*(esp_396 - 0x04) = 4420180;
	*(esp_396 - 0x08) = 0x00;
	*(esp_396 - 0x0C) = 0x001F0001;
	esp_293 = esp_396 - 0x0C;
	if (OpenMutexA(*(esp_396 - 0x0C), *(esp_396 - 0x08), *(esp_396 - 0x04)) == null)
	{
		*(esp_396 - 0x10) = 0x00;
		*(esp_396 - 0x14) = dwLoc1C;
		GetFileSize(*(esp_396 - 0x14), *(esp_396 - 0x10));
		*(esp_396 - 0x18) = (HANDLE *) dwLoc30;
		Eq_12 eax_428 = CloseHandle(*(esp_396 - 0x18));
		word32 esp_429;
		word32 ebp_430;
		byte SCZO_431;
		Eq_2 eax_432;
		byte SZO_433;
		byte C_434;
		byte Z_435;
		(v39_385 - ~0x0003000D)();
		return eax_432;
	}
	goto l0040113D;
}

