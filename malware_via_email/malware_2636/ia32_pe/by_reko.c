// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401026: void fn00401026(Register (ptr word32) edx, Register word32 edi, Stack word32 dwArg00)
void fn00401026(word32 * edx, word32 edi, word32 dwArg00)
{
	*edx = (word32) ((byte) C + (*edx + 3455551474));
}

// 0040F143: Register Eq_15 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	GetCommandLineA();
	GetCurrentProcessId();
	Eq_22 eax_13 = GetModuleHandleA(4411335);
	GetCommandLineW();
	GetVersion();
	GetCommandLineA();
	SizeofResource(0x00, dwLoc14);
	GetACP();
	Eq_46 eax_33 = GetProcAddress(null, dwLoc14);
	GetACP();
	SizeofResource(0x00, eax_13);
	GetCommandLineW();
	GetACP();
	Eq_61 eax_51 = eax_33();
	SizeofResource(0x00, eax_13);
	<anonymous> * eax_65 = (eax_51 ^ 0xC0000005) + 0x0040F1F9;
	ptr32 esp_67;
	word32 ebp_68;
	byte SCZO_69;
	word32 eax_70;
	byte SZO_71;
	byte C_72;
	word32 edx_73;
	word32 edi_74;
	eax_65();
	*(esp_67 - 0x04) = fp - 0x24;
	*(esp_67 - 0x08) = 0x40;
	*(esp_67 - 0x0C) = 56884;
	*(esp_67 - 0x10) = 0x00401000;
	GetCommandLineW();
	VirtualProtect(*(esp_67 - 0x10), *(esp_67 - 0x0C), *(esp_67 - 0x08), *(esp_67 - 0x04));
	*(esp_67 - 0x14) = (union Eq_61 *) eax_51;
	GetCommandLineA();
	*(esp_67 - 0x18) = 56884;
	GetVersion();
	*(esp_67 - 0x1C) = 0x00401000;
	word32 esp_101;
	word32 ebp_102;
	byte SCZO_103;
	Eq_15 eax_104;
	byte SZO_105;
	byte C_106;
	word32 * edx_107;
	word32 edi_108;
	(eax_51 - ~0x4040F104)();
	fn00401026(edx_107, edi_108, ebp);
	return eax_104;
}

