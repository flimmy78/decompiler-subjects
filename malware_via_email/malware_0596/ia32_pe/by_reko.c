// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 1310D000: Register word32 fn1310D000(Stack (ptr byte) dwArg04, Stack ptr32 dwArg08, Stack word32 dwArg0C, Stack (ptr word32) dwArg10, Stack word32 dwArg14, Stack Eq_8 dwArg18)
word32 fn1310D000(byte * dwArg04, ptr32 dwArg08, word32 dwArg0C, word32 * dwArg10, word32 dwArg14, Eq_8 dwArg18)
{
	*dwArg10 = dwArg0C;
	word32 ebx_106 = dwArg14;
	word16 wLoc10_112 = (word16) (uint32) ((uint64) (uint32) dwArg14 % 0x05);
	byte * dwArg08_105 = dwArg08 + dwArg14;
	while (true)
	{
		dwArg0C = dwArg0C - 0x01;
		if (dwArg0C == 0x00)
			break;
		Mem87[dwArg04 + 0x00:byte] = (byte) ((int32) *dwArg08_105 ^ (word32) Mem12[(int32) wLoc10_112 + dwArg18:byte]);
		word32 edi_88 = (word32) wLoc10_112;
		wLoc10_112 = (word16) (edi_88 + 0x01);
		if ((int32) wLoc10_112 == 0x05)
			wLoc10_112 = 0x00;
		dwArg04 = dwArg04 + 0x01;
		dwArg08_105 = dwArg08_105 + 0x01;
		ebx_106 = edi_88 + 0x01;
	}
	return ebx_106;
}

// 1310D09B: Register Eq_53 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	word32 esp_11;
	word32 ebp_12;
	byte SCZO_13;
	word32 eax_14;
	word32 edi_15;
	word32 edx_16;
	word32 ecx_17;
	word32 esi_18;
	word32 ebx_19;
	byte SZO_20;
	byte C_21;
	byte Z_22;
	byte dl_23;
	WS2HELP.dll!WahOpenNotificationHandleHelper();
	word32 esp_36;
	word32 ebp_37;
	byte SCZO_38;
	word32 eax_39;
	word32 edi_40;
	word32 edx_41;
	word32 ecx_42;
	word32 esi_43;
	word32 ebx_44;
	byte SZO_45;
	byte C_46;
	byte Z_47;
	byte dl_48;
	WS2HELP.dll!WahOpenHandleHelper();
	word32 esp_51;
	word32 ebp_52;
	byte SCZO_53;
	word32 eax_54;
	word32 edi_55;
	word32 edx_56;
	word32 ecx_57;
	word32 esi_58;
	word32 ebx_59;
	byte SZO_60;
	byte C_61;
	byte Z_62;
	byte dl_63;
	WS2HELP.dll!WahOpenNotificationHandleHelper();
	word32 esp_74;
	word32 ebp_75;
	byte SCZO_76;
	word32 eax_77;
	word32 edi_78;
	word32 edx_79;
	word32 ecx_80;
	word32 esi_81;
	word32 ebx_82;
	byte SZO_83;
	byte C_84;
	byte Z_85;
	byte dl_86;
	WS2HELP.dll!WahOpenHandleHelper();
	struct Eq_110 * v6_88 = eax_14 + (eax_77 + 0x80040142);
	word32 esi_100 = v6_88->dw930CD510;
	fn1310D000(fp - 0x023C, fp - 0x023C, 0x04, fp - 0x10, 0x00, fp - 0x0234);
	Eq_132 ebx_125 = v6_88->t930CD514;
	fn1310D000(fp - 600, fp - 0x025C, 0x04, fp - 0x10, 0x04, fp - 0x0234);
	ui32 ebx_148 = v6_88->dw930CD518;
	fn1310D000(fp - 0x14, fp - 0x1C, 0x04, fp - 0x10, 0x08, fp - 0x0234);
	Eq_164 eax_175 = GetModuleHandleA(null);
	word32 esi_182 = v6_88->dw930CD51C;
	fn1310D000(fp - 0x1C, fp - 0x28, 0x04, fp - 0x10, 0x0C, fp - 0x0234);
	Eq_186 dwLoc0248_216 = v6_88->t930CD520;
	fn1310D000(fp - 0x0248, fp - 600, 0x04, fp - 0x10, 0x10, fp - 0x0234);
	Eq_186 esi_245 = ebx_148 * 0x08 + 0x0C;
	ui32 dwLoc024C_240 = 0x14;
	word32 * dwLoc24_243 = (char *) &v6_88->t930CD520 + 0x04;
	word32 eax_266 = VirtualAlloc(eax_14 + (eax_77 + 0x80040142) - 0x800401F0, esi_245 + ebx_125 + esi_100, 0x3000, 0x40);
	word32 dwLoc0C_272 = esi_182 + eax_175 + esi_245;
	Eq_186 dwLoc0264_276 = esi_245;
	ui32 dwLoc08_277 = 0x00;
	Eq_234 dwLoc18_278 = null;
	while (0x01 != 0x00)
	{
		if (dwLoc0264_276 == dwLoc0248_216)
		{
			ui32 esi_405 = dwLoc08_277 + 0x01;
			dwLoc08_277 = esi_405;
			if (esi_405 == ebx_148)
				break;
			word32 edx_411 = *dwLoc24_243;
			*(fp - 0x031C) = fp - 0x0234;
			*(fp - 800) = dwLoc024C_240;
			*(fp - 0x0324) = fp - 0x10;
			*(fp - 808) = 0x04;
			*(fp - 0x032C) = fp - 0x1C - dwLoc024C_240;
			*(fp - 0x0330) = fp - 0x1C;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			LPVOID * edi_441 = dwLoc24_243 + 0x01;
			dwLoc0248_216 = (Eq_186) *edi_441;
			*(fp - 0x031C) = fp - 0x0234;
			ui32 edi_438 = dwLoc024C_240 + 0x04;
			*(fp - 800) = edi_438;
			*(fp - 0x0324) = fp - 0x10;
			*(fp - 808) = 0x04;
			*(fp - 0x032C) = fp - 0x0248 - edi_438;
			*(fp - 0x0330) = fp - 0x0248;
			fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
			dwLoc024C_240 = edi_438 + 0x04;
			dwLoc24_243 = (word32 *) ((char *) edi_441 + 0x04);
			dwLoc0264_276 = null;
			dwLoc0C_272 = (byte *) (eax_175 + edx_411 / 0x04);
		}
		Mem390[eax_266 + dwLoc18_278:byte] = Mem0[dwLoc0C_272 + 0x00:byte];
		dwLoc0C_272 = dwLoc0C_272 + 0x01;
		dwLoc18_278 = dwLoc18_278 + 0x01;
		dwLoc0264_276 = (Eq_186) ((char *) dwLoc0264_276 + 0x01);
	}
	*(fp - 0x031C) = fp - 0x0234;
	*(fp - 800) = (LPVOID *) esi_245;
	*(fp - 0x0324) = fp - 0x0238;
	*(fp - 808) = (LPVOID *) ebx_125;
	Eq_260 esi_314 = eax_266 - esi_245;
	*(fp - 0x032C) = (LPVOID *) esi_314;
	*(fp - 0x0330) = (LPVOID *) eax_266;
	word32 ebx_327 = fn1310D000(dwArg00, dwArg04, dwArg08, dwArg0C, dwArg10, dwArg14);
	*(fp - 0x031C) = fp;
	*(fp - 800) = fp - 0x0234;
	*(fp - 0x0324) = (LPVOID *) ebx_125;
	*(fp - 808) = esi_100;
	*(fp - 0x032C) = (LPVOID *) eax_266;
	word32 edi_350 = eax_266 + ebx_125;
	*(fp - 0x0330) = (LPVOID *) edi_350;
	word32 esp_354;
	word32 ebp_355;
	byte SCZO_356;
	Eq_53 eax_357;
	word32 edi_358;
	word32 edx_359;
	word32 ecx_360;
	word32 esi_361;
	word32 ebx_362;
	byte SZO_363;
	byte C_364;
	byte Z_365;
	byte dl_366;
	(eax_266 + 0x0F50)();
	return eax_357;
}

