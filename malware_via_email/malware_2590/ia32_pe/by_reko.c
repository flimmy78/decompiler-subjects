// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00401027: FpuStack real64 fn00401027(Register DWORD eax, Register (ptr ui32) ecx, Register int32 edx, Register (ptr Eq_6) ebx, Register word32 ebp, Register (ptr Eq_8) esi, Register ui32 edi, Stack word32 dwArg00, Stack word32 dwArg03, FpuStack real64 rArg0, FpuStack real64 rArg6)
real64 fn00401027(DWORD eax, ui32 * ecx, int32 edx, Eq_6 * ebx, word32 ebp, Eq_8 * esi, ui32 edi, word32 dwArg00, word32 dwArg03, real64 rArg0, real64 rArg6)
{
	*((word32) eax + 0x006B) = (Eq_3) (*((word32) eax + 0x006B) | al);
	__bound(ebp, ebx->dwBC27413);
	__outdw(25799, edx *s 11);
	*(edi | edx *s 11) = esi->dw0004;
	*ecx = *ecx ^ fp + 0x03;
}

// 0041397C: Register Eq_3 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	ptr32 esp_263;
	Eq_57 eax_262;
	ptr32 esp_150;
	Eq_57 eax_21 = CreateFileA(&globals->t42FAA3, 0x80000000, 0x07, null, 0x03, 0x0182, null);
	if (eax_21 == (void *) ~0x00)
	{
		GetFileSize(eax_21, null);
		CloseHandle(eax_21);
		GetFileSize(eax_21, null);
		esp_150 = fp - 0xA0;
		Eq_57 eax_575 = CreateFileA(&globals->t42FA89, 0xE0000000, 0x04, null, 0x03, 0x0104, null);
		if (eax_575 != (void *) ~0x00)
			goto l00413C54;
		GetFileSize(eax_575, null);
		Eq_57 eax_622 = CreateFileA(&globals->t42FB1A, 0x60000000, 0x06, null, 0x03, 0x04, null);
		CloseHandle(eax_575);
		GetLastError();
		CloseHandle(eax_21);
		dwLoc0C = eax_622;
		if (CreateFileA(&globals->t42FAAF, 0xA0000000, 0x03, null, 0x03, 262, null) == (void *) ~0x00)
		{
			GetCommandLineA();
			GetFileSize(eax_622, null);
			dwLoc20 = CreateFileA(&globals->t42FB01, 0xE0000000, 0x04, null, 0x03, 0x0186, null);
			esp_263 = fp - 0x0110;
l00413ADA:
			struct Eq_405 * esp_334 = esp_263 - 0x04;
			esp_334->t0000 = dwLoc0C;
			GetFileSize(esp_334->t0000, esp_334->t0004);
			GetCommandLineA();
			*(esp_334 - 0x04) = 0x00;
			*(esp_334 - 0x08) = (HANDLE *) dwLoc20;
			GetFileSize(*(esp_334 - 0x08), *(esp_334 - 0x04));
			*(esp_334 - 0x0C) = 0x00;
			*(esp_334 - 0x10) = 0x0100;
			*(esp_334 - 0x14) = 0x03;
			*(esp_334 - 0x18) = 0x00;
			*(esp_334 - 0x1C) = 0x06;
			*(esp_334 - 0x20) = 0x20000000;
			*(esp_334 - 0x24) = 4389439;
			Eq_57 eax_358 = CreateFileW(*(esp_334 - 0x24), *(esp_334 - 0x20), *(esp_334 - 0x1C), *(esp_334 - 0x18), *(esp_334 - 0x14), *(esp_334 - 0x10), *(esp_334 - 0x0C));
			*(esp_334 - 0x28) = 0x0042FA99;
			GetCommandLineA();
			Eq_530 eax_363 = LoadLibraryA(*(esp_334 - 0x28));
			*(esp_334 - 44) = 0x0042FB08;
			GetLastError();
			*(esp_334 - 0x30) = (HMODULE *) eax_363;
			GetLastError();
			dwLoc48 = GetProcAddress(*(esp_334 - 0x30), *(esp_334 - 44));
			GetLastError();
			GetLastError();
			*(esp_334 - 0x34) = 0x00;
			*(esp_334 - 0x38) = 288;
			*(esp_334 - 0x3C) = 0x03;
			*(esp_334 - 0x40) = 0x00;
			*(esp_334 - 0x44) = 0x06;
			*(esp_334 - 0x48) = 0xA0000000;
			*(esp_334 - 0x4C) = 4389388;
			dwLoc4C = CreateFileA(*(esp_334 - 0x4C), *(esp_334 - 0x48), *(esp_334 - 0x44), *(esp_334 - 0x40), *(esp_334 - 0x3C), *(esp_334 - 0x38), *(esp_334 - 0x34));
			*(esp_334 - 0x50) = 0x00;
			*(esp_334 - 0x54) = 0x0185;
			*(esp_334 - 88) = 0x03;
			*(esp_334 - 0x5C) = 0x00;
			*(esp_334 - 0x60) = 0x02;
			*(esp_334 - 100) = 0xE0000000;
			*(esp_334 - 0x68) = 0x0042FACC;
			CreateFileW(*(esp_334 - 0x68), *(esp_334 - 100), *(esp_334 - 0x60), *(esp_334 - 0x5C), *(esp_334 - 88), *(esp_334 - 0x54), *(esp_334 - 0x50));
			*(esp_334 - 0x6C) = 0x00;
			*(esp_334 - 0x70) = (HANDLE *) eax_358;
			GetFileSize(*(esp_334 - 0x70), *(esp_334 - 0x6C));
			*(esp_334 - 116) = (HANDLE *) eax_21;
			CloseHandle(*(esp_334 - 116));
			*(esp_334 - 0x78) = 0x00;
			*(esp_334 - 0x7C) = 0x20;
			*(esp_334 - 0x80) = 0x03;
			*(esp_334 - 0x84) = 0x00;
			*(esp_334 - 0x88) = 0x00;
			*(esp_334 - 0x8C) = 0xE0000000;
			*(esp_334 - 0x90) = 4389609;
			CreateFileW(*(esp_334 - 0x90), *(esp_334 - 0x8C), *(esp_334 - 0x88), *(esp_334 - 0x84), *(esp_334 - 0x80), *(esp_334 - 0x7C), *(esp_334 - 0x78));
			*(esp_334 - 0x94) = 0x00;
			GetCommandLineA();
			*(esp_334 - 0x98) = 0x00;
			*(esp_334 - 0x9C) = (HANDLE *) eax_21;
			CloseHandle(*(esp_334 - 0x9C));
			*(esp_334 - 0xA0) = 0x00;
			*(esp_334 - 0xA4) = 0x01A2;
			*(esp_334 - 0xA8) = 0x03;
			*(esp_334 - 0xAC) = 0x00;
			*(esp_334 - 0xB0) = 0x03;
			*(esp_334 - 0xB4) = 0x80000000;
			*(esp_334 - 0xB8) = 4389342;
			esp_263 = esp_334 - 0xB8;
			eax_262 = CreateFileA(*(esp_334 - 0xB8), *(esp_334 - 0xB4), *(esp_334 - 0xB0), *(esp_334 - 0xAC), *(esp_334 - 0xA8), *(esp_334 - 0xA4), *(esp_334 - 0xA0));
l00413C3D:
			if (eax_262 == (void *) ~0x00)
			{
				word32 ebp_271;
				byte SCZO_272;
				word32 eax_273;
				byte Z_274;
				byte SZO_275;
				byte C_276;
				word32 ecx_277;
				word32 edx_278;
				word32 ebx_279;
				word32 esi_280;
				word32 edi_281;
				dwLoc48();
				dwLoc40 = eax_273;
l00413C54:
				LPDWORD * esp_153 = esp_150 - 0x04;
				*esp_153 = (LPDWORD *) null;
				*(esp_153 - 0x04) = (HANDLE *) eax_21;
				GetFileSize(*(esp_153 - 0x04), *esp_153);
				*(esp_153 - 0x08) = 0x00;
				*(esp_153 - 0x0C) = 0xA2;
				*(esp_153 - 0x10) = 0x03;
				*(esp_153 - 0x14) = 0x00;
				*(esp_153 - 0x18) = 0x07;
				*(esp_153 - 0x1C) = 0x60000000;
				*(esp_153 - 0x20) = 0x0042F9C0;
				CreateFileA(*(esp_153 - 0x20), *(esp_153 - 0x1C), *(esp_153 - 0x18), *(esp_153 - 0x14), *(esp_153 - 0x10), *(esp_153 - 0x0C), *(esp_153 - 0x08));
				*(esp_153 - 0x24) = (HANDLE *) eax_21;
				GetFileType(*(esp_153 - 0x24));
				*(esp_153 - 0x28) = (HANDLE *) dwLoc4C;
				Eq_3 eax_188 = GetFileType(*(esp_153 - 0x28));
				word32 esp_195;
				word32 ebp_196;
				byte SCZO_197;
				Eq_3 eax_198;
				byte Z_199;
				byte SZO_200;
				byte C_201;
				word32 ecx_202;
				word32 edx_203;
				word32 ebx_204;
				word32 esi_205;
				word32 edi_206;
				(*((word32) (dwLoc40 ^ 0x80070057) + 0x00413CC9))();
				return eax_198;
			}
			goto l00413ADA;
		}
	}
	else
	{
		CreateFileA(&globals->t42FA6D, 0x60000000, 0x05, null, 0x03, 0x0127, null);
		CreateFileW(&globals->t42FA58, 0x20000000, 0x05, null, 0x03, 288, null);
		esp_263 = fp - 0xD0;
		eax_262 = CreateFileA(&globals->t42FA26, 0x60000000, 0x04, null, 0x03, 0x01A0, null);
		if (eax_262 != (void *) ~0x00)
			goto l00413C3D;
		GetLastError();
		dwLoc14 = dwLoc40 - 2143666719;
	}
	ptr32 esp_514;
	word32 ebp_515;
	byte SCZO_516;
	word32 eax_517;
	byte Z_518;
	byte SZO_519;
	byte C_520;
	ui32 * ecx_521;
	int32 edx_522;
	struct Eq_6 * ebx_523;
	struct Eq_8 * esi_524;
	ui32 edi_525;
	dwLoc14();
	*(esp_514 - 0x04) = 0x00;
	*(esp_514 - 0x08) = dwLoc08;
	GetFileSize(*(esp_514 - 0x08), *(esp_514 - 0x04));
	*(esp_514 - 0x0C) = 0x00;
	*(esp_514 - 0x10) = dwLoc24;
	Eq_3 eax_538 = GetFileSize(*(esp_514 - 0x10), *(esp_514 - 0x0C));
	fn00401027(eax_538, ecx_521, edx_522, ebx_523, ebp_515, esi_524, edi_525, ebp, dwLoc01, rArg0, rArg6);
	return eax_538;
}

