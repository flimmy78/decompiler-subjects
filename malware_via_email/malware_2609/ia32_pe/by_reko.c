// subject.c
// Generated by decompiling subject.exe
// using Reko decompiler version VERSION

#include "subject.h"

// 00412CF9: Register Eq_2 Win32CrtStartup()
DWORD Win32CrtStartup()
{
	Eq_3 eax_14 = OpenMutexA(0x001F0001, 0x01, &globals->t43108B);
	CloseHandle(eax_14);
	ptr32 esp_17 = fp - 0x54;
	do
	{
		HANDLE * esp_34 = esp_17 - 0x04;
		*esp_34 = (HANDLE *) eax_14;
		GetFileType(*esp_34);
		*(esp_34 - 0x04) = (HANDLE *) eax_14;
		GetFileType(*(esp_34 - 0x04));
		*(esp_34 - 0x08) = 0x00;
		*(esp_34 - 0x0C) = (HANDLE *) eax_14;
		GetFileSize(*(esp_34 - 0x0C), *(esp_34 - 0x08));
		*(esp_34 - 0x10) = (HANDLE *) eax_14;
		CloseHandle(*(esp_34 - 0x10));
		*(esp_34 - 0x14) = 4395155;
		*(esp_34 - 0x18) = 0x00;
		*(esp_34 - 0x1C) = 0x001F0001;
		Eq_3 eax_57 = OpenMutexA(*(esp_34 - 0x1C), *(esp_34 - 0x18), *(esp_34 - 0x14));
		if (eax_57 != null)
		{
			*(esp_34 - 0x20) = 0x00;
			*(esp_34 - 0x24) = (HANDLE *) dwLoc10;
			GetFileSize(*(esp_34 - 0x24), *(esp_34 - 0x20));
			*(esp_34 - 0x28) = 0x0043109A;
			*(esp_34 - 44) = 0x01;
			*(esp_34 - 0x30) = 0x001F0001;
			OpenMutexA(*(esp_34 - 0x30), *(esp_34 - 44), *(esp_34 - 0x28));
			*(esp_34 - 0x34) = 0x00;
			*(esp_34 - 0x38) = (HANDLE *) dwLoc10;
			Eq_2 eax_310 = GetFileSize(*(esp_34 - 0x38), *(esp_34 - 0x34));
			ptr32 esp_315;
			word32 ebp_316;
			byte SCZO_317;
			word32 eax_318;
			byte SZO_319;
			byte C_320;
			byte Z_321;
			(dwLoc40 - 0x7FC5CF56)();
			*(esp_315 - 0x04) = 0x00431036;
			*(esp_315 - 0x08) = 0x00;
			*(esp_315 - 0x0C) = 0x001F0001;
			OpenMutexA(*(esp_315 - 0x0C), *(esp_315 - 0x08), *(esp_315 - 0x04));
			*(esp_315 - 0x10) = (HANDLE *) dwLoc2C;
			GetFileType(*(esp_315 - 0x10));
			*(esp_315 - 0x14) = (HANDLE *) eax_57;
			Eq_7 eax_342 = CloseHandle(*(esp_315 - 0x14));
			word32 esp_343;
			word32 ebp_344;
			byte SCZO_345;
			Eq_2 eax_346;
			byte SZO_347;
			byte C_348;
			byte Z_349;
			(dwLoc40 - 2143744049)();
			return eax_346;
		}
		*(esp_34 - 0x20) = 0x00431051;
		*(esp_34 - 0x24) = 0x01;
		*(esp_34 - 0x28) = 0x001F0001;
		Eq_3 eax_88 = OpenMutexA(*(esp_34 - 0x28), *(esp_34 - 0x24), *(esp_34 - 0x20));
		dwLoc2C = eax_88;
		if (eax_88 != null)
			ExitProcess(*(esp_34 - 0x28));
		*(esp_34 - 44) = 0x00;
		*(esp_34 - 0x30) = (HANDLE *) eax_88;
		GetFileSize(*(esp_34 - 0x30), *(esp_34 - 44));
		*(esp_34 - 0x34) = 0x00;
		*(esp_34 - 0x38) = (HANDLE *) eax_57;
		GetFileSize(*(esp_34 - 0x38), *(esp_34 - 0x34));
		*(esp_34 - 0x3C) = 0x00;
		*(esp_34 - 0x40) = (HANDLE *) eax_88;
		GetFileSize(*(esp_34 - 0x40), *(esp_34 - 0x3C));
		*(esp_34 - 0x44) = 0x00;
		*(esp_34 - 0x48) = (HANDLE *) eax_88;
		GetFileSize(*(esp_34 - 0x48), *(esp_34 - 0x44));
		*(esp_34 - 0x4C) = 0x0043101B;
		*(esp_34 - 0x50) = 0x01;
		*(esp_34 - 0x54) = 0x001F0001;
		Eq_3 eax_123 = OpenMutexA(*(esp_34 - 0x54), *(esp_34 - 0x50), *(esp_34 - 0x4C));
		*(esp_34 - 88) = 0x00;
		*(esp_34 - 0x5C) = (HANDLE *) eax_88;
		GetFileSize(*(esp_34 - 0x5C), *(esp_34 - 88));
		*(esp_34 - 0x60) = 0x00;
		*(esp_34 - 100) = (HANDLE *) eax_88;
		GetFileSize(*(esp_34 - 100), *(esp_34 - 0x60));
		*(esp_34 - 0x68) = (HANDLE *) eax_57;
		CloseHandle(*(esp_34 - 0x68));
		*(esp_34 - 0x6C) = (HANDLE *) eax_123;
		GetFileType(*(esp_34 - 0x6C));
		*(esp_34 - 0x70) = 0x00431000;
		*(esp_34 - 116) = (HANDLE *) eax_57;
		GetFileType(*(esp_34 - 116));
		*(esp_34 - 0x78) = (HANDLE *) eax_14;
		GetFileType(*(esp_34 - 0x78));
		Eq_463 eax_155 = LoadLibraryA(*(esp_34 - 0x78));
		*(esp_34 - 0x7C) = 0x0043100A;
		*(esp_34 - 0x80) = 0x00;
		*(esp_34 - 0x84) = (HANDLE *) eax_57;
		GetFileSize(*(esp_34 - 0x84), *(esp_34 - 0x80));
		*(esp_34 - 0x88) = (HMODULE *) eax_155;
		*(esp_34 - 0x8C) = 0x00;
		*(esp_34 - 0x90) = (HANDLE *) eax_88;
		GetFileSize(*(esp_34 - 0x90), *(esp_34 - 0x8C));
		*(esp_34 - 0x94) = 0x00431061;
		*(esp_34 - 0x98) = 0x01;
		*(esp_34 - 0x9C) = 0x001F0001;
		dwLoc10 = OpenMutexA(*(esp_34 - 0x9C), *(esp_34 - 0x98), *(esp_34 - 0x94));
		Eq_565 eax_182 = GetProcAddress(*(esp_34 - 0x9C), *(esp_34 - 0x98));
		*(esp_34 - 0xA0) = (HANDLE *) eax_14;
		CloseHandle(*(esp_34 - 0xA0));
		*(esp_34 - 0xA4) = (HANDLE *) eax_57;
		GetFileType(*(esp_34 - 0xA4));
		*(esp_34 - 0xA8) = 4395135;
		*(esp_34 - 0xAC) = 0x00;
		*(esp_34 - 0xB0) = 0x001F0001;
		esp_17 = esp_34 - 0xB0;
		Eq_3 eax_198 = OpenMutexA(*(esp_34 - 0xB0), *(esp_34 - 0xAC), *(esp_34 - 0xA8));
	} while (eax_198 != null);
	*(esp_34 - 0xB4) = (HANDLE *) eax_57;
	CloseHandle(*(esp_34 - 0xB4));
	*(esp_34 - 0xB8) = (HANDLE *) eax_14;
	GetFileType(*(esp_34 - 0xB8));
	*(esp_34 - 188) = 0x004310A0;
	*(esp_34 - 0xC0) = 0x00;
	*(esp_34 - 0xC4) = 0x001F0001;
	Eq_3 eax_217 = OpenMutexA(*(esp_34 - 0xC4), *(esp_34 - 0xC0), *(esp_34 - 188));
	*(esp_34 - 200) = 0x00;
	*(esp_34 - 0xCC) = (HANDLE *) eax_57;
	GetFileSize(*(esp_34 - 0xCC), *(esp_34 - 200));
	*(esp_34 - 0xD0) = 0x00;
	*(esp_34 - 212) = 0x00;
	*(esp_34 - 0xD8) = 0x00;
	int32 eax_239 = eax_182();
	*(esp_34 - 220) = 0x00431046;
	*(esp_34 - 0xE0) = 0x01;
	*(esp_34 - 228) = 0x001F0001;
	OpenMutexA(*(esp_34 - 228), *(esp_34 - 0xE0), *(esp_34 - 220));
	*(esp_34 - 232) = (HANDLE *) eax_14;
	CloseHandle(*(esp_34 - 232));
	*(esp_34 - 0xEC) = (HANDLE *) eax_198;
	CloseHandle(*(esp_34 - 0xEC));
	*(esp_34 - 0xF0) = (HANDLE *) eax_217;
	GetFileType(*(esp_34 - 0xF0));
	*(esp_34 - 244) = (HANDLE *) eax_198;
	GetFileType(*(esp_34 - 244));
	*(esp_34 - 0xF8) = (HANDLE *) eax_217;
	Eq_2 eax_279 = GetFileType(*(esp_34 - 0xF8));
	word32 esp_280;
	word32 ebp_281;
	byte SCZO_282;
	Eq_2 eax_283;
	byte SZO_284;
	byte C_285;
	byte Z_286;
	(*((word32) (eax_239 ^ 0x80070057) + 4272049))();
	return eax_283;
}

